(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/*!
  * @preserve Qwery - A Blazing Fast query selector engine
  * https://github.com/ded/qwery
  * copyright Dustin Diaz 2012
  * MIT License
  */

(function (name, context, definition) {
  if (typeof module != 'undefined' && module.exports) module.exports = definition()
  else if (typeof define == 'function' && define.amd) define(definition)
  else context[name] = definition()
})('qwery', this, function () {
  var doc = document
    , html = doc.documentElement
    , byClass = 'getElementsByClassName'
    , byTag = 'getElementsByTagName'
    , qSA = 'querySelectorAll'
    , useNativeQSA = 'useNativeQSA'
    , tagName = 'tagName'
    , nodeType = 'nodeType'
    , select // main select() method, assign later

    , id = /#([\w\-]+)/
    , clas = /\.[\w\-]+/g
    , idOnly = /^#([\w\-]+)$/
    , classOnly = /^\.([\w\-]+)$/
    , tagOnly = /^([\w\-]+)$/
    , tagAndOrClass = /^([\w]+)?\.([\w\-]+)$/
    , splittable = /(^|,)\s*[>~+]/
    , normalizr = /^\s+|\s*([,\s\+\~>]|$)\s*/g
    , splitters = /[\s\>\+\~]/
    , splittersMore = /(?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\]|[\s\w\+\-]*\))/
    , specialChars = /([.*+?\^=!:${}()|\[\]\/\\])/g
    , simple = /^(\*|[a-z0-9]+)?(?:([\.\#]+[\w\-\.#]+)?)/
    , attr = /\[([\w\-]+)(?:([\|\^\$\*\~]?\=)['"]?([ \w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^]+)["']?)?\]/
    , pseudo = /:([\w\-]+)(\(['"]?([^()]+)['"]?\))?/
    , easy = new RegExp(idOnly.source + '|' + tagOnly.source + '|' + classOnly.source)
    , dividers = new RegExp('(' + splitters.source + ')' + splittersMore.source, 'g')
    , tokenizr = new RegExp(splitters.source + splittersMore.source)
    , chunker = new RegExp(simple.source + '(' + attr.source + ')?' + '(' + pseudo.source + ')?')

  var walker = {
      ' ': function (node) {
        return node && node !== html && node.parentNode
      }
    , '>': function (node, contestant) {
        return node && node.parentNode == contestant.parentNode && node.parentNode
      }
    , '~': function (node) {
        return node && node.previousSibling
      }
    , '+': function (node, contestant, p1, p2) {
        if (!node) return false
        return (p1 = previous(node)) && (p2 = previous(contestant)) && p1 == p2 && p1
      }
    }

  function cache() {
    this.c = {}
  }
  cache.prototype = {
    g: function (k) {
      return this.c[k] || undefined
    }
  , s: function (k, v, r) {
      v = r ? new RegExp(v) : v
      return (this.c[k] = v)
    }
  }

  var classCache = new cache()
    , cleanCache = new cache()
    , attrCache = new cache()
    , tokenCache = new cache()

  function classRegex(c) {
    return classCache.g(c) || classCache.s(c, '(^|\\s+)' + c + '(\\s+|$)', 1)
  }

  // not quite as fast as inline loops in older browsers so don't use liberally
  function each(a, fn) {
    var i = 0, l = a.length
    for (; i < l; i++) fn(a[i])
  }

  function flatten(ar) {
    for (var r = [], i = 0, l = ar.length; i < l; ++i) arrayLike(ar[i]) ? (r = r.concat(ar[i])) : (r[r.length] = ar[i])
    return r
  }

  function arrayify(ar) {
    var i = 0, l = ar.length, r = []
    for (; i < l; i++) r[i] = ar[i]
    return r
  }

  function previous(n) {
    while (n = n.previousSibling) if (n[nodeType] == 1) break;
    return n
  }

  function q(query) {
    return query.match(chunker)
  }

  // called using `this` as element and arguments from regex group results.
  // given => div.hello[title="world"]:foo('bar')
  // div.hello[title="world"]:foo('bar'), div, .hello, [title="world"], title, =, world, :foo('bar'), foo, ('bar'), bar]
  function interpret(whole, tag, idsAndClasses, wholeAttribute, attribute, qualifier, value, wholePseudo, pseudo, wholePseudoVal, pseudoVal) {
    var i, m, k, o, classes
    if (this[nodeType] !== 1) return false
    if (tag && tag !== '*' && this[tagName] && this[tagName].toLowerCase() !== tag) return false
    if (idsAndClasses && (m = idsAndClasses.match(id)) && m[1] !== this.id) return false
    if (idsAndClasses && (classes = idsAndClasses.match(clas))) {
      for (i = classes.length; i--;) if (!classRegex(classes[i].slice(1)).test(this.className)) return false
    }
    if (pseudo && qwery.pseudos[pseudo] && !qwery.pseudos[pseudo](this, pseudoVal)) return false
    if (wholeAttribute && !value) { // select is just for existance of attrib
      o = this.attributes
      for (k in o) {
        if (Object.prototype.hasOwnProperty.call(o, k) && (o[k].name || k) == attribute) {
          return this
        }
      }
    }
    if (wholeAttribute && !checkAttr(qualifier, getAttr(this, attribute) || '', value)) {
      // select is for attrib equality
      return false
    }
    return this
  }

  function clean(s) {
    return cleanCache.g(s) || cleanCache.s(s, s.replace(specialChars, '\\$1'))
  }

  function checkAttr(qualify, actual, val) {
    switch (qualify) {
    case '=':
      return actual == val
    case '^=':
      return actual.match(attrCache.g('^=' + val) || attrCache.s('^=' + val, '^' + clean(val), 1))
    case '$=':
      return actual.match(attrCache.g('$=' + val) || attrCache.s('$=' + val, clean(val) + '$', 1))
    case '*=':
      return actual.match(attrCache.g(val) || attrCache.s(val, clean(val), 1))
    case '~=':
      return actual.match(attrCache.g('~=' + val) || attrCache.s('~=' + val, '(?:^|\\s+)' + clean(val) + '(?:\\s+|$)', 1))
    case '|=':
      return actual.match(attrCache.g('|=' + val) || attrCache.s('|=' + val, '^' + clean(val) + '(-|$)', 1))
    }
    return 0
  }

  // given a selector, first check for simple cases then collect all base candidate matches and filter
  function _qwery(selector, _root) {
    var r = [], ret = [], i, l, m, token, tag, els, intr, item, root = _root
      , tokens = tokenCache.g(selector) || tokenCache.s(selector, selector.split(tokenizr))
      , dividedTokens = selector.match(dividers)

    if (!tokens.length) return r

    token = (tokens = tokens.slice(0)).pop() // copy cached tokens, take the last one
    if (tokens.length && (m = tokens[tokens.length - 1].match(idOnly))) root = byId(_root, m[1])
    if (!root) return r

    intr = q(token)
    // collect base candidates to filter
    els = root !== _root && root[nodeType] !== 9 && dividedTokens && /^[+~]$/.test(dividedTokens[dividedTokens.length - 1]) ?
      function (r) {
        while (root = root.nextSibling) {
          root[nodeType] == 1 && (intr[1] ? intr[1] == root[tagName].toLowerCase() : 1) && (r[r.length] = root)
        }
        return r
      }([]) :
      root[byTag](intr[1] || '*')
    // filter elements according to the right-most part of the selector
    for (i = 0, l = els.length; i < l; i++) {
      if (item = interpret.apply(els[i], intr)) r[r.length] = item
    }
    if (!tokens.length) return r

    // filter further according to the rest of the selector (the left side)
    each(r, function (e) { if (ancestorMatch(e, tokens, dividedTokens)) ret[ret.length] = e })
    return ret
  }

  // compare element to a selector
  function is(el, selector, root) {
    if (isNode(selector)) return el == selector
    if (arrayLike(selector)) return !!~flatten(selector).indexOf(el) // if selector is an array, is el a member?

    var selectors = selector.split(','), tokens, dividedTokens
    while (selector = selectors.pop()) {
      tokens = tokenCache.g(selector) || tokenCache.s(selector, selector.split(tokenizr))
      dividedTokens = selector.match(dividers)
      tokens = tokens.slice(0) // copy array
      if (interpret.apply(el, q(tokens.pop())) && (!tokens.length || ancestorMatch(el, tokens, dividedTokens, root))) {
        return true
      }
    }
    return false
  }

  // given elements matching the right-most part of a selector, filter out any that don't match the rest
  function ancestorMatch(el, tokens, dividedTokens, root) {
    var cand
    // recursively work backwards through the tokens and up the dom, covering all options
    function crawl(e, i, p) {
      while (p = walker[dividedTokens[i]](p, e)) {
        if (isNode(p) && (interpret.apply(p, q(tokens[i])))) {
          if (i) {
            if (cand = crawl(p, i - 1, p)) return cand
          } else return p
        }
      }
    }
    return (cand = crawl(el, tokens.length - 1, el)) && (!root || isAncestor(cand, root))
  }

  function isNode(el, t) {
    return el && typeof el === 'object' && (t = el[nodeType]) && (t == 1 || t == 9)
  }

  function uniq(ar) {
    var a = [], i, j;
    o:
    for (i = 0; i < ar.length; ++i) {
      for (j = 0; j < a.length; ++j) if (a[j] == ar[i]) continue o
      a[a.length] = ar[i]
    }
    return a
  }

  function arrayLike(o) {
    return (typeof o === 'object' && isFinite(o.length))
  }

  function normalizeRoot(root) {
    if (!root) return doc
    if (typeof root == 'string') return qwery(root)[0]
    if (!root[nodeType] && arrayLike(root)) return root[0]
    return root
  }

  function byId(root, id, el) {
    // if doc, query on it, else query the parent doc or if a detached fragment rewrite the query and run on the fragment
    return root[nodeType] === 9 ? root.getElementById(id) :
      root.ownerDocument &&
        (((el = root.ownerDocument.getElementById(id)) && isAncestor(el, root) && el) ||
          (!isAncestor(root, root.ownerDocument) && select('[id="' + id + '"]', root)[0]))
  }

  function qwery(selector, _root) {
    var m, el, root = normalizeRoot(_root)

    // easy, fast cases that we can dispatch with simple DOM calls
    if (!root || !selector) return []
    if (selector === window || isNode(selector)) {
      return !_root || (selector !== window && isNode(root) && isAncestor(selector, root)) ? [selector] : []
    }
    if (selector && arrayLike(selector)) return flatten(selector)
    if (m = selector.match(easy)) {
      if (m[1]) return (el = byId(root, m[1])) ? [el] : []
      if (m[2]) return arrayify(root[byTag](m[2]))
      if (hasByClass && m[3]) return arrayify(root[byClass](m[3]))
    }

    return select(selector, root)
  }

  // where the root is not document and a relationship selector is first we have to
  // do some awkward adjustments to get it to work, even with qSA
  function collectSelector(root, collector) {
    return function (s) {
      var oid, nid
      if (splittable.test(s)) {
        if (root[nodeType] !== 9) {
          // make sure the el has an id, rewrite the query, set root to doc and run it
          if (!(nid = oid = root.getAttribute('id'))) root.setAttribute('id', nid = '__qwerymeupscotty')
          s = '[id="' + nid + '"]' + s // avoid byId and allow us to match context element
          collector(root.parentNode || root, s, true)
          oid || root.removeAttribute('id')
        }
        return;
      }
      s.length && collector(root, s, false)
    }
  }

  var isAncestor = 'compareDocumentPosition' in html ?
    function (element, container) {
      return (container.compareDocumentPosition(element) & 16) == 16
    } : 'contains' in html ?
    function (element, container) {
      container = container[nodeType] === 9 || container == window ? html : container
      return container !== element && container.contains(element)
    } :
    function (element, container) {
      while (element = element.parentNode) if (element === container) return 1
      return 0
    }
  , getAttr = function () {
      // detect buggy IE src/href getAttribute() call
      var e = doc.createElement('p')
      return ((e.innerHTML = '<a href="#x">x</a>') && e.firstChild.getAttribute('href') != '#x') ?
        function (e, a) {
          return a === 'class' ? e.className : (a === 'href' || a === 'src') ?
            e.getAttribute(a, 2) : e.getAttribute(a)
        } :
        function (e, a) { return e.getAttribute(a) }
    }()
  , hasByClass = !!doc[byClass]
    // has native qSA support
  , hasQSA = doc.querySelector && doc[qSA]
    // use native qSA
  , selectQSA = function (selector, root) {
      var result = [], ss, e
      try {
        if (root[nodeType] === 9 || !splittable.test(selector)) {
          // most work is done right here, defer to qSA
          return arrayify(root[qSA](selector))
        }
        // special case where we need the services of `collectSelector()`
        each(ss = selector.split(','), collectSelector(root, function (ctx, s) {
          e = ctx[qSA](s)
          if (e.length == 1) result[result.length] = e.item(0)
          else if (e.length) result = result.concat(arrayify(e))
        }))
        return ss.length > 1 && result.length > 1 ? uniq(result) : result
      } catch (ex) { }
      return selectNonNative(selector, root)
    }
    // no native selector support
  , selectNonNative = function (selector, root) {
      var result = [], items, m, i, l, r, ss
      selector = selector.replace(normalizr, '$1')
      if (m = selector.match(tagAndOrClass)) {
        r = classRegex(m[2])
        items = root[byTag](m[1] || '*')
        for (i = 0, l = items.length; i < l; i++) {
          if (r.test(items[i].className)) result[result.length] = items[i]
        }
        return result
      }
      // more complex selector, get `_qwery()` to do the work for us
      each(ss = selector.split(','), collectSelector(root, function (ctx, s, rewrite) {
        r = _qwery(s, ctx)
        for (i = 0, l = r.length; i < l; i++) {
          if (ctx[nodeType] === 9 || rewrite || isAncestor(r[i], root)) result[result.length] = r[i]
        }
      }))
      return ss.length > 1 && result.length > 1 ? uniq(result) : result
    }
  , configure = function (options) {
      // configNativeQSA: use fully-internal selector or native qSA where present
      if (typeof options[useNativeQSA] !== 'undefined')
        select = !options[useNativeQSA] ? selectNonNative : hasQSA ? selectQSA : selectNonNative
    }

  configure({ useNativeQSA: true })

  qwery.configure = configure
  qwery.uniq = uniq
  qwery.is = is
  qwery.pseudos = {}

  return qwery
});

},{}],2:[function(require,module,exports){
/* trak.js v0.3.0 | (c) 2014 @mrmartineau | https://github.com/tmwagency/trak.js
   Universal event tracking API. */
var trak = (function() {
	'use strict';


	/**
	 * trak.clean()
	 * Cleans the input replacing spaces with a specified delimeter (see trak.options) and converts to lower case
	 * @param  string str
	 * @return string cleaned string
	 */
	var clean = function(str) {
		if (!str) {
			return '';
		}
		if (!trak.options.clean) {
			return wildcard.call(this, str);
		} else {
			return wildcard.call(this, str).toString().replace(/\s|'|"/g, settings.delimeter).toLowerCase();
		}
	};


	/**
	 * trak.event()
	 * @param  object options     See getOptions() function for available items
	 */
	var event = function(options) {
		var opts           = getOptions(options);

		// Cache the options
		var category       = clean.call(this, opts.category);
		var action         = clean.call(this, opts.action);
		var label          = clean.call(this, opts.label);
		var eventName      = opts.eventName;
		var value          = opts.value;
		var nonInteraction = opts.nonInteraction;

		if (settings.trackType === 'ga' && typeof ga !== 'undefined') {
			ga('send', 'event', category, action, label, value, {'nonInteraction': nonInteraction});

		} else if (settings.trackType === '_gaq' && typeof _gaq !== 'undefined') {
			_gaq.push(['_trackEvent', category, action, label, value]);

		} else if (settings.trackType === 'gtm' && typeof dataLayer !== 'undefined') {
			dataLayer.push({
				'event'         : eventName,
				'eventCategory' : category,
				'eventAction'   : action,
				'eventLabel'    : label,
				'eventValue'    : value
			});
		}

		if (settings.additionalTypes !== undefined) {
			settings.additionalTypes();
		}

		if (settings.debug) {
			console.debug('Debug message:\n Category:', category, '\n Action:', action, '\n Label:', label);
		}
	};


	/**
	 * dataAttrEvent
	 * This is called when any element with the [data-trak] attribute is clicked.
	 * If [data-trakwithjs] is present on the element, the trak.attr() method is not called
	 * To allow use of the
	 */
	var dataAttrEvent = function() {
		var trakWithJs = this.getAttribute('data-trakwithjs') !== null ? true : false;
		if (!trakWithJs) {
			attrEvent.call(this);
		}
	};


	/**
	 * attrEvent
	 * This is used when elements with the [data-trak] is present.
	 * It calls trak.event()
	 * Usage in your js code:
	 * > trak.attrEvent.call(this);
	 */
	var attrEvent = function() {
		var _options = JSON.parse(this.getAttribute('data-trak'));
		event.call(this, _options);
	};


	/**
	 * Function to convert wildcards into real values
	 * @param  string str
	 * @return string     The converted ouput from str
	 */
	var wildcard = function(str) {
		var output;

		switch(str) {
			case 'page.title':
				output = document.title;
				break;
			case 'page.href':
				output = window.location.href;
				break;
			case 'link.href':
				output = this.href;
				break;
			case 'link.title':
				output = this.title;
				break;
			case 'referrer':
				output = document.referrer ? document.referrer : 'No referrer';
				break;
			default:
				output = str;
				break;
		}
		return output;
	};


	/**
	 * getOptions
	 * Get all the options
	 */
	var getOptions = function (opts) {
			return {
				category       : opts && opts.category       || '',
				action         : opts && opts.action         || '',
				label          : opts && opts.label          || '',
				value          : opts && opts.value          || 0,
				nonInteraction : opts && opts.nonInteraction || false,
				eventName      : opts && opts.eventName      || undefined
			};
	};


	/**
	 * trak.options
	 * These are the default options for trak.js
	 * To override them, reassign these values in your code, see
	 * https://gist.github.com/mrmartineau/24ae259f373e6dbda66f for an example
	 * @type {Object}
	 */
	var settings = {
		clean           : true, // trak.options.clean     = false
		delimeter       : '_',  // trak.options.delimeter = '-'
		trackType       : 'ga', // trak.options.trackType = 'ga' Available options: ga, _gaq & gtm
		additionalTypes : undefined,
		debug           : false
	};


	var start = function() {
		var trakElements = document.querySelectorAll('[data-trak]');
		for (var i = 0; i < trakElements.length ; i++) {
			if (trakElements[i].addEventListener) {
				trakElements[i].addEventListener('click', dataAttrEvent);
			} else if (trakElements[i].attachEvent) {
				trakElements[i].attachEvent('onclick', dataAttrEvent);
			}
		}
	};

	return {
		start     : start,
		clean     : clean,
		event     : event,
		attrEvent : attrEvent,
		wildcard  : wildcard,
		options   : settings
	};

})();


// Check for AMD/Module support, otherwise define trak as a global variable.
if (typeof define !== 'undefined' && define.amd) {
	// AMD. Register as an anonymous module.
	define (function() {
		'use strict';
		return trak;
	});
} else if (typeof module !== 'undefined' && module.exports) {
	module.exports = trak;
} else {
	window.trak = trak;
}

},{}],3:[function(require,module,exports){
/***************************************************************
  * Traversty: A DOM collection management and traversal utility
  * (c) Rod Vagg (@rvagg) 2012
  * https://github.com/rvagg/traversty
  * License: MIT
  */

(function (name, context, definition) {
  if (typeof module != 'undefined' && module.exports)
    module.exports = definition()
  else if (typeof define == 'function' && define.amd)
    define(definition)
  else
    context[name] = definition()
})('traversty', this, function () {

  var context = this
    , old = context.traversty
    , doc = window.document
    , html = doc.documentElement
    , toString = Object.prototype.toString
    , Ap = Array.prototype
    , slice = Ap.slice
      // feature test to find native matchesSelector()
    , matchesSelector = (function (el, pfx, name, i, ms) {
        while (i < pfx.length)
          if (el[ms = pfx[i++] + name])
            return ms
      }(html, [ 'msM', 'webkitM', 'mozM', 'oM', 'm' ], 'atchesSelector', 0))

    , Kfalse = function () { return false }

    , isNumber = function (o) {
        return toString.call(o) === '[object Number]'
      }

    , isString = function (o) {
        return toString.call(o) === '[object String]'
      }

    , isFunction = function (o) {
        return toString.call(o) === '[object Function]'
      }

    , isUndefined = function (o) {
        return o === void 0
      }

    , isElement = function (o) {
        return o && o.nodeType === 1
      }

      // figure out which argument, if any, is our 'index'
    , getIndex = function (selector, index) {
        return isUndefined(selector) && !isNumber(index) ? 0 :
          isNumber(selector) ? selector : isNumber(index) ? index : null
      }

      // figure out which argument, if any, is our 'selector'
    , getSelector = function (selector) {
        return isString(selector) ? selector : '*'
      }

    , nativeSelectorFind = function (selector, el) {
        return slice.call(el.querySelectorAll(selector), 0)
      }

    , nativeSelectorMatches = function (selector, el) {
        return selector === '*' || el[matchesSelector](selector)
      }

    , selectorFind = nativeSelectorFind

    , selectorMatches = nativeSelectorMatches

      // used in the case where our selector engine does out-of-order element returns for
      // grouped selectors, e.g. '.class, tag', we need our elements in document-order
      // so we do it ourselves if need be
    , createUnorderedEngineSelectorFind = function(engineSelect, selectorMatches) {
        return function (selector, el) {
          if (/,/.test(selector)) {
            var ret = [], i = -1, els = el.getElementsByTagName('*')
            while (++i < els.length)
              if (isElement(els[i]) && selectorMatches(selector, els[i]))
                ret.push(els[i])
            return ret
          }
          return engineSelect(selector, el)
        }
      }

      // is 'element' underneath 'container' somewhere
    , isAncestor = 'compareDocumentPosition' in html
        ? function (element, container) {
            return (container.compareDocumentPosition(element) & 16) == 16
          }
        : 'contains' in html
          ? function (element, container) {
              container = container.nodeType === 9 || container == window ? html : container
              return container !== element && container.contains(element)
            }
          : function (element, container) { // old smelly browser
              while (element = element.parentNode)
                if (element === container)
                  return 1
              return 0
            }

      // return an array containing only unique elements
    , unique = function (ar) {
        var a = [], i = -1, j, has
        while (++i < ar.length) {
          j = -1
          has = false
          while (++j < a.length) {
            if (a[j] === ar[i]) {
              has = true
              break
            }
          }
          if (!has)
            a.push(ar[i])
        }
        return a
      }

      // for each element of 'els' execute 'fn' to get an array of elements to collect
    , collect = function (els, fn) {
        var ret = [], res, i = 0, j, l = els.length, l2
        while (i < l) {
          j = 0
          l2 = (res = fn(els[i], i++)).length
          while (j < l2)
            ret.push(res[j++])
        }
        return ret
      }

     // generic DOM navigator to move multiple elements around the DOM
   , move = function (els, method, selector, index, filterFn) {
        index = getIndex(selector, index)
        selector = getSelector(selector)
        return collect(els
          , function (el, elind) {
              var i = index || 0, ret = []
              if (!filterFn)
                el = el[method]
              while (el && (index === null || i >= 0)) {
                // ignore non-elements, only consider selector-matching elements
                // handle both the index and no-index (selector-only) cases
                if (isElement(el)
                    && (!filterFn || filterFn === true || filterFn(el, elind))
                    && selectorMatches(selector, el)
                    && (index === null || i-- === 0)) {
                  // this concat vs push is to make sure we add elements to the result array
                  // in reverse order when doing a previous(selector) and up(selector)
                  index === null
                      && method != 'nextSibling'
                      && method != 'parentNode'
                    ? ret.unshift(el)
                    : ret.push(el)
                }
                el = el[method]
              }
              return ret
            }
        )
      }

      // given an index & length, return a 'fixed' index, fixes non-numbers & neative indexes
    , eqIndex = function (length, index, def) {
        if (index < 0)
          index = length + index
        if (index < 0 || index >= length)
          return null
        return !index && index !== 0 ? def : index
      }

      // collect elements of an array that match a filter function
    , filter = function (els, fn) {
        var arr = [], i = 0, l = els.length
        for (; i < l; i++)
          if (fn(els[i], i))
            arr.push(els[i])
        return arr
      }

      // create a filter function, for use by filter(), is() & not()
      // allows the argument to be an element, a function or a selector
    , filterFn = function (slfn) {
        var to
        return isElement(slfn)
          ? function (el) { return el === slfn }
          : (to = typeof slfn) == 'function'
            ? function (el, i) { return slfn.call(el, i) }
            : to == 'string' && slfn.length
              ? function (el) { return selectorMatches(slfn, el) }
              : Kfalse
      }

      // fn = !fn
    , inv = function (fn) {
        return function () {
          return !fn.apply(this, arguments)
        }
      }

    , traversty = (function () {
        function T(els) {
          this.length = 0
          if (els) {
            els = unique(!els.nodeType && !isUndefined(els.length) ? els : [ els ])
            var i = this.length = els.length
            while (i--)
              this[i] = els[i]
          }
        }

        T.prototype = {
            down: function (selector, index) {
              index = getIndex(selector, index)
              selector = getSelector(selector)
              return traversty(collect(this
                , function (el) {
                    var f = selectorFind(selector, el)
                    return index === null ? f : ([ f[index] ] || [])
                  }
                ))
            }

          , up: function (selector, index) {
              return traversty(move(this, 'parentNode', selector, index))
            }

          , parents: function () {
              return T.prototype.up.apply(this, arguments.length ? arguments : [ '*' ])
            }

          , closest: function (selector, index) {
              if (isNumber(selector)) {
                index = selector
                selector = '*'
              } else if (!isString(selector)) {
                return traversty([])
              } else if (!isNumber(index)) {
                index = 0
              }
              return traversty(move(this, 'parentNode', selector, index, true))
            }

          , previous: function (selector, index) {
              return traversty(move(this, 'previousSibling', selector, index))
            }

          , next: function (selector, index) {
              return traversty(move(this, 'nextSibling', selector, index))
            }

          , siblings: function (selector, index) {
              var self = this
                , arr = slice.call(this, 0)
                , i = 0, l = arr.length

              for (; i < l; i++) {
                arr[i] = arr[i].parentNode.firstChild
                while (!isElement(arr[i]))
                  arr[i] = arr[i].nextSibling
              }

              if (isUndefined(selector))
                selector = '*'

              return traversty(move(arr, 'nextSibling', selector || '*', index
                    , function (el, i) { return el !== self[i] } // filter
                  ))
            }

          , children: function (selector, index) {
              return traversty(move(T.prototype.down.call(this), 'nextSibling', selector || '*', index, true))
            }

          , first: function () {
              return T.prototype.eq.call(this, 0)
            }

          , last: function () {
              return T.prototype.eq.call(this, -1)
            }

          , eq: function (index) {
              return traversty(this.get(index))
            }

          , get: function (index) {
              return this[eqIndex(this.length, index, 0)]
            }

            // a crazy man wrote this, don't try to understand it, see the tests
          , slice: function (start, end) {
              var e = end, l = this.length, arr = []
              start = eqIndex(l, Math.max(-this.length, start), 0)
              e = eqIndex(end < 0 ? l : l + 1, end, l)
              end = e === null || e > l ? end < 0 ? 0 : l : e
              while (start !== null && start < end)
                arr.push(this[start++])
              return traversty(arr)
            }

          , filter: function (slfn) {
              return traversty(filter(this, filterFn(slfn)))
            }

          , not: function (slfn) {
              return traversty(filter(this, inv(filterFn(slfn))))
            }

            // similar to filter() but cares about descendent elements
          , has: function (slel) {
              return traversty(filter(
                  this
                , isElement(slel)
                    ? function (el) { return isAncestor(slel, el) }
                    : typeof slel == 'string' && slel.length
                      ? function (el) { return selectorFind(slel, el).length } //TODO: performance
                      : Kfalse
              ))
            }

            // same as filter() but return a boolean so quick-return after first successful find
          , is: function (slfn) {
              var i = 0, l = this.length
                , fn = filterFn(slfn)
              for (; i < l; i++)
                if (fn(this[i], i))
                  return true
              return false
            }

          , toArray: function () { return Ap.slice.call(this) }

          , size: function () { return this.length }

          , each: function (fn, ctx) {
              var i = 0, l = this.length
              for (; i < l; i++)
                fn.call(ctx || this[i], this[i], i, this)
              return this
            }

            // quack like a duck (Array)
          , push: Ap.push
          , sort: Ap.sort
          , splice: Ap.splice
        }

        T.prototype.prev = T.prototype.previous

        function t(els) {
          return new T(isString(els) ? selectorFind(els, doc) : els)
        }

        // extend traversty functionality with custom methods
        t.aug = function (methods) {
          var key, method
          for (key in methods) {
            method = methods[key]
            if (typeof method == 'function')
              T.prototype[key] = method
          }
        }


        t.setSelectorEngine = function (s) {
          // feature testing the selector engine like a boss
          var ss, r, a, _selectorMatches, _selectorFind
            , e = doc.createElement('p')
            , select = s.select || s.sel || s

          e.innerHTML = '<a/><i/><b/>'
          a = e.firstChild
          try {
            // YO! I HEARD YOU LIKED NESTED TERNARY OPERATORS SO I COOKED SOME UP FOR YOU!
            // (one day I might loop this...)

            // check to see how we do a matchesSelector
            _selectorMatches = isFunction(s.matching)
              ? function (selector, el) { return s.matching([el], selector).length > 0 }
              : isFunction(s.is)
                ? function (selector, el) { return s.is(el, selector) }
                : isFunction(s.matchesSelector)
                  ? function (selector, el) { return s.matchesSelector(el, selector) }
                  : isFunction(s.match)
                    ? function (selector, el) { return s.match(el, selector) }
                    : isFunction(s.matches)
                      ? function (selector, el) { return s.matches(el, selector) }
                      : null

            if (!_selectorMatches) {
              // perhaps it's an selector(x).is(y) type selector?
              ss = s('a', e)
              _selectorMatches = isFunction(ss._is)
                ? function (selector, el) { return s(el)._is(selector) } // original .is(), replaced by Ender bridge
                : isFunction(ss.matching)
                  ? function (selector, el) { return s(el).matching(selector).length > 0 }
                  : isFunction(ss.is) && !ss.is.__ignore
                    ? function (selector, el) { return s(el).is(selector) }
                      : isFunction(ss.matchesSelector)
                        ? function (selector, el) { return s(el).matchesSelector(selector) }
                        : isFunction(ss.match)
                          ? function (selector, el) { return s(el).match(selector) }
                          : isFunction(ss.matches)
                            ? function (selector, el) { return s(el).matches(selector) }
                            : null
            }

            if (!_selectorMatches)
                throw new Error('Traversty: couldn\'t find selector engine\'s `matchesSelector`')

            // verify that we have a working `matchesSelector`
            if (_selectorMatches('x,y', e) || !_selectorMatches('a,p', e))
                throw new Error('Traversty: couldn\'t make selector engine\'s `matchesSelector` work')

            // basic select
            if ((r = select('b,a', e)).length !== 2)
              throw new Error('Traversty: don\'t know how to use this selector engine')

            // check to see if the selector engine has given us the results in document-order
            // and if not, work around it
            _selectorFind = r[0] === a ? select : createUnorderedEngineSelectorFind(select, _selectorMatches)

            // have we done enough to get a working `selectorFind`?
            if ((r = _selectorFind('b,a', e)).length !== 2 || r[0] !== a)
              throw new Error('Traversty: couldn\'t make selector engine work')

            selectorMatches = _selectorMatches
            selectorFind = _selectorFind
          } catch (ex) {
            throw isString(ex)
              ? ex
              : new Error('Traversty: error while figuring out how the selector engine works: ' + (ex.message || ex))
          } finally {
            e = null
          }

          return t
        }

        t.noConflict = function () {
          context.traversty = old
          return this
        }

        return t
      }())
 
  return traversty
});
},{}],4:[function(require,module,exports){
/* ==========================================================================
   Log.js - Lightweight wrapper for console.log

   Usage: log('inside coolFunc', this, arguments);
   * paulirish.com/2009/log-a-lightweight-wrapper-for-consolelog/
   ========================================================================== */
window.log = function f() {
	log.history = log.history || [];
	log.history.push(arguments);
	if (this.console) {
		var args = arguments,
			newarr;
		try {
			args.callee = f.caller;
		} catch (e) {}
		newarr = [].slice.call(args);
		if (typeof console.log === 'object')  {
			log.apply.call(console.log, console, newarr);
		} else {
			console.log.apply(console, newarr);
		}
	}
};

},{}],5:[function(require,module,exports){
/*! 
Included shims: Array.forEach,Array.filter,Array.map,Function.bind,EventListener,Element.classList
*/

/*
    Array.prototype.forEach()
*/
if (!Array.prototype.forEach) {
    Array.prototype.forEach = function(t, e) {
        var n, r;
        if (this == null) {
            throw new TypeError(" this is null or not defined");
        }
        // 1. Let O be the result of calling ToObject passing the |this| value as the argument.
        var i = Object(this);
        // 2. Let lenValue be the result of calling the Get internal method of O with the argument "length".
        // 3. Let len be ToUint32(lenValue).
        var o = i.length >>> 0;
        // 4. If IsCallable(callback) is false, throw a TypeError exception.
        // See: http://es5.github.com/#x9.11
        if (typeof t !== "function") {
            throw new TypeError(t + " is not a function");
        }
        // 5. If thisArg was supplied, let T be thisArg; else let T be undefined.
        if (e) {
            n = e;
        }
        // 6. Let k be 0
        r = 0;
        // 7. Repeat, while k < len
        while (r < o) {
            var a;
            // a. Let Pk be ToString(k).
            //   This is implicit for LHS operands of the in operator
            // b. Let kPresent be the result of calling the HasProperty internal method of O with argument Pk.
            //   This step can be combined with c
            // c. If kPresent is true, then
            if (r in i) {
                // i. Let kValue be the result of calling the Get internal method of O with argument Pk.
                a = i[r];
                // ii. Call the Call internal method of callback with T as the this value and
                // argument list containing kValue, k, and O.
                t.call(n, a, r, i);
            }
            // d. Increase k by 1.
            r++;
        }
    };
}

/*
    Array.prototype.filter()
*/
if (!Array.prototype.filter) {
    Array.prototype.filter = function(t) {
        "use strict";
        if (this === void 0 || this === null) throw new TypeError();
        var e = Object(this);
        var n = e.length >>> 0;
        if (typeof t !== "function") throw new TypeError();
        var r = [];
        var i = arguments.length >= 2 ? arguments[1] : void 0;
        for (var o = 0; o < n; o++) {
            if (o in e) {
                var a = e[o];
                // NOTE: Technically this should Object.defineProperty at
                //       the next index, as push can be affected by
                //       properties on Object.prototype and Array.prototype.
                //       But that method's new, and collisions should be
                //       rare, so use the more-compatible alternative.
                if (t.call(i, a, o, e)) r.push(a);
            }
        }
        return r;
    };
}

/*
   Array map patch
   ========================================================================== */
if (!("map" in Array.prototype)) {
    Array.prototype.map = function(t, e) {
        var n = this.length >>> 0, r = Array(n);
        for (var i = 0; i < n; i++) {
            if (i in this) {
                r[i] = t.call(e, this[i], i, this);
            }
        }
        return r;
    };
}

/*
    Function.prototype.bind()
*/
if (!Function.prototype.bind) {
    Function.prototype.bind = function(t) {
        if (typeof this !== "function") {
            // closest thing possible to the ECMAScript 5
            // internal IsCallable function
            throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");
        }
        var e = Array.prototype.slice.call(arguments, 1), n = this, r = function() {}, i = function() {
            return n.apply(this instanceof r && t ? this : t, e.concat(Array.prototype.slice.call(arguments)));
        };
        r.prototype = this.prototype;
        i.prototype = new r();
        return i;
    };
}

// EventListener | MIT/GPL2 | https://github.com/jonathantneal/EventListener
this.Element && Element.prototype.attachEvent && !Element.prototype.addEventListener && function() {
    function t(t, e) {
        Window.prototype[t] = HTMLDocument.prototype[t] = Element.prototype[t] = e;
    }
    // add
    t("addEventListener", function(t, e) {
        var n = this, r = n.addEventListener.listeners = n.addEventListener.listeners || {}, i = r[t] = r[t] || [];
        // if no events exist, attach the listener
        if (!i.length) {
            n.attachEvent("on" + t, i.event = function(t) {
                var e = n.document && n.document.documentElement || n.documentElement || {
                    scrollLeft: 0,
                    scrollTop: 0
                };
                // polyfill w3c properties and methods
                t.currentTarget = n;
                t.pageX = t.clientX + e.scrollLeft;
                t.pageY = t.clientY + e.scrollTop;
                t.preventDefault = function() {
                    t.returnValue = false;
                };
                t.relatedTarget = t.fromElement || null;
                t.stopImmediatePropagation = function() {
                    s = false;
                    t.cancelBubble = true;
                };
                t.stopPropagation = function() {
                    t.cancelBubble = true;
                };
                t.target = t.srcElement || n;
                t.timeStamp = +new Date();
                // create an cached list of the master events list (to protect this loop from breaking when an event is removed)
                for (var r = 0, o = [].concat(i), a, s = true; s && (a = o[r]); ++r) {
                    // check to see if the cached event still exists in the master events list
                    for (var l = 0, c; c = i[l]; ++l) {
                        if (c == a) {
                            c.call(n, t);
                            break;
                        }
                    }
                }
            });
        }
        // add the event to the master event list
        i.push(e);
    });
    // remove
    t("removeEventListener", function(t, e) {
        var n = this, r = n.addEventListener.listeners = n.addEventListener.listeners || {}, i = r[t] = r[t] || [];
        // remove the newest matching event from the master event list
        for (var o = i.length - 1, a; a = i[o]; --o) {
            if (a == e) {
                i.splice(o, 1);
                break;
            }
        }
        // if no events exist, detach the listener
        if (!i.length && i.event) {
            n.detachEvent("on" + t, i.event);
        }
    });
    // dispatch
    t("dispatchEvent", function(t) {
        var e = this, n = t.type, r = e.addEventListener.listeners = e.addEventListener.listeners || {}, i = r[n] = r[n] || [];
        try {
            return e.fireEvent("on" + n, t);
        } catch (o) {
            if (i.event) {
                i.event(t);
            }
            return;
        }
    });
    // CustomEvent
    Object.defineProperty(Window.prototype, "CustomEvent", {
        get: function() {
            var t = this;
            return function e(n, r) {
                var i = t.document.createEventObject(), o;
                i.type = n;
                for (o in r) {
                    if (o == "cancelable") {
                        i.returnValue = !r.cancelable;
                    } else if (o == "bubbles") {
                        i.cancelBubble = !r.bubbles;
                    } else if (o == "detail") {
                        i.detail = r.detail;
                    }
                }
                return i;
            };
        }
    });
    // ready
    function e(t) {
        if (e.interval && document.body) {
            e.interval = clearInterval(e.interval);
            document.dispatchEvent(new CustomEvent("DOMContentLoaded"));
        }
    }
    e.interval = setInterval(e, 1);
    window.addEventListener("load", e);
}();

!this.CustomEvent && function() {
    // CustomEvent for browsers which don't natively support the Constructor method
    window.CustomEvent = function t(e, n) {
        var r;
        n = n || {
            bubbles: false,
            cancelable: false,
            detail: undefined
        };
        try {
            r = document.createEvent("CustomEvent");
            r.initCustomEvent(e, n.bubbles, n.cancelable, n.detail);
        } catch (i) {
            // for browsers which don't support CustomEvent at all, we use a regular event instead
            r = document.createEvent("Event");
            r.initEvent(e, n.bubbles, n.cancelable);
            r.detail = n.detail;
        }
        return r;
    };
}();

/*
 * classList.js: Cross-browser full element.classList implementation.
 * 2014-01-31
 *
 * By Eli Grey, http://eligrey.com
 * Public Domain.
 * NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.
 */
/*global self, document, DOMException */
/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js*/
if ("document" in self && !("classList" in document.createElement("_"))) {
    (function(t) {
        "use strict";
        if (!("Element" in t)) return;
        var e = "classList", n = "prototype", r = t.Element[n], i = Object, o = String[n].trim || function() {
            return this.replace(/^\s+|\s+$/g, "");
        }, a = Array[n].indexOf || function(t) {
            var e = 0, n = this.length;
            for (;e < n; e++) {
                if (e in this && this[e] === t) {
                    return e;
                }
            }
            return -1;
        }, s = function(t, e) {
            this.name = t;
            this.code = DOMException[t];
            this.message = e;
        }, l = function(t, e) {
            if (e === "") {
                throw new s("SYNTAX_ERR", "An invalid or illegal string was specified");
            }
            if (/\s/.test(e)) {
                throw new s("INVALID_CHARACTER_ERR", "String contains an invalid character");
            }
            return a.call(t, e);
        }, c = function(t) {
            var e = o.call(t.getAttribute("class") || ""), n = e ? e.split(/\s+/) : [], r = 0, i = n.length;
            for (;r < i; r++) {
                this.push(n[r]);
            }
            this._updateClassName = function() {
                t.setAttribute("class", this.toString());
            };
        }, u = c[n] = [], f = function() {
            return new c(this);
        };
        // Most DOMException implementations don't allow calling DOMException's toString()
        // on non-DOMExceptions. Error's toString() is sufficient here.
        s[n] = Error[n];
        u.item = function(t) {
            return this[t] || null;
        };
        u.contains = function(t) {
            t += "";
            return l(this, t) !== -1;
        };
        u.add = function() {
            var t = arguments, e = 0, n = t.length, r, i = false;
            do {
                r = t[e] + "";
                if (l(this, r) === -1) {
                    this.push(r);
                    i = true;
                }
            } while (++e < n);
            if (i) {
                this._updateClassName();
            }
        };
        u.remove = function() {
            var t = arguments, e = 0, n = t.length, r, i = false;
            do {
                r = t[e] + "";
                var o = l(this, r);
                if (o !== -1) {
                    this.splice(o, 1);
                    i = true;
                }
            } while (++e < n);
            if (i) {
                this._updateClassName();
            }
        };
        u.toggle = function(t, e) {
            t += "";
            var n = this.contains(t), r = n ? e !== true && "remove" : e !== false && "add";
            if (r) {
                this[r](t);
            }
            return !n;
        };
        u.toString = function() {
            return this.join(" ");
        };
        if (i.defineProperty) {
            var p = {
                get: f,
                enumerable: true,
                configurable: true
            };
            try {
                i.defineProperty(r, e, p);
            } catch (h) {
                // IE 8 doesn't support enumerable:true
                if (h.number === -2146823252) {
                    p.enumerable = false;
                    i.defineProperty(r, e, p);
                }
            }
        } else if (i[n].__defineGetter__) {
            r.__defineGetter__(e, f);
        }
    })(self);
}
},{}],6:[function(require,module,exports){
(function (global){
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.io=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){module.exports=_dereq_("./lib/")},{"./lib/":2}],2:[function(_dereq_,module,exports){var url=_dereq_("./url");var parser=_dereq_("socket.io-parser");var Manager=_dereq_("./manager");var debug=_dereq_("debug")("socket.io-client");module.exports=exports=lookup;var cache=exports.managers={};function lookup(uri,opts){if(typeof uri=="object"){opts=uri;uri=undefined}opts=opts||{};var parsed=url(uri);var source=parsed.source;var id=parsed.id;var io;if(opts.forceNew||opts["force new connection"]||false===opts.multiplex){debug("ignoring socket cache for %s",source);io=Manager(source,opts)}else{if(!cache[id]){debug("new io instance for %s",source);cache[id]=Manager(source,opts)}io=cache[id]}return io.socket(parsed.path)}exports.protocol=parser.protocol;exports.connect=lookup;exports.Manager=_dereq_("./manager");exports.Socket=_dereq_("./socket")},{"./manager":3,"./socket":5,"./url":6,debug:9,"socket.io-parser":40}],3:[function(_dereq_,module,exports){var url=_dereq_("./url");var eio=_dereq_("engine.io-client");var Socket=_dereq_("./socket");var Emitter=_dereq_("component-emitter");var parser=_dereq_("socket.io-parser");var on=_dereq_("./on");var bind=_dereq_("component-bind");var object=_dereq_("object-component");var debug=_dereq_("debug")("socket.io-client:manager");module.exports=Manager;function Manager(uri,opts){if(!(this instanceof Manager))return new Manager(uri,opts);if(uri&&"object"==typeof uri){opts=uri;uri=undefined}opts=opts||{};opts.path=opts.path||"/socket.io";this.nsps={};this.subs=[];this.opts=opts;this.reconnection(opts.reconnection!==false);this.reconnectionAttempts(opts.reconnectionAttempts||Infinity);this.reconnectionDelay(opts.reconnectionDelay||1e3);this.reconnectionDelayMax(opts.reconnectionDelayMax||5e3);this.timeout(null==opts.timeout?2e4:opts.timeout);this.readyState="closed";this.uri=uri;this.connected=0;this.attempts=0;this.encoding=false;this.packetBuffer=[];this.encoder=new parser.Encoder;this.decoder=new parser.Decoder;this.autoConnect=opts.autoConnect!==false;if(this.autoConnect)this.open()}Manager.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var nsp in this.nsps){this.nsps[nsp].emit.apply(this.nsps[nsp],arguments)}};Emitter(Manager.prototype);Manager.prototype.reconnection=function(v){if(!arguments.length)return this._reconnection;this._reconnection=!!v;return this};Manager.prototype.reconnectionAttempts=function(v){if(!arguments.length)return this._reconnectionAttempts;this._reconnectionAttempts=v;return this};Manager.prototype.reconnectionDelay=function(v){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=v;return this};Manager.prototype.reconnectionDelayMax=function(v){if(!arguments.length)return this._reconnectionDelayMax;this._reconnectionDelayMax=v;return this};Manager.prototype.timeout=function(v){if(!arguments.length)return this._timeout;this._timeout=v;return this};Manager.prototype.maybeReconnectOnOpen=function(){if(!this.openReconnect&&!this.reconnecting&&this._reconnection&&this.attempts===0){this.openReconnect=true;this.reconnect()}};Manager.prototype.open=Manager.prototype.connect=function(fn){debug("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;debug("opening %s",this.uri);this.engine=eio(this.uri,this.opts);var socket=this.engine;var self=this;this.readyState="opening";var openSub=on(socket,"open",function(){self.onopen();fn&&fn()});var errorSub=on(socket,"error",function(data){debug("connect_error");self.cleanup();self.readyState="closed";self.emitAll("connect_error",data);if(fn){var err=new Error("Connection error");err.data=data;fn(err)}self.maybeReconnectOnOpen()});if(false!==this._timeout){var timeout=this._timeout;debug("connect attempt will timeout after %d",timeout);var timer=setTimeout(function(){debug("connect attempt timed out after %d",timeout);openSub.destroy();socket.close();socket.emit("error","timeout");self.emitAll("connect_timeout",timeout)},timeout);this.subs.push({destroy:function(){clearTimeout(timer)}})}this.subs.push(openSub);this.subs.push(errorSub);return this};Manager.prototype.onopen=function(){debug("open");this.cleanup();this.readyState="open";this.emit("open");var socket=this.engine;this.subs.push(on(socket,"data",bind(this,"ondata")));this.subs.push(on(this.decoder,"decoded",bind(this,"ondecoded")));this.subs.push(on(socket,"error",bind(this,"onerror")));this.subs.push(on(socket,"close",bind(this,"onclose")))};Manager.prototype.ondata=function(data){this.decoder.add(data)};Manager.prototype.ondecoded=function(packet){this.emit("packet",packet)};Manager.prototype.onerror=function(err){debug("error",err);this.emitAll("error",err)};Manager.prototype.socket=function(nsp){var socket=this.nsps[nsp];if(!socket){socket=new Socket(this,nsp);this.nsps[nsp]=socket;var self=this;socket.on("connect",function(){self.connected++})}return socket};Manager.prototype.destroy=function(socket){--this.connected||this.close()};Manager.prototype.packet=function(packet){debug("writing packet %j",packet);var self=this;if(!self.encoding){self.encoding=true;this.encoder.encode(packet,function(encodedPackets){for(var i=0;i<encodedPackets.length;i++){self.engine.write(encodedPackets[i])}self.encoding=false;self.processPacketQueue()})}else{self.packetBuffer.push(packet)}};Manager.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var pack=this.packetBuffer.shift();this.packet(pack)}};Manager.prototype.cleanup=function(){var sub;while(sub=this.subs.shift())sub.destroy();this.packetBuffer=[];this.encoding=false;this.decoder.destroy()};Manager.prototype.close=Manager.prototype.disconnect=function(){this.skipReconnect=true;this.engine.close()};Manager.prototype.onclose=function(reason){debug("close");this.cleanup();this.readyState="closed";this.emit("close",reason);if(this._reconnection&&!this.skipReconnect){this.reconnect()}};Manager.prototype.reconnect=function(){if(this.reconnecting)return this;var self=this;this.attempts++;if(this.attempts>this._reconnectionAttempts){debug("reconnect failed");this.emitAll("reconnect_failed");this.reconnecting=false}else{var delay=this.attempts*this.reconnectionDelay();delay=Math.min(delay,this.reconnectionDelayMax());debug("will wait %dms before reconnect attempt",delay);this.reconnecting=true;var timer=setTimeout(function(){debug("attempting reconnect");self.emitAll("reconnect_attempt",self.attempts);self.emitAll("reconnecting",self.attempts);self.open(function(err){if(err){debug("reconnect attempt error");self.reconnecting=false;self.reconnect();self.emitAll("reconnect_error",err.data)}else{debug("reconnect success");self.onreconnect()}})},delay);this.subs.push({destroy:function(){clearTimeout(timer)}})}};Manager.prototype.onreconnect=function(){var attempt=this.attempts;this.attempts=0;this.reconnecting=false;this.emitAll("reconnect",attempt)}},{"./on":4,"./socket":5,"./url":6,"component-bind":7,"component-emitter":8,debug:9,"engine.io-client":10,"object-component":37,"socket.io-parser":40}],4:[function(_dereq_,module,exports){module.exports=on;function on(obj,ev,fn){obj.on(ev,fn);return{destroy:function(){obj.removeListener(ev,fn)}}}},{}],5:[function(_dereq_,module,exports){var parser=_dereq_("socket.io-parser");var Emitter=_dereq_("component-emitter");var toArray=_dereq_("to-array");var on=_dereq_("./on");var bind=_dereq_("component-bind");var debug=_dereq_("debug")("socket.io-client:socket");var hasBin=_dereq_("has-binary");var indexOf=_dereq_("indexof");module.exports=exports=Socket;var events={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1};var emit=Emitter.prototype.emit;function Socket(io,nsp){this.io=io;this.nsp=nsp;this.json=this;this.ids=0;this.acks={};if(this.io.autoConnect)this.open();this.receiveBuffer=[];this.sendBuffer=[];this.connected=false;this.disconnected=true;this.subEvents()}Emitter(Socket.prototype);Socket.prototype.subEvents=function(){var io=this.io;this.subs=[on(io,"open",bind(this,"onopen")),on(io,"packet",bind(this,"onpacket")),on(io,"close",bind(this,"onclose"))]};Socket.prototype.open=Socket.prototype.connect=function(){if(this.connected)return this;this.io.open();if("open"==this.io.readyState)this.onopen();return this};Socket.prototype.send=function(){var args=toArray(arguments);args.unshift("message");this.emit.apply(this,args);return this};Socket.prototype.emit=function(ev){if(events.hasOwnProperty(ev)){emit.apply(this,arguments);return this}var args=toArray(arguments);var parserType=parser.EVENT;if(hasBin(args)){parserType=parser.BINARY_EVENT}var packet={type:parserType,data:args};if("function"==typeof args[args.length-1]){debug("emitting packet with ack id %d",this.ids);this.acks[this.ids]=args.pop();packet.id=this.ids++}if(this.connected){this.packet(packet)}else{this.sendBuffer.push(packet)}return this};Socket.prototype.packet=function(packet){packet.nsp=this.nsp;this.io.packet(packet)};Socket.prototype.onopen=function(){debug("transport is open - connecting");if("/"!=this.nsp){this.packet({type:parser.CONNECT})}};Socket.prototype.onclose=function(reason){debug("close (%s)",reason);this.connected=false;this.disconnected=true;this.emit("disconnect",reason)};Socket.prototype.onpacket=function(packet){if(packet.nsp!=this.nsp)return;switch(packet.type){case parser.CONNECT:this.onconnect();break;case parser.EVENT:this.onevent(packet);break;case parser.BINARY_EVENT:this.onevent(packet);break;case parser.ACK:this.onack(packet);break;case parser.BINARY_ACK:this.onack(packet);break;case parser.DISCONNECT:this.ondisconnect();break;case parser.ERROR:this.emit("error",packet.data);break}};Socket.prototype.onevent=function(packet){var args=packet.data||[];debug("emitting event %j",args);if(null!=packet.id){debug("attaching ack callback to event");args.push(this.ack(packet.id))}if(this.connected){emit.apply(this,args)}else{this.receiveBuffer.push(args)}};Socket.prototype.ack=function(id){var self=this;var sent=false;return function(){if(sent)return;sent=true;var args=toArray(arguments);debug("sending ack %j",args);var type=hasBin(args)?parser.BINARY_ACK:parser.ACK;self.packet({type:type,id:id,data:args})}};Socket.prototype.onack=function(packet){debug("calling ack %s with %j",packet.id,packet.data);var fn=this.acks[packet.id];fn.apply(this,packet.data);delete this.acks[packet.id]};Socket.prototype.onconnect=function(){this.connected=true;this.disconnected=false;this.emit("connect");this.emitBuffered()};Socket.prototype.emitBuffered=function(){var i;for(i=0;i<this.receiveBuffer.length;i++){emit.apply(this,this.receiveBuffer[i])}this.receiveBuffer=[];for(i=0;i<this.sendBuffer.length;i++){this.packet(this.sendBuffer[i])}this.sendBuffer=[]};Socket.prototype.ondisconnect=function(){debug("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};Socket.prototype.destroy=function(){for(var i=0;i<this.subs.length;i++){this.subs[i].destroy()}this.io.destroy(this)};Socket.prototype.close=Socket.prototype.disconnect=function(){if(!this.connected)return this;debug("performing disconnect (%s)",this.nsp);this.packet({type:parser.DISCONNECT});this.destroy();this.onclose("io client disconnect");return this}},{"./on":4,"component-bind":7,"component-emitter":8,debug:9,"has-binary":32,indexof:36,"socket.io-parser":40,"to-array":44}],6:[function(_dereq_,module,exports){(function(global){var parseuri=_dereq_("parseuri");var debug=_dereq_("debug")("socket.io-client:url");module.exports=url;function url(uri,loc){var obj=uri;var loc=loc||global.location;if(null==uri)uri=loc.protocol+"//"+loc.hostname;if("string"==typeof uri){if("/"==uri.charAt(0)){if("undefined"!=typeof loc){uri=loc.hostname+uri}}if(!/^(https?|wss?):\/\//.test(uri)){debug("protocol-less url %s",uri);if("undefined"!=typeof loc){uri=loc.protocol+"//"+uri}else{uri="https://"+uri}}debug("parse %s",uri);obj=parseuri(uri)}if(!obj.port){if(/^(http|ws)$/.test(obj.protocol)){obj.port="80"}else if(/^(http|ws)s$/.test(obj.protocol)){obj.port="443"}}obj.path=obj.path||"/";obj.id=obj.protocol+"://"+obj.host+":"+obj.port;obj.href=obj.protocol+"://"+obj.host+(loc&&loc.port==obj.port?"":":"+obj.port);return obj}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{debug:9,parseuri:38}],7:[function(_dereq_,module,exports){var slice=[].slice;module.exports=function(obj,fn){if("string"==typeof fn)fn=obj[fn];if("function"!=typeof fn)throw new Error("bind() requires a function");var args=slice.call(arguments,2);return function(){return fn.apply(obj,args.concat(slice.call(arguments)))}}},{}],8:[function(_dereq_,module,exports){module.exports=Emitter;function Emitter(obj){if(obj)return mixin(obj)}function mixin(obj){for(var key in Emitter.prototype){obj[key]=Emitter.prototype[key]}return obj}Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){this._callbacks=this._callbacks||{};(this._callbacks[event]=this._callbacks[event]||[]).push(fn);return this};Emitter.prototype.once=function(event,fn){var self=this;this._callbacks=this._callbacks||{};function on(){self.off(event,on);fn.apply(this,arguments)}on.fn=fn;this.on(event,on);return this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var callbacks=this._callbacks[event];if(!callbacks)return this;if(1==arguments.length){delete this._callbacks[event];return this}var cb;for(var i=0;i<callbacks.length;i++){cb=callbacks[i];if(cb===fn||cb.fn===fn){callbacks.splice(i,1);break}}return this};Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks[event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;i<len;++i){callbacks[i].apply(this,args)}}return this};Emitter.prototype.listeners=function(event){this._callbacks=this._callbacks||{};return this._callbacks[event]||[]};Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}},{}],9:[function(_dereq_,module,exports){module.exports=debug;function debug(name){if(!debug.enabled(name))return function(){};return function(fmt){fmt=coerce(fmt);var curr=new Date;var ms=curr-(debug[name]||curr);debug[name]=curr;fmt=name+" "+fmt+" +"+debug.humanize(ms);window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}}debug.names=[];debug.skips=[];debug.enable=function(name){try{localStorage.debug=name}catch(e){}var split=(name||"").split(/[\s,]+/),len=split.length;for(var i=0;i<len;i++){name=split[i].replace("*",".*?");if(name[0]==="-"){debug.skips.push(new RegExp("^"+name.substr(1)+"$"))}else{debug.names.push(new RegExp("^"+name+"$"))}}};debug.disable=function(){debug.enable("")};debug.humanize=function(ms){var sec=1e3,min=60*1e3,hour=60*min;if(ms>=hour)return(ms/hour).toFixed(1)+"h";if(ms>=min)return(ms/min).toFixed(1)+"m";if(ms>=sec)return(ms/sec|0)+"s";return ms+"ms"};debug.enabled=function(name){for(var i=0,len=debug.skips.length;i<len;i++){if(debug.skips[i].test(name)){return false}}for(var i=0,len=debug.names.length;i<len;i++){if(debug.names[i].test(name)){return true}}return false};function coerce(val){if(val instanceof Error)return val.stack||val.message;return val}try{if(window.localStorage)debug.enable(localStorage.debug)}catch(e){}},{}],10:[function(_dereq_,module,exports){module.exports=_dereq_("./lib/")},{"./lib/":11}],11:[function(_dereq_,module,exports){module.exports=_dereq_("./socket");module.exports.parser=_dereq_("engine.io-parser")},{"./socket":12,"engine.io-parser":21}],12:[function(_dereq_,module,exports){(function(global){var transports=_dereq_("./transports");var Emitter=_dereq_("component-emitter");var debug=_dereq_("debug")("engine.io-client:socket");var index=_dereq_("indexof");var parser=_dereq_("engine.io-parser");var parseuri=_dereq_("parseuri");var parsejson=_dereq_("parsejson");var parseqs=_dereq_("parseqs");module.exports=Socket;function noop(){}function Socket(uri,opts){if(!(this instanceof Socket))return new Socket(uri,opts);opts=opts||{};if(uri&&"object"==typeof uri){opts=uri;uri=null}if(uri){uri=parseuri(uri);opts.host=uri.host;opts.secure=uri.protocol=="https"||uri.protocol=="wss";opts.port=uri.port;if(uri.query)opts.query=uri.query}this.secure=null!=opts.secure?opts.secure:global.location&&"https:"==location.protocol;if(opts.host){var pieces=opts.host.split(":");opts.hostname=pieces.shift();if(pieces.length)opts.port=pieces.pop()}this.agent=opts.agent||false;this.hostname=opts.hostname||(global.location?location.hostname:"localhost");this.port=opts.port||(global.location&&location.port?location.port:this.secure?443:80);this.query=opts.query||{};if("string"==typeof this.query)this.query=parseqs.decode(this.query);this.upgrade=false!==opts.upgrade;this.path=(opts.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!opts.forceJSONP;this.jsonp=false!==opts.jsonp;this.forceBase64=!!opts.forceBase64;this.enablesXDR=!!opts.enablesXDR;this.timestampParam=opts.timestampParam||"t";this.timestampRequests=opts.timestampRequests;this.transports=opts.transports||["polling","websocket"];this.readyState="";this.writeBuffer=[];this.callbackBuffer=[];this.policyPort=opts.policyPort||843;this.rememberUpgrade=opts.rememberUpgrade||false;this.open();this.binaryType=null;this.onlyBinaryUpgrades=opts.onlyBinaryUpgrades}Socket.priorWebsocketSuccess=false;Emitter(Socket.prototype);Socket.protocol=parser.protocol;Socket.Socket=Socket;Socket.Transport=_dereq_("./transport");Socket.transports=_dereq_("./transports");Socket.parser=_dereq_("engine.io-parser");Socket.prototype.createTransport=function(name){debug('creating transport "%s"',name);var query=clone(this.query);query.EIO=parser.protocol;query.transport=name;if(this.id)query.sid=this.id;var transport=new transports[name]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:query,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this});return transport};function clone(obj){var o={};for(var i in obj){if(obj.hasOwnProperty(i)){o[i]=obj[i]}}return o}Socket.prototype.open=function(){var transport;if(this.rememberUpgrade&&Socket.priorWebsocketSuccess&&this.transports.indexOf("websocket")!=-1){transport="websocket"}else if(0==this.transports.length){var self=this;setTimeout(function(){self.emit("error","No transports available")},0);return}else{transport=this.transports[0]}this.readyState="opening";var transport;try{transport=this.createTransport(transport)}catch(e){this.transports.shift();this.open();return}transport.open();this.setTransport(transport)};Socket.prototype.setTransport=function(transport){debug("setting transport %s",transport.name);var self=this;if(this.transport){debug("clearing existing transport %s",this.transport.name);this.transport.removeAllListeners()}this.transport=transport;transport.on("drain",function(){self.onDrain()}).on("packet",function(packet){self.onPacket(packet)}).on("error",function(e){self.onError(e)}).on("close",function(){self.onClose("transport close")})};Socket.prototype.probe=function(name){debug('probing transport "%s"',name);var transport=this.createTransport(name,{probe:1}),failed=false,self=this;Socket.priorWebsocketSuccess=false;function onTransportOpen(){if(self.onlyBinaryUpgrades){var upgradeLosesBinary=!this.supportsBinary&&self.transport.supportsBinary;failed=failed||upgradeLosesBinary}if(failed)return;debug('probe transport "%s" opened',name);transport.send([{type:"ping",data:"probe"}]);transport.once("packet",function(msg){if(failed)return;if("pong"==msg.type&&"probe"==msg.data){debug('probe transport "%s" pong',name);self.upgrading=true;self.emit("upgrading",transport);Socket.priorWebsocketSuccess="websocket"==transport.name;debug('pausing current transport "%s"',self.transport.name);self.transport.pause(function(){if(failed)return;if("closed"==self.readyState||"closing"==self.readyState){return}debug("changing transport and sending upgrade packet");cleanup();self.setTransport(transport);transport.send([{type:"upgrade"}]);self.emit("upgrade",transport);transport=null;self.upgrading=false;self.flush()})}else{debug('probe transport "%s" failed',name);var err=new Error("probe error");err.transport=transport.name;self.emit("upgradeError",err)}})}function freezeTransport(){if(failed)return;failed=true;cleanup();transport.close();transport=null}function onerror(err){var error=new Error("probe error: "+err);error.transport=transport.name;freezeTransport();debug('probe transport "%s" failed because of error: %s',name,err);self.emit("upgradeError",error)}function onTransportClose(){onerror("transport closed")}function onclose(){onerror("socket closed")}function onupgrade(to){if(transport&&to.name!=transport.name){debug('"%s" works - aborting "%s"',to.name,transport.name);freezeTransport()}}function cleanup(){transport.removeListener("open",onTransportOpen);transport.removeListener("error",onerror);transport.removeListener("close",onTransportClose);self.removeListener("close",onclose);self.removeListener("upgrading",onupgrade)}transport.once("open",onTransportOpen);transport.once("error",onerror);transport.once("close",onTransportClose);this.once("close",onclose);this.once("upgrading",onupgrade);transport.open()};Socket.prototype.onOpen=function(){debug("socket open");this.readyState="open";Socket.priorWebsocketSuccess="websocket"==this.transport.name;this.emit("open");this.flush();if("open"==this.readyState&&this.upgrade&&this.transport.pause){debug("starting upgrade probes");for(var i=0,l=this.upgrades.length;i<l;i++){this.probe(this.upgrades[i])}}};Socket.prototype.onPacket=function(packet){if("opening"==this.readyState||"open"==this.readyState){debug('socket receive: type "%s", data "%s"',packet.type,packet.data);this.emit("packet",packet);this.emit("heartbeat");switch(packet.type){case"open":this.onHandshake(parsejson(packet.data));break;case"pong":this.setPing();break;case"error":var err=new Error("server error");err.code=packet.data;this.emit("error",err);break;case"message":this.emit("data",packet.data);this.emit("message",packet.data);break}}else{debug('packet received with socket readyState "%s"',this.readyState)}};Socket.prototype.onHandshake=function(data){this.emit("handshake",data);this.id=data.sid;this.transport.query.sid=data.sid;this.upgrades=this.filterUpgrades(data.upgrades);this.pingInterval=data.pingInterval;this.pingTimeout=data.pingTimeout;this.onOpen();if("closed"==this.readyState)return;this.setPing();this.removeListener("heartbeat",this.onHeartbeat);this.on("heartbeat",this.onHeartbeat)};Socket.prototype.onHeartbeat=function(timeout){clearTimeout(this.pingTimeoutTimer);var self=this;self.pingTimeoutTimer=setTimeout(function(){if("closed"==self.readyState)return;self.onClose("ping timeout")},timeout||self.pingInterval+self.pingTimeout)};Socket.prototype.setPing=function(){var self=this;clearTimeout(self.pingIntervalTimer);self.pingIntervalTimer=setTimeout(function(){debug("writing ping packet - expecting pong within %sms",self.pingTimeout);self.ping();self.onHeartbeat(self.pingTimeout)},self.pingInterval)};Socket.prototype.ping=function(){this.sendPacket("ping")};Socket.prototype.onDrain=function(){for(var i=0;i<this.prevBufferLen;i++){if(this.callbackBuffer[i]){this.callbackBuffer[i]()}}this.writeBuffer.splice(0,this.prevBufferLen);this.callbackBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;if(this.writeBuffer.length==0){this.emit("drain")}else{this.flush()}};Socket.prototype.flush=function(){if("closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){debug("flushing %d packets in socket",this.writeBuffer.length);this.transport.send(this.writeBuffer);this.prevBufferLen=this.writeBuffer.length;this.emit("flush")}};Socket.prototype.write=Socket.prototype.send=function(msg,fn){this.sendPacket("message",msg,fn);return this};Socket.prototype.sendPacket=function(type,data,fn){var packet={type:type,data:data};this.emit("packetCreate",packet);this.writeBuffer.push(packet);this.callbackBuffer.push(fn);this.flush()};Socket.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState){this.onClose("forced close");debug("socket closing - telling transport to close");this.transport.close()}return this};Socket.prototype.onError=function(err){debug("socket error %j",err);Socket.priorWebsocketSuccess=false;this.emit("error",err);this.onClose("transport error",err)};Socket.prototype.onClose=function(reason,desc){if("opening"==this.readyState||"open"==this.readyState){debug('socket close with reason: "%s"',reason);var self=this;clearTimeout(this.pingIntervalTimer);clearTimeout(this.pingTimeoutTimer);setTimeout(function(){self.writeBuffer=[];self.callbackBuffer=[];self.prevBufferLen=0},0);this.transport.removeAllListeners("close");this.transport.close();this.transport.removeAllListeners();this.readyState="closed";this.id=null;this.emit("close",reason,desc)}};Socket.prototype.filterUpgrades=function(upgrades){var filteredUpgrades=[];for(var i=0,j=upgrades.length;i<j;i++){if(~index(this.transports,upgrades[i]))filteredUpgrades.push(upgrades[i])}return filteredUpgrades}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./transport":13,"./transports":14,"component-emitter":8,debug:9,"engine.io-parser":21,indexof:36,parsejson:28,parseqs:29,parseuri:30}],13:[function(_dereq_,module,exports){var parser=_dereq_("engine.io-parser");var Emitter=_dereq_("component-emitter");module.exports=Transport;function Transport(opts){this.path=opts.path;this.hostname=opts.hostname;this.port=opts.port;this.secure=opts.secure;this.query=opts.query;this.timestampParam=opts.timestampParam;this.timestampRequests=opts.timestampRequests;this.readyState="";this.agent=opts.agent||false;this.socket=opts.socket;this.enablesXDR=opts.enablesXDR}Emitter(Transport.prototype);Transport.timestamps=0;Transport.prototype.onError=function(msg,desc){var err=new Error(msg);err.type="TransportError";err.description=desc;this.emit("error",err);return this};Transport.prototype.open=function(){if("closed"==this.readyState||""==this.readyState){this.readyState="opening";this.doOpen()}return this};Transport.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState){this.doClose();this.onClose()}return this};Transport.prototype.send=function(packets){if("open"==this.readyState){this.write(packets)}else{throw new Error("Transport not open")}};Transport.prototype.onOpen=function(){this.readyState="open";this.writable=true;this.emit("open")};Transport.prototype.onData=function(data){var packet=parser.decodePacket(data,this.socket.binaryType);this.onPacket(packet)};Transport.prototype.onPacket=function(packet){this.emit("packet",packet)};Transport.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},{"component-emitter":8,"engine.io-parser":21}],14:[function(_dereq_,module,exports){(function(global){var XMLHttpRequest=_dereq_("xmlhttprequest");var XHR=_dereq_("./polling-xhr");var JSONP=_dereq_("./polling-jsonp");var websocket=_dereq_("./websocket");exports.polling=polling;exports.websocket=websocket;function polling(opts){var xhr;var xd=false;var xs=false;var jsonp=false!==opts.jsonp;if(global.location){var isSSL="https:"==location.protocol;var port=location.port;if(!port){port=isSSL?443:80}xd=opts.hostname!=location.hostname||port!=opts.port;xs=opts.secure!=isSSL}opts.xdomain=xd;opts.xscheme=xs;xhr=new XMLHttpRequest(opts);if("open"in xhr&&!opts.forceJSONP){return new XHR(opts)}else{if(!jsonp)throw new Error("JSONP disabled");return new JSONP(opts)}}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./polling-jsonp":15,"./polling-xhr":16,"./websocket":18,xmlhttprequest:19}],15:[function(_dereq_,module,exports){(function(global){var Polling=_dereq_("./polling");var inherit=_dereq_("component-inherit");module.exports=JSONPPolling;var rNewline=/\n/g;var rEscapedNewline=/\\n/g;var callbacks;var index=0;function empty(){}function JSONPPolling(opts){Polling.call(this,opts);this.query=this.query||{};if(!callbacks){if(!global.___eio)global.___eio=[];callbacks=global.___eio}this.index=callbacks.length;var self=this;callbacks.push(function(msg){self.onData(msg)});this.query.j=this.index;if(global.document&&global.addEventListener){global.addEventListener("beforeunload",function(){if(self.script)self.script.onerror=empty})}}inherit(JSONPPolling,Polling);JSONPPolling.prototype.supportsBinary=false;JSONPPolling.prototype.doClose=function(){if(this.script){this.script.parentNode.removeChild(this.script);this.script=null}if(this.form){this.form.parentNode.removeChild(this.form);this.form=null}Polling.prototype.doClose.call(this)};JSONPPolling.prototype.doPoll=function(){var self=this;var script=document.createElement("script");if(this.script){this.script.parentNode.removeChild(this.script);this.script=null}script.async=true;script.src=this.uri();script.onerror=function(e){self.onError("jsonp poll error",e)};var insertAt=document.getElementsByTagName("script")[0];insertAt.parentNode.insertBefore(script,insertAt);this.script=script;var isUAgecko="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);if(isUAgecko){setTimeout(function(){var iframe=document.createElement("iframe");document.body.appendChild(iframe);document.body.removeChild(iframe)},100)}};JSONPPolling.prototype.doWrite=function(data,fn){var self=this;if(!this.form){var form=document.createElement("form");var area=document.createElement("textarea");var id=this.iframeId="eio_iframe_"+this.index;var iframe;form.className="socketio";form.style.position="absolute";form.style.top="-1000px";form.style.left="-1000px";form.target=id;form.method="POST";form.setAttribute("accept-charset","utf-8");area.name="d";form.appendChild(area);document.body.appendChild(form);this.form=form;this.area=area}this.form.action=this.uri();function complete(){initIframe();fn()}function initIframe(){if(self.iframe){try{self.form.removeChild(self.iframe)}catch(e){self.onError("jsonp polling iframe removal error",e)}}try{var html='<iframe src="javascript:0" name="'+self.iframeId+'">';iframe=document.createElement(html)}catch(e){iframe=document.createElement("iframe");iframe.name=self.iframeId;iframe.src="javascript:0"}iframe.id=self.iframeId;self.form.appendChild(iframe);self.iframe=iframe}initIframe();data=data.replace(rEscapedNewline,"\\\n");this.area.value=data.replace(rNewline,"\\n");try{this.form.submit()}catch(e){}if(this.iframe.attachEvent){this.iframe.onreadystatechange=function(){if(self.iframe.readyState=="complete"){complete()}}}else{this.iframe.onload=complete}}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./polling":17,"component-inherit":20}],16:[function(_dereq_,module,exports){(function(global){var XMLHttpRequest=_dereq_("xmlhttprequest");var Polling=_dereq_("./polling");
var Emitter=_dereq_("component-emitter");var inherit=_dereq_("component-inherit");var debug=_dereq_("debug")("engine.io-client:polling-xhr");module.exports=XHR;module.exports.Request=Request;function empty(){}function XHR(opts){Polling.call(this,opts);if(global.location){var isSSL="https:"==location.protocol;var port=location.port;if(!port){port=isSSL?443:80}this.xd=opts.hostname!=global.location.hostname||port!=opts.port;this.xs=opts.secure!=isSSL}}inherit(XHR,Polling);XHR.prototype.supportsBinary=true;XHR.prototype.request=function(opts){opts=opts||{};opts.uri=this.uri();opts.xd=this.xd;opts.xs=this.xs;opts.agent=this.agent||false;opts.supportsBinary=this.supportsBinary;opts.enablesXDR=this.enablesXDR;return new Request(opts)};XHR.prototype.doWrite=function(data,fn){var isBinary=typeof data!=="string"&&data!==undefined;var req=this.request({method:"POST",data:data,isBinary:isBinary});var self=this;req.on("success",fn);req.on("error",function(err){self.onError("xhr post error",err)});this.sendXhr=req};XHR.prototype.doPoll=function(){debug("xhr poll");var req=this.request();var self=this;req.on("data",function(data){self.onData(data)});req.on("error",function(err){self.onError("xhr poll error",err)});this.pollXhr=req};function Request(opts){this.method=opts.method||"GET";this.uri=opts.uri;this.xd=!!opts.xd;this.xs=!!opts.xs;this.async=false!==opts.async;this.data=undefined!=opts.data?opts.data:null;this.agent=opts.agent;this.isBinary=opts.isBinary;this.supportsBinary=opts.supportsBinary;this.enablesXDR=opts.enablesXDR;this.create()}Emitter(Request.prototype);Request.prototype.create=function(){var xhr=this.xhr=new XMLHttpRequest({agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR});var self=this;try{debug("xhr open %s: %s",this.method,this.uri);xhr.open(this.method,this.uri,this.async);if(this.supportsBinary){xhr.responseType="arraybuffer"}if("POST"==this.method){try{if(this.isBinary){xhr.setRequestHeader("Content-type","application/octet-stream")}else{xhr.setRequestHeader("Content-type","text/plain;charset=UTF-8")}}catch(e){}}if("withCredentials"in xhr){xhr.withCredentials=true}if(this.hasXDR()){xhr.onload=function(){self.onLoad()};xhr.onerror=function(){self.onError(xhr.responseText)}}else{xhr.onreadystatechange=function(){if(4!=xhr.readyState)return;if(200==xhr.status||1223==xhr.status){self.onLoad()}else{setTimeout(function(){self.onError(xhr.status)},0)}}}debug("xhr data %s",this.data);xhr.send(this.data)}catch(e){setTimeout(function(){self.onError(e)},0);return}if(global.document){this.index=Request.requestsCount++;Request.requests[this.index]=this}};Request.prototype.onSuccess=function(){this.emit("success");this.cleanup()};Request.prototype.onData=function(data){this.emit("data",data);this.onSuccess()};Request.prototype.onError=function(err){this.emit("error",err);this.cleanup()};Request.prototype.cleanup=function(){if("undefined"==typeof this.xhr||null===this.xhr){return}if(this.hasXDR()){this.xhr.onload=this.xhr.onerror=empty}else{this.xhr.onreadystatechange=empty}try{this.xhr.abort()}catch(e){}if(global.document){delete Request.requests[this.index]}this.xhr=null};Request.prototype.onLoad=function(){var data;try{var contentType;try{contentType=this.xhr.getResponseHeader("Content-Type")}catch(e){}if(contentType==="application/octet-stream"){data=this.xhr.response}else{if(!this.supportsBinary){data=this.xhr.responseText}else{data="ok"}}}catch(e){this.onError(e)}if(null!=data){this.onData(data)}};Request.prototype.hasXDR=function(){return"undefined"!==typeof global.XDomainRequest&&!this.xs&&this.enablesXDR};Request.prototype.abort=function(){this.cleanup()};if(global.document){Request.requestsCount=0;Request.requests={};if(global.attachEvent){global.attachEvent("onunload",unloadHandler)}else if(global.addEventListener){global.addEventListener("beforeunload",unloadHandler)}}function unloadHandler(){for(var i in Request.requests){if(Request.requests.hasOwnProperty(i)){Request.requests[i].abort()}}}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./polling":17,"component-emitter":8,"component-inherit":20,debug:9,xmlhttprequest:19}],17:[function(_dereq_,module,exports){var Transport=_dereq_("../transport");var parseqs=_dereq_("parseqs");var parser=_dereq_("engine.io-parser");var inherit=_dereq_("component-inherit");var debug=_dereq_("debug")("engine.io-client:polling");module.exports=Polling;var hasXHR2=function(){var XMLHttpRequest=_dereq_("xmlhttprequest");var xhr=new XMLHttpRequest({agent:this.agent,xdomain:false});return null!=xhr.responseType}();function Polling(opts){var forceBase64=opts&&opts.forceBase64;if(!hasXHR2||forceBase64){this.supportsBinary=false}Transport.call(this,opts)}inherit(Polling,Transport);Polling.prototype.name="polling";Polling.prototype.doOpen=function(){this.poll()};Polling.prototype.pause=function(onPause){var pending=0;var self=this;this.readyState="pausing";function pause(){debug("paused");self.readyState="paused";onPause()}if(this.polling||!this.writable){var total=0;if(this.polling){debug("we are currently polling - waiting to pause");total++;this.once("pollComplete",function(){debug("pre-pause polling complete");--total||pause()})}if(!this.writable){debug("we are currently writing - waiting to pause");total++;this.once("drain",function(){debug("pre-pause writing complete");--total||pause()})}}else{pause()}};Polling.prototype.poll=function(){debug("polling");this.polling=true;this.doPoll();this.emit("poll")};Polling.prototype.onData=function(data){var self=this;debug("polling got data %s",data);var callback=function(packet,index,total){if("opening"==self.readyState){self.onOpen()}if("close"==packet.type){self.onClose();return false}self.onPacket(packet)};parser.decodePayload(data,this.socket.binaryType,callback);if("closed"!=this.readyState){this.polling=false;this.emit("pollComplete");if("open"==this.readyState){this.poll()}else{debug('ignoring poll - transport state "%s"',this.readyState)}}};Polling.prototype.doClose=function(){var self=this;function close(){debug("writing close packet");self.write([{type:"close"}])}if("open"==this.readyState){debug("transport open - closing");close()}else{debug("transport not open - deferring close");this.once("open",close)}};Polling.prototype.write=function(packets){var self=this;this.writable=false;var callbackfn=function(){self.writable=true;self.emit("drain")};var self=this;parser.encodePayload(packets,this.supportsBinary,function(data){self.doWrite(data,callbackfn)})};Polling.prototype.uri=function(){var query=this.query||{};var schema=this.secure?"https":"http";var port="";if(false!==this.timestampRequests){query[this.timestampParam]=+new Date+"-"+Transport.timestamps++}if(!this.supportsBinary&&!query.sid){query.b64=1}query=parseqs.encode(query);if(this.port&&("https"==schema&&this.port!=443||"http"==schema&&this.port!=80)){port=":"+this.port}if(query.length){query="?"+query}return schema+"://"+this.hostname+port+this.path+query}},{"../transport":13,"component-inherit":20,debug:9,"engine.io-parser":21,parseqs:29,xmlhttprequest:19}],18:[function(_dereq_,module,exports){var Transport=_dereq_("../transport");var parser=_dereq_("engine.io-parser");var parseqs=_dereq_("parseqs");var inherit=_dereq_("component-inherit");var debug=_dereq_("debug")("engine.io-client:websocket");var WebSocket=_dereq_("ws");module.exports=WS;function WS(opts){var forceBase64=opts&&opts.forceBase64;if(forceBase64){this.supportsBinary=false}Transport.call(this,opts)}inherit(WS,Transport);WS.prototype.name="websocket";WS.prototype.supportsBinary=true;WS.prototype.doOpen=function(){if(!this.check()){return}var self=this;var uri=this.uri();var protocols=void 0;var opts={agent:this.agent};this.ws=new WebSocket(uri,protocols,opts);if(this.ws.binaryType===undefined){this.supportsBinary=false}this.ws.binaryType="arraybuffer";this.addEventListeners()};WS.prototype.addEventListeners=function(){var self=this;this.ws.onopen=function(){self.onOpen()};this.ws.onclose=function(){self.onClose()};this.ws.onmessage=function(ev){self.onData(ev.data)};this.ws.onerror=function(e){self.onError("websocket error",e)}};if("undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)){WS.prototype.onData=function(data){var self=this;setTimeout(function(){Transport.prototype.onData.call(self,data)},0)}}WS.prototype.write=function(packets){var self=this;this.writable=false;for(var i=0,l=packets.length;i<l;i++){parser.encodePacket(packets[i],this.supportsBinary,function(data){try{self.ws.send(data)}catch(e){debug("websocket closed before onclose event")}})}function ondrain(){self.writable=true;self.emit("drain")}setTimeout(ondrain,0)};WS.prototype.onClose=function(){Transport.prototype.onClose.call(this)};WS.prototype.doClose=function(){if(typeof this.ws!=="undefined"){this.ws.close()}};WS.prototype.uri=function(){var query=this.query||{};var schema=this.secure?"wss":"ws";var port="";if(this.port&&("wss"==schema&&this.port!=443||"ws"==schema&&this.port!=80)){port=":"+this.port}if(this.timestampRequests){query[this.timestampParam]=+new Date}if(!this.supportsBinary){query.b64=1}query=parseqs.encode(query);if(query.length){query="?"+query}return schema+"://"+this.hostname+port+this.path+query};WS.prototype.check=function(){return!!WebSocket&&!("__initialize"in WebSocket&&this.name===WS.prototype.name)}},{"../transport":13,"component-inherit":20,debug:9,"engine.io-parser":21,parseqs:29,ws:31}],19:[function(_dereq_,module,exports){var hasCORS=_dereq_("has-cors");module.exports=function(opts){var xdomain=opts.xdomain;var xscheme=opts.xscheme;var enablesXDR=opts.enablesXDR;try{if("undefined"!=typeof XDomainRequest&&!xscheme&&enablesXDR){return new XDomainRequest}}catch(e){}try{if("undefined"!=typeof XMLHttpRequest&&(!xdomain||hasCORS)){return new XMLHttpRequest}}catch(e){}if(!xdomain){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}}},{"has-cors":34}],20:[function(_dereq_,module,exports){module.exports=function(a,b){var fn=function(){};fn.prototype=b.prototype;a.prototype=new fn;a.prototype.constructor=a}},{}],21:[function(_dereq_,module,exports){(function(global){var keys=_dereq_("./keys");var sliceBuffer=_dereq_("arraybuffer.slice");var base64encoder=_dereq_("base64-arraybuffer");var after=_dereq_("after");var utf8=_dereq_("utf8");var isAndroid=navigator.userAgent.match(/Android/i);exports.protocol=3;var packets=exports.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6};var packetslist=keys(packets);var err={type:"error",data:"parser error"};var Blob=_dereq_("blob");exports.encodePacket=function(packet,supportsBinary,utf8encode,callback){if("function"==typeof supportsBinary){callback=supportsBinary;supportsBinary=false}if("function"==typeof utf8encode){callback=utf8encode;utf8encode=null}var data=packet.data===undefined?undefined:packet.data.buffer||packet.data;if(global.ArrayBuffer&&data instanceof ArrayBuffer){return encodeArrayBuffer(packet,supportsBinary,callback)}else if(Blob&&data instanceof global.Blob){return encodeBlob(packet,supportsBinary,callback)}var encoded=packets[packet.type];if(undefined!==packet.data){encoded+=utf8encode?utf8.encode(String(packet.data)):String(packet.data)}return callback(""+encoded)};function encodeArrayBuffer(packet,supportsBinary,callback){if(!supportsBinary){return exports.encodeBase64Packet(packet,callback)}var data=packet.data;var contentArray=new Uint8Array(data);var resultBuffer=new Uint8Array(1+data.byteLength);resultBuffer[0]=packets[packet.type];for(var i=0;i<contentArray.length;i++){resultBuffer[i+1]=contentArray[i]}return callback(resultBuffer.buffer)}function encodeBlobAsArrayBuffer(packet,supportsBinary,callback){if(!supportsBinary){return exports.encodeBase64Packet(packet,callback)}var fr=new FileReader;fr.onload=function(){packet.data=fr.result;exports.encodePacket(packet,supportsBinary,true,callback)};return fr.readAsArrayBuffer(packet.data)}function encodeBlob(packet,supportsBinary,callback){if(!supportsBinary){return exports.encodeBase64Packet(packet,callback)}if(isAndroid){return encodeBlobAsArrayBuffer(packet,supportsBinary,callback)}var length=new Uint8Array(1);length[0]=packets[packet.type];var blob=new Blob([length.buffer,packet.data]);return callback(blob)}exports.encodeBase64Packet=function(packet,callback){var message="b"+exports.packets[packet.type];if(Blob&&packet.data instanceof Blob){var fr=new FileReader;fr.onload=function(){var b64=fr.result.split(",")[1];callback(message+b64)};return fr.readAsDataURL(packet.data)}var b64data;try{b64data=String.fromCharCode.apply(null,new Uint8Array(packet.data))}catch(e){var typed=new Uint8Array(packet.data);var basic=new Array(typed.length);for(var i=0;i<typed.length;i++){basic[i]=typed[i]}b64data=String.fromCharCode.apply(null,basic)}message+=global.btoa(b64data);return callback(message)};exports.decodePacket=function(data,binaryType,utf8decode){if(typeof data=="string"||data===undefined){if(data.charAt(0)=="b"){return exports.decodeBase64Packet(data.substr(1),binaryType)}if(utf8decode){try{data=utf8.decode(data)}catch(e){return err}}var type=data.charAt(0);if(Number(type)!=type||!packetslist[type]){return err}if(data.length>1){return{type:packetslist[type],data:data.substring(1)}}else{return{type:packetslist[type]}}}var asArray=new Uint8Array(data);var type=asArray[0];var rest=sliceBuffer(data,1);if(Blob&&binaryType==="blob"){rest=new Blob([rest])}return{type:packetslist[type],data:rest}};exports.decodeBase64Packet=function(msg,binaryType){var type=packetslist[msg.charAt(0)];if(!global.ArrayBuffer){return{type:type,data:{base64:true,data:msg.substr(1)}}}var data=base64encoder.decode(msg.substr(1));if(binaryType==="blob"&&Blob){data=new Blob([data])}return{type:type,data:data}};exports.encodePayload=function(packets,supportsBinary,callback){if(typeof supportsBinary=="function"){callback=supportsBinary;supportsBinary=null}if(supportsBinary){if(Blob&&!isAndroid){return exports.encodePayloadAsBlob(packets,callback)}return exports.encodePayloadAsArrayBuffer(packets,callback)}if(!packets.length){return callback("0:")}function setLengthHeader(message){return message.length+":"+message}function encodeOne(packet,doneCallback){exports.encodePacket(packet,supportsBinary,true,function(message){doneCallback(null,setLengthHeader(message))})}map(packets,encodeOne,function(err,results){return callback(results.join(""))})};function map(ary,each,done){var result=new Array(ary.length);var next=after(ary.length,done);var eachWithIndex=function(i,el,cb){each(el,function(error,msg){result[i]=msg;cb(error,result)})};for(var i=0;i<ary.length;i++){eachWithIndex(i,ary[i],next)}}exports.decodePayload=function(data,binaryType,callback){if(typeof data!="string"){return exports.decodePayloadAsBinary(data,binaryType,callback)}if(typeof binaryType==="function"){callback=binaryType;binaryType=null}var packet;if(data==""){return callback(err,0,1)}var length="",n,msg;for(var i=0,l=data.length;i<l;i++){var chr=data.charAt(i);if(":"!=chr){length+=chr}else{if(""==length||length!=(n=Number(length))){return callback(err,0,1)}msg=data.substr(i+1,n);if(length!=msg.length){return callback(err,0,1)}if(msg.length){packet=exports.decodePacket(msg,binaryType,true);if(err.type==packet.type&&err.data==packet.data){return callback(err,0,1)}var ret=callback(packet,i+n,l);if(false===ret)return}i+=n;length=""}}if(length!=""){return callback(err,0,1)}};exports.encodePayloadAsArrayBuffer=function(packets,callback){if(!packets.length){return callback(new ArrayBuffer(0))}function encodeOne(packet,doneCallback){exports.encodePacket(packet,true,true,function(data){return doneCallback(null,data)})}map(packets,encodeOne,function(err,encodedPackets){var totalLength=encodedPackets.reduce(function(acc,p){var len;if(typeof p==="string"){len=p.length}else{len=p.byteLength}return acc+len.toString().length+len+2},0);var resultArray=new Uint8Array(totalLength);var bufferIndex=0;encodedPackets.forEach(function(p){var isString=typeof p==="string";var ab=p;if(isString){var view=new Uint8Array(p.length);for(var i=0;i<p.length;i++){view[i]=p.charCodeAt(i)}ab=view.buffer}if(isString){resultArray[bufferIndex++]=0}else{resultArray[bufferIndex++]=1}var lenStr=ab.byteLength.toString();for(var i=0;i<lenStr.length;i++){resultArray[bufferIndex++]=parseInt(lenStr[i])}resultArray[bufferIndex++]=255;var view=new Uint8Array(ab);for(var i=0;i<view.length;i++){resultArray[bufferIndex++]=view[i]}});return callback(resultArray.buffer)})};exports.encodePayloadAsBlob=function(packets,callback){function encodeOne(packet,doneCallback){exports.encodePacket(packet,true,true,function(encoded){var binaryIdentifier=new Uint8Array(1);binaryIdentifier[0]=1;if(typeof encoded==="string"){var view=new Uint8Array(encoded.length);for(var i=0;i<encoded.length;i++){view[i]=encoded.charCodeAt(i)}encoded=view.buffer;binaryIdentifier[0]=0}var len=encoded instanceof ArrayBuffer?encoded.byteLength:encoded.size;var lenStr=len.toString();var lengthAry=new Uint8Array(lenStr.length+1);for(var i=0;i<lenStr.length;i++){lengthAry[i]=parseInt(lenStr[i])}lengthAry[lenStr.length]=255;if(Blob){var blob=new Blob([binaryIdentifier.buffer,lengthAry.buffer,encoded]);doneCallback(null,blob)}})}map(packets,encodeOne,function(err,results){return callback(new Blob(results))})};exports.decodePayloadAsBinary=function(data,binaryType,callback){if(typeof binaryType==="function"){callback=binaryType;binaryType=null}var bufferTail=data;var buffers=[];var numberTooLong=false;while(bufferTail.byteLength>0){var tailArray=new Uint8Array(bufferTail);var isString=tailArray[0]===0;var msgLength="";for(var i=1;;i++){if(tailArray[i]==255)break;if(msgLength.length>310){numberTooLong=true;break}msgLength+=tailArray[i]}if(numberTooLong)return callback(err,0,1);bufferTail=sliceBuffer(bufferTail,2+msgLength.length);msgLength=parseInt(msgLength);var msg=sliceBuffer(bufferTail,0,msgLength);if(isString){try{msg=String.fromCharCode.apply(null,new Uint8Array(msg))}catch(e){var typed=new Uint8Array(msg);msg="";for(var i=0;i<typed.length;i++){msg+=String.fromCharCode(typed[i])}}}buffers.push(msg);bufferTail=sliceBuffer(bufferTail,msgLength)}var total=buffers.length;buffers.forEach(function(buffer,i){callback(exports.decodePacket(buffer,binaryType,true),i,total)})}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./keys":22,after:23,"arraybuffer.slice":24,"base64-arraybuffer":25,blob:26,utf8:27}],22:[function(_dereq_,module,exports){module.exports=Object.keys||function keys(obj){var arr=[];var has=Object.prototype.hasOwnProperty;for(var i in obj){if(has.call(obj,i)){arr.push(i)}}return arr}},{}],23:[function(_dereq_,module,exports){module.exports=after;function after(count,callback,err_cb){var bail=false;err_cb=err_cb||noop;proxy.count=count;return count===0?callback():proxy;function proxy(err,result){if(proxy.count<=0){throw new Error("after called too many times")}--proxy.count;if(err){bail=true;callback(err);callback=err_cb}else if(proxy.count===0&&!bail){callback(null,result)}}}function noop(){}},{}],24:[function(_dereq_,module,exports){module.exports=function(arraybuffer,start,end){var bytes=arraybuffer.byteLength;start=start||0;end=end||bytes;if(arraybuffer.slice){return arraybuffer.slice(start,end)}if(start<0){start+=bytes}if(end<0){end+=bytes}if(end>bytes){end=bytes}if(start>=bytes||start>=end||bytes===0){return new ArrayBuffer(0)}var abv=new Uint8Array(arraybuffer);var result=new Uint8Array(end-start);for(var i=start,ii=0;i<end;i++,ii++){result[ii]=abv[i]}return result.buffer}},{}],25:[function(_dereq_,module,exports){(function(chars){"use strict";exports.encode=function(arraybuffer){var bytes=new Uint8Array(arraybuffer),i,len=bytes.length,base64="";for(i=0;i<len;i+=3){base64+=chars[bytes[i]>>2];base64+=chars[(bytes[i]&3)<<4|bytes[i+1]>>4];base64+=chars[(bytes[i+1]&15)<<2|bytes[i+2]>>6];base64+=chars[bytes[i+2]&63]}if(len%3===2){base64=base64.substring(0,base64.length-1)+"="}else if(len%3===1){base64=base64.substring(0,base64.length-2)+"=="}return base64};exports.decode=function(base64){var bufferLength=base64.length*.75,len=base64.length,i,p=0,encoded1,encoded2,encoded3,encoded4;if(base64[base64.length-1]==="="){bufferLength--;if(base64[base64.length-2]==="="){bufferLength--}}var arraybuffer=new ArrayBuffer(bufferLength),bytes=new Uint8Array(arraybuffer);for(i=0;i<len;i+=4){encoded1=chars.indexOf(base64[i]);encoded2=chars.indexOf(base64[i+1]);encoded3=chars.indexOf(base64[i+2]);encoded4=chars.indexOf(base64[i+3]);bytes[p++]=encoded1<<2|encoded2>>4;bytes[p++]=(encoded2&15)<<4|encoded3>>2;bytes[p++]=(encoded3&3)<<6|encoded4&63}return arraybuffer}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],26:[function(_dereq_,module,exports){(function(global){var BlobBuilder=global.BlobBuilder||global.WebKitBlobBuilder||global.MSBlobBuilder||global.MozBlobBuilder;var blobSupported=function(){try{var b=new Blob(["hi"]);return b.size==2}catch(e){return false}}();var blobBuilderSupported=BlobBuilder&&BlobBuilder.prototype.append&&BlobBuilder.prototype.getBlob;function BlobBuilderConstructor(ary,options){options=options||{};var bb=new BlobBuilder;for(var i=0;i<ary.length;i++){bb.append(ary[i])}return options.type?bb.getBlob(options.type):bb.getBlob()}module.exports=function(){if(blobSupported){return global.Blob}else if(blobBuilderSupported){return BlobBuilderConstructor}else{return undefined}}()}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],27:[function(_dereq_,module,exports){(function(global){(function(root){var freeExports=typeof exports=="object"&&exports;var freeModule=typeof module=="object"&&module&&module.exports==freeExports&&module;var freeGlobal=typeof global=="object"&&global;if(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal){root=freeGlobal}var stringFromCharCode=String.fromCharCode;function ucs2decode(string){var output=[];var counter=0;var length=string.length;var value;var extra;while(counter<length){value=string.charCodeAt(counter++);if(value>=55296&&value<=56319&&counter<length){extra=string.charCodeAt(counter++);if((extra&64512)==56320){output.push(((value&1023)<<10)+(extra&1023)+65536)}else{output.push(value);counter--}}else{output.push(value)}}return output}function ucs2encode(array){var length=array.length;var index=-1;var value;var output="";while(++index<length){value=array[index];if(value>65535){value-=65536;output+=stringFromCharCode(value>>>10&1023|55296);value=56320|value&1023}output+=stringFromCharCode(value)}return output}function createByte(codePoint,shift){return stringFromCharCode(codePoint>>shift&63|128)}function encodeCodePoint(codePoint){if((codePoint&4294967168)==0){return stringFromCharCode(codePoint)}var symbol="";if((codePoint&4294965248)==0){symbol=stringFromCharCode(codePoint>>6&31|192)}else if((codePoint&4294901760)==0){symbol=stringFromCharCode(codePoint>>12&15|224);symbol+=createByte(codePoint,6)}else if((codePoint&4292870144)==0){symbol=stringFromCharCode(codePoint>>18&7|240);symbol+=createByte(codePoint,12);symbol+=createByte(codePoint,6)}symbol+=stringFromCharCode(codePoint&63|128);return symbol}function utf8encode(string){var codePoints=ucs2decode(string);var length=codePoints.length;var index=-1;var codePoint;var byteString="";while(++index<length){codePoint=codePoints[index];byteString+=encodeCodePoint(codePoint)}return byteString}function readContinuationByte(){if(byteIndex>=byteCount){throw Error("Invalid byte index")}var continuationByte=byteArray[byteIndex]&255;byteIndex++;if((continuationByte&192)==128){return continuationByte&63}throw Error("Invalid continuation byte")}function decodeSymbol(){var byte1;var byte2;var byte3;var byte4;var codePoint;if(byteIndex>byteCount){throw Error("Invalid byte index")}if(byteIndex==byteCount){return false}byte1=byteArray[byteIndex]&255;byteIndex++;if((byte1&128)==0){return byte1}if((byte1&224)==192){var byte2=readContinuationByte();codePoint=(byte1&31)<<6|byte2;if(codePoint>=128){return codePoint}else{throw Error("Invalid continuation byte")}}if((byte1&240)==224){byte2=readContinuationByte();byte3=readContinuationByte();codePoint=(byte1&15)<<12|byte2<<6|byte3;if(codePoint>=2048){return codePoint}else{throw Error("Invalid continuation byte")}}if((byte1&248)==240){byte2=readContinuationByte();byte3=readContinuationByte();byte4=readContinuationByte();codePoint=(byte1&15)<<18|byte2<<12|byte3<<6|byte4;if(codePoint>=65536&&codePoint<=1114111){return codePoint}}throw Error("Invalid UTF-8 detected")}var byteArray;var byteCount;var byteIndex;function utf8decode(byteString){byteArray=ucs2decode(byteString);byteCount=byteArray.length;byteIndex=0;var codePoints=[];var tmp;while((tmp=decodeSymbol())!==false){codePoints.push(tmp)}return ucs2encode(codePoints)}var utf8={version:"2.0.0",encode:utf8encode,decode:utf8decode};if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){define(function(){return utf8})}else if(freeExports&&!freeExports.nodeType){if(freeModule){freeModule.exports=utf8}else{var object={};var hasOwnProperty=object.hasOwnProperty;for(var key in utf8){hasOwnProperty.call(utf8,key)&&(freeExports[key]=utf8[key])}}}else{root.utf8=utf8}})(this)}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],28:[function(_dereq_,module,exports){(function(global){var rvalidchars=/^[\],:{}\s]*$/;var rvalidescape=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g;var rvalidtokens=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g;var rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g;var rtrimLeft=/^\s+/;var rtrimRight=/\s+$/;module.exports=function parsejson(data){if("string"!=typeof data||!data){return null}data=data.replace(rtrimLeft,"").replace(rtrimRight,"");if(global.JSON&&JSON.parse){return JSON.parse(data)}if(rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,""))){return new Function("return "+data)()}}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],29:[function(_dereq_,module,exports){exports.encode=function(obj){var str="";for(var i in obj){if(obj.hasOwnProperty(i)){if(str.length)str+="&";str+=encodeURIComponent(i)+"="+encodeURIComponent(obj[i])}}return str};exports.decode=function(qs){var qry={};var pairs=qs.split("&");for(var i=0,l=pairs.length;i<l;i++){var pair=pairs[i].split("=");qry[decodeURIComponent(pair[0])]=decodeURIComponent(pair[1])}return qry}},{}],30:[function(_dereq_,module,exports){var re=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;var parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];module.exports=function parseuri(str){var src=str,b=str.indexOf("["),e=str.indexOf("]");if(b!=-1&&e!=-1){str=str.substring(0,b)+str.substring(b,e).replace(/:/g,";")+str.substring(e,str.length)}var m=re.exec(str||""),uri={},i=14;while(i--){uri[parts[i]]=m[i]||""}if(b!=-1&&e!=-1){uri.source=src;uri.host=uri.host.substring(1,uri.host.length-1).replace(/;/g,":");uri.authority=uri.authority.replace("[","").replace("]","").replace(/;/g,":");uri.ipv6uri=true}return uri}},{}],31:[function(_dereq_,module,exports){var global=function(){return this}();var WebSocket=global.WebSocket||global.MozWebSocket;module.exports=WebSocket?ws:null;function ws(uri,protocols,opts){var instance;if(protocols){instance=new WebSocket(uri,protocols)}else{instance=new WebSocket(uri)}return instance}if(WebSocket)ws.prototype=WebSocket.prototype},{}],32:[function(_dereq_,module,exports){(function(global){var isArray=_dereq_("isarray");module.exports=hasBinary;function hasBinary(data){function _hasBinary(obj){if(!obj)return false;if(global.Buffer&&global.Buffer.isBuffer(obj)||global.ArrayBuffer&&obj instanceof ArrayBuffer||global.Blob&&obj instanceof Blob||global.File&&obj instanceof File){return true}if(isArray(obj)){for(var i=0;i<obj.length;i++){if(_hasBinary(obj[i])){return true}}}else if(obj&&"object"==typeof obj){if(obj.toJSON){obj=obj.toJSON()}for(var key in obj){if(obj.hasOwnProperty(key)&&_hasBinary(obj[key])){return true}}}return false}return _hasBinary(data)}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{isarray:33}],33:[function(_dereq_,module,exports){module.exports=Array.isArray||function(arr){return Object.prototype.toString.call(arr)=="[object Array]"}},{}],34:[function(_dereq_,module,exports){var global=_dereq_("global");try{module.exports="XMLHttpRequest"in global&&"withCredentials"in new global.XMLHttpRequest}catch(err){module.exports=false}},{global:35}],35:[function(_dereq_,module,exports){module.exports=function(){return this}()},{}],36:[function(_dereq_,module,exports){var indexOf=[].indexOf;module.exports=function(arr,obj){if(indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i){if(arr[i]===obj)return i}return-1}},{}],37:[function(_dereq_,module,exports){var has=Object.prototype.hasOwnProperty;exports.keys=Object.keys||function(obj){var keys=[];for(var key in obj){if(has.call(obj,key)){keys.push(key)}}return keys};exports.values=function(obj){var vals=[];for(var key in obj){if(has.call(obj,key)){vals.push(obj[key])}}return vals};exports.merge=function(a,b){for(var key in b){if(has.call(b,key)){a[key]=b[key]}}return a};exports.length=function(obj){return exports.keys(obj).length};exports.isEmpty=function(obj){return 0==exports.length(obj)}},{}],38:[function(_dereq_,module,exports){var re=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;var parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];module.exports=function parseuri(str){var m=re.exec(str||""),uri={},i=14;while(i--){uri[parts[i]]=m[i]||""}return uri}},{}],39:[function(_dereq_,module,exports){(function(global){var isArray=_dereq_("isarray");var isBuf=_dereq_("./is-buffer");exports.deconstructPacket=function(packet){var buffers=[];var packetData=packet.data;function _deconstructPacket(data){if(!data)return data;if(isBuf(data)){var placeholder={_placeholder:true,num:buffers.length};buffers.push(data);return placeholder}else if(isArray(data)){var newData=new Array(data.length);for(var i=0;i<data.length;i++){newData[i]=_deconstructPacket(data[i])}return newData}else if("object"==typeof data&&!(data instanceof Date)){var newData={};for(var key in data){newData[key]=_deconstructPacket(data[key])}return newData}return data}var pack=packet;pack.data=_deconstructPacket(packetData);pack.attachments=buffers.length;return{packet:pack,buffers:buffers}};exports.reconstructPacket=function(packet,buffers){var curPlaceHolder=0;function _reconstructPacket(data){if(data&&data._placeholder){var buf=buffers[data.num];return buf}else if(isArray(data)){for(var i=0;i<data.length;i++){data[i]=_reconstructPacket(data[i])}return data}else if(data&&"object"==typeof data){for(var key in data){data[key]=_reconstructPacket(data[key])}return data}return data}packet.data=_reconstructPacket(packet.data);packet.attachments=undefined;return packet};exports.removeBlobs=function(data,callback){function _removeBlobs(obj,curKey,containingObject){if(!obj)return obj;if(global.Blob&&obj instanceof Blob||global.File&&obj instanceof File){pendingBlobs++;var fileReader=new FileReader;fileReader.onload=function(){if(containingObject){containingObject[curKey]=this.result}else{bloblessData=this.result}if(!--pendingBlobs){callback(bloblessData)}};fileReader.readAsArrayBuffer(obj)}else if(isArray(obj)){for(var i=0;i<obj.length;i++){_removeBlobs(obj[i],i,obj)}}else if(obj&&"object"==typeof obj&&!isBuf(obj)){for(var key in obj){_removeBlobs(obj[key],key,obj)
}}}var pendingBlobs=0;var bloblessData=data;_removeBlobs(bloblessData);if(!pendingBlobs){callback(bloblessData)}}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./is-buffer":41,isarray:42}],40:[function(_dereq_,module,exports){var debug=_dereq_("debug")("socket.io-parser");var json=_dereq_("json3");var isArray=_dereq_("isarray");var Emitter=_dereq_("component-emitter");var binary=_dereq_("./binary");var isBuf=_dereq_("./is-buffer");exports.protocol=4;exports.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"];exports.CONNECT=0;exports.DISCONNECT=1;exports.EVENT=2;exports.ACK=3;exports.ERROR=4;exports.BINARY_EVENT=5;exports.BINARY_ACK=6;exports.Encoder=Encoder;exports.Decoder=Decoder;function Encoder(){}Encoder.prototype.encode=function(obj,callback){debug("encoding packet %j",obj);if(exports.BINARY_EVENT==obj.type||exports.BINARY_ACK==obj.type){encodeAsBinary(obj,callback)}else{var encoding=encodeAsString(obj);callback([encoding])}};function encodeAsString(obj){var str="";var nsp=false;str+=obj.type;if(exports.BINARY_EVENT==obj.type||exports.BINARY_ACK==obj.type){str+=obj.attachments;str+="-"}if(obj.nsp&&"/"!=obj.nsp){nsp=true;str+=obj.nsp}if(null!=obj.id){if(nsp){str+=",";nsp=false}str+=obj.id}if(null!=obj.data){if(nsp)str+=",";str+=json.stringify(obj.data)}debug("encoded %j as %s",obj,str);return str}function encodeAsBinary(obj,callback){function writeEncoding(bloblessData){var deconstruction=binary.deconstructPacket(bloblessData);var pack=encodeAsString(deconstruction.packet);var buffers=deconstruction.buffers;buffers.unshift(pack);callback(buffers)}binary.removeBlobs(obj,writeEncoding)}function Decoder(){this.reconstructor=null}Emitter(Decoder.prototype);Decoder.prototype.add=function(obj){var packet;if("string"==typeof obj){packet=decodeString(obj);if(exports.BINARY_EVENT==packet.type||exports.BINARY_ACK==packet.type){this.reconstructor=new BinaryReconstructor(packet);if(this.reconstructor.reconPack.attachments==0){this.emit("decoded",packet)}}else{this.emit("decoded",packet)}}else if(isBuf(obj)||obj.base64){if(!this.reconstructor){throw new Error("got binary data when not reconstructing a packet")}else{packet=this.reconstructor.takeBinaryData(obj);if(packet){this.reconstructor=null;this.emit("decoded",packet)}}}else{throw new Error("Unknown type: "+obj)}};function decodeString(str){var p={};var i=0;p.type=Number(str.charAt(0));if(null==exports.types[p.type])return error();if(exports.BINARY_EVENT==p.type||exports.BINARY_ACK==p.type){p.attachments="";while(str.charAt(++i)!="-"){p.attachments+=str.charAt(i)}p.attachments=Number(p.attachments)}if("/"==str.charAt(i+1)){p.nsp="";while(++i){var c=str.charAt(i);if(","==c)break;p.nsp+=c;if(i+1==str.length)break}}else{p.nsp="/"}var next=str.charAt(i+1);if(""!=next&&Number(next)==next){p.id="";while(++i){var c=str.charAt(i);if(null==c||Number(c)!=c){--i;break}p.id+=str.charAt(i);if(i+1==str.length)break}p.id=Number(p.id)}if(str.charAt(++i)){try{p.data=json.parse(str.substr(i))}catch(e){return error()}}debug("decoded %s as %j",str,p);return p}Decoder.prototype.destroy=function(){if(this.reconstructor){this.reconstructor.finishedReconstruction()}};function BinaryReconstructor(packet){this.reconPack=packet;this.buffers=[]}BinaryReconstructor.prototype.takeBinaryData=function(binData){this.buffers.push(binData);if(this.buffers.length==this.reconPack.attachments){var packet=binary.reconstructPacket(this.reconPack,this.buffers);this.finishedReconstruction();return packet}return null};BinaryReconstructor.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]};function error(data){return{type:exports.ERROR,data:"parser error"}}},{"./binary":39,"./is-buffer":41,"component-emitter":8,debug:9,isarray:42,json3:43}],41:[function(_dereq_,module,exports){(function(global){module.exports=isBuf;function isBuf(obj){return global.Buffer&&global.Buffer.isBuffer(obj)||global.ArrayBuffer&&obj instanceof ArrayBuffer}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],42:[function(_dereq_,module,exports){module.exports=_dereq_(33)},{}],43:[function(_dereq_,module,exports){(function(window){var getClass={}.toString,isProperty,forEach,undef;var isLoader=typeof define==="function"&&define.amd;var nativeJSON=typeof JSON=="object"&&JSON;var JSON3=typeof exports=="object"&&exports&&!exports.nodeType&&exports;if(JSON3&&nativeJSON){JSON3.stringify=nativeJSON.stringify;JSON3.parse=nativeJSON.parse}else{JSON3=window.JSON=nativeJSON||{}}var isExtended=new Date(-0xc782b5b800cec);try{isExtended=isExtended.getUTCFullYear()==-109252&&isExtended.getUTCMonth()===0&&isExtended.getUTCDate()===1&&isExtended.getUTCHours()==10&&isExtended.getUTCMinutes()==37&&isExtended.getUTCSeconds()==6&&isExtended.getUTCMilliseconds()==708}catch(exception){}function has(name){if(has[name]!==undef){return has[name]}var isSupported;if(name=="bug-string-char-index"){isSupported="a"[0]!="a"}else if(name=="json"){isSupported=has("json-stringify")&&has("json-parse")}else{var value,serialized='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if(name=="json-stringify"){var stringify=JSON3.stringify,stringifySupported=typeof stringify=="function"&&isExtended;if(stringifySupported){(value=function(){return 1}).toJSON=value;try{stringifySupported=stringify(0)==="0"&&stringify(new Number)==="0"&&stringify(new String)=='""'&&stringify(getClass)===undef&&stringify(undef)===undef&&stringify()===undef&&stringify(value)==="1"&&stringify([value])=="[1]"&&stringify([undef])=="[null]"&&stringify(null)=="null"&&stringify([undef,getClass,null])=="[null,null,null]"&&stringify({a:[value,true,false,null,"\x00\b\n\f\r	"]})==serialized&&stringify(null,value)==="1"&&stringify([1,2],null,1)=="[\n 1,\n 2\n]"&&stringify(new Date(-864e13))=='"-271821-04-20T00:00:00.000Z"'&&stringify(new Date(864e13))=='"+275760-09-13T00:00:00.000Z"'&&stringify(new Date(-621987552e5))=='"-000001-01-01T00:00:00.000Z"'&&stringify(new Date(-1))=='"1969-12-31T23:59:59.999Z"'}catch(exception){stringifySupported=false}}isSupported=stringifySupported}if(name=="json-parse"){var parse=JSON3.parse;if(typeof parse=="function"){try{if(parse("0")===0&&!parse(false)){value=parse(serialized);var parseSupported=value["a"].length==5&&value["a"][0]===1;if(parseSupported){try{parseSupported=!parse('"	"')}catch(exception){}if(parseSupported){try{parseSupported=parse("01")!==1}catch(exception){}}if(parseSupported){try{parseSupported=parse("1.")!==1}catch(exception){}}}}}catch(exception){parseSupported=false}}isSupported=parseSupported}}return has[name]=!!isSupported}if(!has("json")){var functionClass="[object Function]";var dateClass="[object Date]";var numberClass="[object Number]";var stringClass="[object String]";var arrayClass="[object Array]";var booleanClass="[object Boolean]";var charIndexBuggy=has("bug-string-char-index");if(!isExtended){var floor=Math.floor;var Months=[0,31,59,90,120,151,181,212,243,273,304,334];var getDay=function(year,month){return Months[month]+365*(year-1970)+floor((year-1969+(month=+(month>1)))/4)-floor((year-1901+month)/100)+floor((year-1601+month)/400)}}if(!(isProperty={}.hasOwnProperty)){isProperty=function(property){var members={},constructor;if((members.__proto__=null,members.__proto__={toString:1},members).toString!=getClass){isProperty=function(property){var original=this.__proto__,result=property in(this.__proto__=null,this);this.__proto__=original;return result}}else{constructor=members.constructor;isProperty=function(property){var parent=(this.constructor||constructor).prototype;return property in this&&!(property in parent&&this[property]===parent[property])}}members=null;return isProperty.call(this,property)}}var PrimitiveTypes={"boolean":1,number:1,string:1,undefined:1};var isHostType=function(object,property){var type=typeof object[property];return type=="object"?!!object[property]:!PrimitiveTypes[type]};forEach=function(object,callback){var size=0,Properties,members,property;(Properties=function(){this.valueOf=0}).prototype.valueOf=0;members=new Properties;for(property in members){if(isProperty.call(members,property)){size++}}Properties=members=null;if(!size){members=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"];forEach=function(object,callback){var isFunction=getClass.call(object)==functionClass,property,length;var hasProperty=!isFunction&&typeof object.constructor!="function"&&isHostType(object,"hasOwnProperty")?object.hasOwnProperty:isProperty;for(property in object){if(!(isFunction&&property=="prototype")&&hasProperty.call(object,property)){callback(property)}}for(length=members.length;property=members[--length];hasProperty.call(object,property)&&callback(property));}}else if(size==2){forEach=function(object,callback){var members={},isFunction=getClass.call(object)==functionClass,property;for(property in object){if(!(isFunction&&property=="prototype")&&!isProperty.call(members,property)&&(members[property]=1)&&isProperty.call(object,property)){callback(property)}}}}else{forEach=function(object,callback){var isFunction=getClass.call(object)==functionClass,property,isConstructor;for(property in object){if(!(isFunction&&property=="prototype")&&isProperty.call(object,property)&&!(isConstructor=property==="constructor")){callback(property)}}if(isConstructor||isProperty.call(object,property="constructor")){callback(property)}}}return forEach(object,callback)};if(!has("json-stringify")){var Escapes={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"};var leadingZeroes="000000";var toPaddedString=function(width,value){return(leadingZeroes+(value||0)).slice(-width)};var unicodePrefix="\\u00";var quote=function(value){var result='"',index=0,length=value.length,isLarge=length>10&&charIndexBuggy,symbols;if(isLarge){symbols=value.split("")}for(;index<length;index++){var charCode=value.charCodeAt(index);switch(charCode){case 8:case 9:case 10:case 12:case 13:case 34:case 92:result+=Escapes[charCode];break;default:if(charCode<32){result+=unicodePrefix+toPaddedString(2,charCode.toString(16));break}result+=isLarge?symbols[index]:charIndexBuggy?value.charAt(index):value[index]}}return result+'"'};var serialize=function(property,object,callback,properties,whitespace,indentation,stack){var value,className,year,month,date,time,hours,minutes,seconds,milliseconds,results,element,index,length,prefix,result;try{value=object[property]}catch(exception){}if(typeof value=="object"&&value){className=getClass.call(value);if(className==dateClass&&!isProperty.call(value,"toJSON")){if(value>-1/0&&value<1/0){if(getDay){date=floor(value/864e5);for(year=floor(date/365.2425)+1970-1;getDay(year+1,0)<=date;year++);for(month=floor((date-getDay(year,0))/30.42);getDay(year,month+1)<=date;month++);date=1+date-getDay(year,month);time=(value%864e5+864e5)%864e5;hours=floor(time/36e5)%24;minutes=floor(time/6e4)%60;seconds=floor(time/1e3)%60;milliseconds=time%1e3}else{year=value.getUTCFullYear();month=value.getUTCMonth();date=value.getUTCDate();hours=value.getUTCHours();minutes=value.getUTCMinutes();seconds=value.getUTCSeconds();milliseconds=value.getUTCMilliseconds()}value=(year<=0||year>=1e4?(year<0?"-":"+")+toPaddedString(6,year<0?-year:year):toPaddedString(4,year))+"-"+toPaddedString(2,month+1)+"-"+toPaddedString(2,date)+"T"+toPaddedString(2,hours)+":"+toPaddedString(2,minutes)+":"+toPaddedString(2,seconds)+"."+toPaddedString(3,milliseconds)+"Z"}else{value=null}}else if(typeof value.toJSON=="function"&&(className!=numberClass&&className!=stringClass&&className!=arrayClass||isProperty.call(value,"toJSON"))){value=value.toJSON(property)}}if(callback){value=callback.call(object,property,value)}if(value===null){return"null"}className=getClass.call(value);if(className==booleanClass){return""+value}else if(className==numberClass){return value>-1/0&&value<1/0?""+value:"null"}else if(className==stringClass){return quote(""+value)}if(typeof value=="object"){for(length=stack.length;length--;){if(stack[length]===value){throw TypeError()}}stack.push(value);results=[];prefix=indentation;indentation+=whitespace;if(className==arrayClass){for(index=0,length=value.length;index<length;index++){element=serialize(index,value,callback,properties,whitespace,indentation,stack);results.push(element===undef?"null":element)}result=results.length?whitespace?"[\n"+indentation+results.join(",\n"+indentation)+"\n"+prefix+"]":"["+results.join(",")+"]":"[]"}else{forEach(properties||value,function(property){var element=serialize(property,value,callback,properties,whitespace,indentation,stack);if(element!==undef){results.push(quote(property)+":"+(whitespace?" ":"")+element)}});result=results.length?whitespace?"{\n"+indentation+results.join(",\n"+indentation)+"\n"+prefix+"}":"{"+results.join(",")+"}":"{}"}stack.pop();return result}};JSON3.stringify=function(source,filter,width){var whitespace,callback,properties,className;if(typeof filter=="function"||typeof filter=="object"&&filter){if((className=getClass.call(filter))==functionClass){callback=filter}else if(className==arrayClass){properties={};for(var index=0,length=filter.length,value;index<length;value=filter[index++],(className=getClass.call(value),className==stringClass||className==numberClass)&&(properties[value]=1));}}if(width){if((className=getClass.call(width))==numberClass){if((width-=width%1)>0){for(whitespace="",width>10&&(width=10);whitespace.length<width;whitespace+=" ");}}else if(className==stringClass){whitespace=width.length<=10?width:width.slice(0,10)}}return serialize("",(value={},value[""]=source,value),callback,properties,whitespace,"",[])}}if(!has("json-parse")){var fromCharCode=String.fromCharCode;var Unescapes={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"};var Index,Source;var abort=function(){Index=Source=null;throw SyntaxError()};var lex=function(){var source=Source,length=source.length,value,begin,position,isSigned,charCode;while(Index<length){charCode=source.charCodeAt(Index);switch(charCode){case 9:case 10:case 13:case 32:Index++;break;case 123:case 125:case 91:case 93:case 58:case 44:value=charIndexBuggy?source.charAt(Index):source[Index];Index++;return value;case 34:for(value="@",Index++;Index<length;){charCode=source.charCodeAt(Index);if(charCode<32){abort()}else if(charCode==92){charCode=source.charCodeAt(++Index);switch(charCode){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:value+=Unescapes[charCode];Index++;break;case 117:begin=++Index;for(position=Index+4;Index<position;Index++){charCode=source.charCodeAt(Index);if(!(charCode>=48&&charCode<=57||charCode>=97&&charCode<=102||charCode>=65&&charCode<=70)){abort()}}value+=fromCharCode("0x"+source.slice(begin,Index));break;default:abort()}}else{if(charCode==34){break}charCode=source.charCodeAt(Index);begin=Index;while(charCode>=32&&charCode!=92&&charCode!=34){charCode=source.charCodeAt(++Index)}value+=source.slice(begin,Index)}}if(source.charCodeAt(Index)==34){Index++;return value}abort();default:begin=Index;if(charCode==45){isSigned=true;charCode=source.charCodeAt(++Index)}if(charCode>=48&&charCode<=57){if(charCode==48&&(charCode=source.charCodeAt(Index+1),charCode>=48&&charCode<=57)){abort()}isSigned=false;for(;Index<length&&(charCode=source.charCodeAt(Index),charCode>=48&&charCode<=57);Index++);if(source.charCodeAt(Index)==46){position=++Index;for(;position<length&&(charCode=source.charCodeAt(position),charCode>=48&&charCode<=57);position++);if(position==Index){abort()}Index=position}charCode=source.charCodeAt(Index);if(charCode==101||charCode==69){charCode=source.charCodeAt(++Index);if(charCode==43||charCode==45){Index++}for(position=Index;position<length&&(charCode=source.charCodeAt(position),charCode>=48&&charCode<=57);position++);if(position==Index){abort()}Index=position}return+source.slice(begin,Index)}if(isSigned){abort()}if(source.slice(Index,Index+4)=="true"){Index+=4;return true}else if(source.slice(Index,Index+5)=="false"){Index+=5;return false}else if(source.slice(Index,Index+4)=="null"){Index+=4;return null}abort()}}return"$"};var get=function(value){var results,hasMembers;if(value=="$"){abort()}if(typeof value=="string"){if((charIndexBuggy?value.charAt(0):value[0])=="@"){return value.slice(1)}if(value=="["){results=[];for(;;hasMembers||(hasMembers=true)){value=lex();if(value=="]"){break}if(hasMembers){if(value==","){value=lex();if(value=="]"){abort()}}else{abort()}}if(value==","){abort()}results.push(get(value))}return results}else if(value=="{"){results={};for(;;hasMembers||(hasMembers=true)){value=lex();if(value=="}"){break}if(hasMembers){if(value==","){value=lex();if(value=="}"){abort()}}else{abort()}}if(value==","||typeof value!="string"||(charIndexBuggy?value.charAt(0):value[0])!="@"||lex()!=":"){abort()}results[value.slice(1)]=get(lex())}return results}abort()}return value};var update=function(source,property,callback){var element=walk(source,property,callback);if(element===undef){delete source[property]}else{source[property]=element}};var walk=function(source,property,callback){var value=source[property],length;if(typeof value=="object"&&value){if(getClass.call(value)==arrayClass){for(length=value.length;length--;){update(value,length,callback)}}else{forEach(value,function(property){update(value,property,callback)})}}return callback.call(source,property,value)};JSON3.parse=function(source,callback){var result,value;Index=0;Source=""+source;result=get(lex());if(lex()!="$"){abort()}Index=Source=null;return callback&&getClass.call(callback)==functionClass?walk((value={},value[""]=result,value),"",callback):result}}}if(isLoader){define(function(){return JSON3})}})(this)},{}],44:[function(_dereq_,module,exports){module.exports=toArray;function toArray(list,index){var array=[];index=index||0;for(var i=index||0;i<list.length;i++){array[i-index]=list[i]}return array}},{}]},{},[1])(1)});
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],7:[function(require,module,exports){
/*
	sockets.js
*/

// dependencies for this module go here
var UI = require('./ui');

var Sockets = {
	socket : null,

	init : function () {
		this.makeSocketConnection();

		this.Listeners.setup();
	},

	makeSocketConnection : function () {

		var connectionURL = window.location.hostname;

		this.socket = io.connect(connectionURL, {transports: ['websocket']});

	},

	Listeners : {

		setup : function () {

			Sockets.socket.on('tweet', this.onTweetReceived);
			Sockets.socket.on('state', this.onStateReceived);

		},

		onTweetReceived : function (symbolObj) {

			// log('on tweet received');
			UI.updateSymbol(symbolObj.key, symbolObj.symbol);

		},

		onStateReceived : function (stateObj) {

			for (var key in stateObj) {
				UI.updateSymbol(key, stateObj[key]);
			}

			UI.updateRankings(stateObj);

		}

	}


};

module.exports = Sockets;
},{"./ui":8}],8:[function(require,module,exports){
/*
	UI.js
	Example module to show how to include other JS files into you browserify build
*/

// dependencies for this module go here
var $ = require('traversty'),
	qwery = require('qwery');

	trak = require('trak.js');

	// d3 = require('d3');


//give us old IE selector support (<8)
$.setSelectorEngine(qwery);

var UI = {
	html: $('html')[0],
	body: $('body')[0],

	overlay: $('.overlay'),
	overlayBtn: $('.overlay .btn'),

	symbolList: $('.symbol-list-wrapper')[0],
	symbolListBtn: $('.btn-list')[0],

	scrollActive: false,

	supports : {
		transform3d: false
	},

	scrollFired : false,

	init : function () {
		// d3.selectAll(".symbol").style("color", function() {
  // 			return "hsl(" + Math.random() * 360 + ",100%,50%)";
		// });
		//

		this.browserSupportChecks();

		this.handleZooming();

		this.initOverlays();
		this.initInfoOverlay();
		this.symbolOverlay();

	},

	browserSupportChecks : function  () {

		if (this.html.classList.contains('csstransforms3d')) {
			this.supports.transform3d = true;
		}

		window.onload = function () {
			UI.body.classList.remove('preload');

		};

		document.addEventListener('DOMContentLoaded', function(e) {
			trak.start();
		});


	},

	initOverlays : function () {

		var index = 0,
			overlayNum = this.overlay.length;

		//loop through each overlay and attach listeners
		for (index; index < overlayNum; index++) {
			this.overlayBtn[index].addEventListener('click', function (e) {
				e.preventDefault();

				var context = this.getAttribute('data-close');
				$('.' + context)[0].classList.add('inactive');
				UI.scrollActive = true;

				//if the intro modal is closed, scroll to the top of the window
				if (context === 'overlay--intro') {
					window.scrollTo(0, 0);
				}

				trak.event({category: 'engagement', action: 'overlay', label: 'closed ' + context});
			});
		}

	},

	initInfoOverlay : function () {

		var footerLink = $('.page-footer-info')[0];

		footerLink.addEventListener('click', function (e) {
			e.preventDefault();

			UI.hideAllOverlays();
			$('.overlay--info')[0].classList.remove('inactive');

			trak.event({category: 'engagement', action: 'overlay', label: 'info'});

		});

	},

	hideAllOverlays : function () {

		var index = 0,
			overlayNum = this.overlay.length;

		//loop through each overlay and attach listeners
		for (index; index < overlayNum; index++) {
			this.overlay[index].classList.add('inactive');
		}

	},

	symbolOverlay : function () {

		this.symbolListBtn.addEventListener('click', function (e) {
			e.preventDefault();

			//only open if we are in 'open scrolling mode'
			UI.hideAllOverlays();
			UI.symbolList.classList.remove('inactive', 'hide');
			$('#scroll-proxy')[0].classList.add('inactive');
			window.scrollTo(0, 0);
			UI.scrollActive = false;

			trak.event({category: 'engagement', action: 'overlay', label: 'symbol list'});
		});

		//close button for the symbol overlay
		$('.btn--close')[0].addEventListener('click', function (e) {
			e.preventDefault();

			UI.symbolList.classList.add('inactive');
			$('#scroll-proxy')[0].classList.remove('inactive');
			UI.scrollActive = true;
		});

	},


	updateSymbol : function (name, data) {

		// log(name, data);
		var symbolTotal = $('.symbol--' + name + ' .symbol-total');

		if (symbolTotal.length > 0) {
			var index = 0,
				symLength = symbolTotal.length;

			for (index; index < symLength; index++) {
				symbolTotal[index].innerHTML = this.numberWithCommas(data.total);
			}
		}

	},

	updateRankings : function (state) {

		//build a dom object of ordered list elements
		var rankingArray = [];

		for (var symbol in state) {
			var tagString;
			for (var tag in state[symbol].tags) {
				tagString = tag;
				break;
			}
			rankingArray.push([symbol, tagString, state[symbol].total]);
		}

		rankingArray.sort(function(a, b) {return  b[2] - a[2] });

		//loop through array and make a list
		var symbolLength = rankingArray.length,
			i = 0,
			listEl = document.createElement('ul');

		listEl.className = 'symbol-list unstyled';

		for (i; i < symbolLength; i++) {

			var listItemEl = document.createElement('li'),
				textEl = document.createElement('p'),
				totalEl = document.createElement('span');

			listItemEl.className = 'symbol symbol--' + rankingArray[i][0];
			textEl.className = 'symbol-label';
			totalEl.className = 'symbol-total';

			textEl.innerHTML = rankingArray[i][1] + ': ';
			totalEl.innerHTML = UI.numberWithCommas(rankingArray[i][2]);

			textEl.appendChild(totalEl);
			listItemEl.appendChild(textEl);
			listEl.appendChild(listItemEl);
		}

		$('.symbol-list')[0].innerHTML = listEl.innerHTML;


	},

	numberWithCommas : function(x) {
		return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
	},


	handleZooming : function () {

		// only proceed if CSS transforms are supported
	// NEED TO FIX
		//if ( !Modernizr.csstransforms ) { return; }

		var zoomContent = $('.illust-container')[0];

		ZUI = new Zoomer(zoomContent);

		//make sure page is at the top when reloaded
		window.scrollTo(0, 0);

	//on page load calculate current position and scale to it
		// ZUI.recalculatePositions();

	}
};

// the constructor that will do all the work
function Zoomer( content ) {

	this.setLevels = function() {

		if (this.docWidth > 1500) {
			this.levels = 6.2;
			this.verticalTranslate = 3000;
		} else if (this.docWidth > 1350) {
			this.levels = 6;
			this.verticalTranslate = 2750;
		} else if (this.docWidth > 1250) {
			this.levels = 5.8;
			this.verticalTranslate = 2450;
		} else if (this.docWidth > 1150) {
			this.levels = 5.7;
			this.verticalTranslate = 2350;
		} else if (this.docWidth > 1050) {
			this.levels = 5.5;
			this.verticalTranslate = 2100;
		} else if (this.docWidth > 950) {
			this.levels = 5.35;
			this.verticalTranslate = 1900;
		} else if (this.docWidth > 850) {
			this.levels = 5.15;
			this.verticalTranslate = 1700;
		} else {
			this.levels = 4.9;
			this.verticalTranslate = 1520;
		}

	};

	// keep track of DOM
	this.content = content;

	this.header = $('.page-header')[0];
	this.body = $('body')[0];
	this.town = $('.illust-level--town')[0];
	this.townSymbols = $('.illust-level--symbolsTown')[0];
	this.house = $('.svg-house')[0];
	this.carollers = $('.svg-carollers')[0];
	this.star = $('.svg-star')[0];

	// position of vertical scroll
	this.scrolled = 0;

	var body = document.body,
		html = document.documentElement;

	// height of document
	this.docHeight = Math.max( body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight );
	this.docWidth = html.clientWidth;

	// zero-based number of sections
	this.setLevels();


	// bind Zoomer to scroll event
	window.addEventListener( 'scroll', this, false);
}

// enables constructor to be used within event listener
// like obj.addEventListener( eventName, this, false )
Zoomer.prototype.handleEvent = function( event ) {
	if ( this[event.type] ) {
		this[event.type](event);
	}
};

// triggered every time window scrolls
Zoomer.prototype.scroll = function( event ) {

	if (UI.scrollActive) {
		this.recalculatePositions();
	}

};

Zoomer.prototype.recalculatePositions = function () {

	//LETS HAVE SOME DEFAULTS HERE
	var INITIAL_TOWN_WIDTH = 350,
		INITIAL_TOWN_HEIGHT = 320,
		TARGET_TOWN_WIDTH = 2800,
		TARGET_TOWN_HEIGHT = 2560,

		TARGET_BG_ZSCALE = 200,

		OFFSET_MARGIN = 80,

		TARGET_VERTICAL_TRANSLATE = 2600;


	var supportPageOffset = window.pageXOffset !== undefined;
	var isCSS1Compat = ((document.compatMode || "") === "CSS1Compat");

	var yOffset = supportPageOffset ? window.pageYOffset : isCSS1Compat ? document.documentElement.scrollTop : document.body.scrollTop;

	// normalize scroll value from 0 to 1
	this.scrolled = yOffset / ( this.docHeight - window.innerHeight );

	var transformValue,
		width,
		transformPrefix,
		townTransform,
		symboltransformValue;

	this.checkStates();

	var scrollFactor = (this.scrolled < 0.5 ? this.scrolled : 0.5);
	var scale = Math.pow( 3, scrollFactor * this.levels );
	var townHeight = Math.round(scale * INITIAL_TOWN_HEIGHT);
	var townWidth = Math.round(scale * INITIAL_TOWN_WIDTH);
	var townOffset = Math.round(scale * OFFSET_MARGIN) - OFFSET_MARGIN;

	//first half of app is the scale – this zooms into the house
	if (scrollFactor < 0.5) {

		var zScale = Math.round((scale * TARGET_BG_ZSCALE) - TARGET_BG_ZSCALE);

		var townYPos = Math.round(((townHeight / 2) + townOffset));

		//if we support translate3d
		if (UI.supports.transform3d) {
			transformValue = 'translate3d(0, 0, 0) scale(' + scale + ')';

			townTransform = 'translate3d(-50%, -' + townYPos + 'px, 0)';
			symboltransformValue = 'translate3d(-' + (townWidth / 2) + 'px, -' + townYPos + 'px, 0)' + ' scale(' + scale + ')';
		} else {
			transformValue = 'translate(0, 0) scale(' + scale + ')';

			townTransform = 'translate(-50%, -' + townYPos + 'px)';
			symboltransformValue = 'translate(-' + (townWidth / 2) + 'px, -' + townYPos + 'px)' + ' scale(' + scale + ')';
		}

	//the second half is the translate vertically
	} else {

		var percentageThroughSection = ((this.scrolled - 0.5) / 0.5); //get the percentage of the amount through the section (on a scale 0-1)
		var verticalTranslate = percentageThroughSection * this.verticalTranslate; //gets a scaled amount dependent on the percentage of the section scrolled through

		var townYPos = Math.round((townHeight / 2) + townOffset - verticalTranslate);

		//if we support translate3d
		if (UI.supports.transform3d) {
			transformValue = 'translate3d(0, 0, 0) scale(' + scale + ')';
			townTransform = 'translate3d(-50%, -' + townYPos + 'px, 0)';
		} else {
			transformValue = 'translate(0, 0) scale(' + scale + ')';
			townTransform = 'translate(-50%, -' + townYPos + 'px)';
		}

	}

	// SETTING OF OUR NEW VALUES

	//update width and height of town
	this.town.style.width = townWidth + 'px';
	this.town.style.height = townHeight + 'px';

	// //update the transformed value for the town
	this.town.style.WebkitTransform = townTransform;
	this.town.style.MozTransform = townTransform;
	this.town.style.msTransform = townTransform;
	this.town.style.transform = townTransform;

	// //update scale factor of the outside illustrations and text
	// if(navigator.userAgent.toLowerCase().indexOf('firefox') === -1) {
		this.content.style.WebkitTransform = transformValue;
		this.content.style.MozTransform = transformValue;
		this.content.style.msTransform = transformValue;
		this.content.style.transform = transformValue;
	// }

	// //town symbols scaling
	this.townSymbols.style.WebkitTransform = 'scale(' + scale + ')';
	this.townSymbols.style.MozTransform = 'scale(' + scale + ')';
	this.townSymbols.style.msTransform = 'scale(' + scale + ')';
	this.townSymbols.style.transform = 'scale(' + scale + ')';

};


Zoomer.prototype.checkStates = function () {

	if (this.scrolled > 0) {
		this.header.classList.add('scaled');
	} else {
		this.header.classList.remove('scaled');
	}

	//do a test whether to switch to night or not (after 0.25 scrolled)
	if (this.scrolled > 0.15) {
		this.body.classList.add('night');
	} else {
		this.body.classList.remove('night');
	}

	//test between state of movement
	if (this.scrolled < 0.5) {

		this.house.classList.remove('inactive'); //make house visible
		this.carollers.classList.remove('inactive'); //make carollers invisible
		this.star.classList.add('inactive'); //make carollers invisible
		this.townSymbols.querySelector('.symbols--inside').classList.add('inactive'); //make nativity symbols not visible
		this.townSymbols.querySelector('.symbols--outside').classList.remove('inactive'); //make nativity symbols not visible

	} else {

		this.house.classList.add('inactive'); //make house not visible
		this.carollers.classList.add('inactive'); //make carollers invisible
		this.star.classList.remove('inactive'); //make carollers invisible
		this.townSymbols.querySelector('.symbols--inside').classList.remove('inactive'); //make nativity symbols visible
		this.townSymbols.querySelector('.symbols--outside').classList.add('inactive'); //make nativity symbols not visible

		if (UI.scrollFired === false) {
			UI.scrollFired = true;
			trak.event({category: 'engagement', action: 'scroll', label: 'halfway'});
		}

	}

};




module.exports = UI;
},{"qwery":1,"trak.js":2,"traversty":3}],9:[function(require,module,exports){
/*	Author:
		TMW - (Author Name Here)
*/

// --------------------------------------------- //
// DEFINE GLOBAL LIBS                            //
// --------------------------------------------- //
// Uncomment the line below to expose jQuery as a global object to the usual places
// window.jQuery = window.$ = require('./libs/jquery/jquery-1.10.2.js');

// force compilation of global libs that don't return a value.
require("./helpers/log");
require("./helpers/shims");
window.io = require('./libs/socket.io-1.1.0');


//initialise KO object
var KO = window.KO = {};

KO.Sockets = require('./modules/sockets');
KO.UI = require('./modules/ui');

KO.Config = {

	init : function () {
		KO.UI.init();
		KO.Sockets.init();
	}
};


KO.Config.init();
},{"./helpers/log":4,"./helpers/shims":5,"./libs/socket.io-1.1.0":6,"./modules/sockets":7,"./modules/ui":8}]},{},[9])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9ncnVudC1icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvVXNlcnMvYW5vbGFuMS9fcHJvamVjdHMvX2xhYnMvY2hyaXN0bWFzLXRyYWNrZXIvbm9kZV9tb2R1bGVzL3F3ZXJ5L3F3ZXJ5LmpzIiwiL1VzZXJzL2Fub2xhbjEvX3Byb2plY3RzL19sYWJzL2NocmlzdG1hcy10cmFja2VyL25vZGVfbW9kdWxlcy90cmFrLmpzL2Rpc3QvdHJhay5qcyIsIi9Vc2Vycy9hbm9sYW4xL19wcm9qZWN0cy9fbGFicy9jaHJpc3RtYXMtdHJhY2tlci9ub2RlX21vZHVsZXMvdHJhdmVyc3R5L3RyYXZlcnN0eS5qcyIsIi9Vc2Vycy9hbm9sYW4xL19wcm9qZWN0cy9fbGFicy9jaHJpc3RtYXMtdHJhY2tlci9wdWJsaWMvanMvaGVscGVycy9sb2cuanMiLCIvVXNlcnMvYW5vbGFuMS9fcHJvamVjdHMvX2xhYnMvY2hyaXN0bWFzLXRyYWNrZXIvcHVibGljL2pzL2hlbHBlcnMvc2hpbXMuanMiLCIvVXNlcnMvYW5vbGFuMS9fcHJvamVjdHMvX2xhYnMvY2hyaXN0bWFzLXRyYWNrZXIvcHVibGljL2pzL2xpYnMvc29ja2V0LmlvLTEuMS4wLmpzIiwiL1VzZXJzL2Fub2xhbjEvX3Byb2plY3RzL19sYWJzL2NocmlzdG1hcy10cmFja2VyL3B1YmxpYy9qcy9tb2R1bGVzL3NvY2tldHMuanMiLCIvVXNlcnMvYW5vbGFuMS9fcHJvamVjdHMvX2xhYnMvY2hyaXN0bWFzLXRyYWNrZXIvcHVibGljL2pzL21vZHVsZXMvdWkuanMiLCIvVXNlcnMvYW5vbGFuMS9fcHJvamVjdHMvX2xhYnMvY2hyaXN0bWFzLXRyYWNrZXIvcHVibGljL2pzL3NjcmlwdC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hjQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaFdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvY0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvKiFcbiAgKiBAcHJlc2VydmUgUXdlcnkgLSBBIEJsYXppbmcgRmFzdCBxdWVyeSBzZWxlY3RvciBlbmdpbmVcbiAgKiBodHRwczovL2dpdGh1Yi5jb20vZGVkL3F3ZXJ5XG4gICogY29weXJpZ2h0IER1c3RpbiBEaWF6IDIwMTJcbiAgKiBNSVQgTGljZW5zZVxuICAqL1xuXG4oZnVuY3Rpb24gKG5hbWUsIGNvbnRleHQsIGRlZmluaXRpb24pIHtcbiAgaWYgKHR5cGVvZiBtb2R1bGUgIT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIG1vZHVsZS5leHBvcnRzID0gZGVmaW5pdGlvbigpXG4gIGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSBkZWZpbmUoZGVmaW5pdGlvbilcbiAgZWxzZSBjb250ZXh0W25hbWVdID0gZGVmaW5pdGlvbigpXG59KSgncXdlcnknLCB0aGlzLCBmdW5jdGlvbiAoKSB7XG4gIHZhciBkb2MgPSBkb2N1bWVudFxuICAgICwgaHRtbCA9IGRvYy5kb2N1bWVudEVsZW1lbnRcbiAgICAsIGJ5Q2xhc3MgPSAnZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSdcbiAgICAsIGJ5VGFnID0gJ2dldEVsZW1lbnRzQnlUYWdOYW1lJ1xuICAgICwgcVNBID0gJ3F1ZXJ5U2VsZWN0b3JBbGwnXG4gICAgLCB1c2VOYXRpdmVRU0EgPSAndXNlTmF0aXZlUVNBJ1xuICAgICwgdGFnTmFtZSA9ICd0YWdOYW1lJ1xuICAgICwgbm9kZVR5cGUgPSAnbm9kZVR5cGUnXG4gICAgLCBzZWxlY3QgLy8gbWFpbiBzZWxlY3QoKSBtZXRob2QsIGFzc2lnbiBsYXRlclxuXG4gICAgLCBpZCA9IC8jKFtcXHdcXC1dKykvXG4gICAgLCBjbGFzID0gL1xcLltcXHdcXC1dKy9nXG4gICAgLCBpZE9ubHkgPSAvXiMoW1xcd1xcLV0rKSQvXG4gICAgLCBjbGFzc09ubHkgPSAvXlxcLihbXFx3XFwtXSspJC9cbiAgICAsIHRhZ09ubHkgPSAvXihbXFx3XFwtXSspJC9cbiAgICAsIHRhZ0FuZE9yQ2xhc3MgPSAvXihbXFx3XSspP1xcLihbXFx3XFwtXSspJC9cbiAgICAsIHNwbGl0dGFibGUgPSAvKF58LClcXHMqWz5+K10vXG4gICAgLCBub3JtYWxpenIgPSAvXlxccyt8XFxzKihbLFxcc1xcK1xcfj5dfCQpXFxzKi9nXG4gICAgLCBzcGxpdHRlcnMgPSAvW1xcc1xcPlxcK1xcfl0vXG4gICAgLCBzcGxpdHRlcnNNb3JlID0gLyg/IVtcXHNcXHdcXC1cXC9cXD9cXCZcXD1cXDpcXC5cXChcXClcXCEsQCMlPD5cXHtcXH1cXCRcXCpcXF4nXCJdKlxcXXxbXFxzXFx3XFwrXFwtXSpcXCkpL1xuICAgICwgc3BlY2lhbENoYXJzID0gLyhbLiorP1xcXj0hOiR7fSgpfFxcW1xcXVxcL1xcXFxdKS9nXG4gICAgLCBzaW1wbGUgPSAvXihcXCp8W2EtejAtOV0rKT8oPzooW1xcLlxcI10rW1xcd1xcLVxcLiNdKyk/KS9cbiAgICAsIGF0dHIgPSAvXFxbKFtcXHdcXC1dKykoPzooW1xcfFxcXlxcJFxcKlxcfl0/XFw9KVsnXCJdPyhbIFxcd1xcLVxcL1xcP1xcJlxcPVxcOlxcLlxcKFxcKVxcISxAIyU8Plxce1xcfVxcJFxcKlxcXl0rKVtcIiddPyk/XFxdL1xuICAgICwgcHNldWRvID0gLzooW1xcd1xcLV0rKShcXChbJ1wiXT8oW14oKV0rKVsnXCJdP1xcKSk/L1xuICAgICwgZWFzeSA9IG5ldyBSZWdFeHAoaWRPbmx5LnNvdXJjZSArICd8JyArIHRhZ09ubHkuc291cmNlICsgJ3wnICsgY2xhc3NPbmx5LnNvdXJjZSlcbiAgICAsIGRpdmlkZXJzID0gbmV3IFJlZ0V4cCgnKCcgKyBzcGxpdHRlcnMuc291cmNlICsgJyknICsgc3BsaXR0ZXJzTW9yZS5zb3VyY2UsICdnJylcbiAgICAsIHRva2VuaXpyID0gbmV3IFJlZ0V4cChzcGxpdHRlcnMuc291cmNlICsgc3BsaXR0ZXJzTW9yZS5zb3VyY2UpXG4gICAgLCBjaHVua2VyID0gbmV3IFJlZ0V4cChzaW1wbGUuc291cmNlICsgJygnICsgYXR0ci5zb3VyY2UgKyAnKT8nICsgJygnICsgcHNldWRvLnNvdXJjZSArICcpPycpXG5cbiAgdmFyIHdhbGtlciA9IHtcbiAgICAgICcgJzogZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgcmV0dXJuIG5vZGUgJiYgbm9kZSAhPT0gaHRtbCAmJiBub2RlLnBhcmVudE5vZGVcbiAgICAgIH1cbiAgICAsICc+JzogZnVuY3Rpb24gKG5vZGUsIGNvbnRlc3RhbnQpIHtcbiAgICAgICAgcmV0dXJuIG5vZGUgJiYgbm9kZS5wYXJlbnROb2RlID09IGNvbnRlc3RhbnQucGFyZW50Tm9kZSAmJiBub2RlLnBhcmVudE5vZGVcbiAgICAgIH1cbiAgICAsICd+JzogZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgcmV0dXJuIG5vZGUgJiYgbm9kZS5wcmV2aW91c1NpYmxpbmdcbiAgICAgIH1cbiAgICAsICcrJzogZnVuY3Rpb24gKG5vZGUsIGNvbnRlc3RhbnQsIHAxLCBwMikge1xuICAgICAgICBpZiAoIW5vZGUpIHJldHVybiBmYWxzZVxuICAgICAgICByZXR1cm4gKHAxID0gcHJldmlvdXMobm9kZSkpICYmIChwMiA9IHByZXZpb3VzKGNvbnRlc3RhbnQpKSAmJiBwMSA9PSBwMiAmJiBwMVxuICAgICAgfVxuICAgIH1cblxuICBmdW5jdGlvbiBjYWNoZSgpIHtcbiAgICB0aGlzLmMgPSB7fVxuICB9XG4gIGNhY2hlLnByb3RvdHlwZSA9IHtcbiAgICBnOiBmdW5jdGlvbiAoaykge1xuICAgICAgcmV0dXJuIHRoaXMuY1trXSB8fCB1bmRlZmluZWRcbiAgICB9XG4gICwgczogZnVuY3Rpb24gKGssIHYsIHIpIHtcbiAgICAgIHYgPSByID8gbmV3IFJlZ0V4cCh2KSA6IHZcbiAgICAgIHJldHVybiAodGhpcy5jW2tdID0gdilcbiAgICB9XG4gIH1cblxuICB2YXIgY2xhc3NDYWNoZSA9IG5ldyBjYWNoZSgpXG4gICAgLCBjbGVhbkNhY2hlID0gbmV3IGNhY2hlKClcbiAgICAsIGF0dHJDYWNoZSA9IG5ldyBjYWNoZSgpXG4gICAgLCB0b2tlbkNhY2hlID0gbmV3IGNhY2hlKClcblxuICBmdW5jdGlvbiBjbGFzc1JlZ2V4KGMpIHtcbiAgICByZXR1cm4gY2xhc3NDYWNoZS5nKGMpIHx8IGNsYXNzQ2FjaGUucyhjLCAnKF58XFxcXHMrKScgKyBjICsgJyhcXFxccyt8JCknLCAxKVxuICB9XG5cbiAgLy8gbm90IHF1aXRlIGFzIGZhc3QgYXMgaW5saW5lIGxvb3BzIGluIG9sZGVyIGJyb3dzZXJzIHNvIGRvbid0IHVzZSBsaWJlcmFsbHlcbiAgZnVuY3Rpb24gZWFjaChhLCBmbikge1xuICAgIHZhciBpID0gMCwgbCA9IGEubGVuZ3RoXG4gICAgZm9yICg7IGkgPCBsOyBpKyspIGZuKGFbaV0pXG4gIH1cblxuICBmdW5jdGlvbiBmbGF0dGVuKGFyKSB7XG4gICAgZm9yICh2YXIgciA9IFtdLCBpID0gMCwgbCA9IGFyLmxlbmd0aDsgaSA8IGw7ICsraSkgYXJyYXlMaWtlKGFyW2ldKSA/IChyID0gci5jb25jYXQoYXJbaV0pKSA6IChyW3IubGVuZ3RoXSA9IGFyW2ldKVxuICAgIHJldHVybiByXG4gIH1cblxuICBmdW5jdGlvbiBhcnJheWlmeShhcikge1xuICAgIHZhciBpID0gMCwgbCA9IGFyLmxlbmd0aCwgciA9IFtdXG4gICAgZm9yICg7IGkgPCBsOyBpKyspIHJbaV0gPSBhcltpXVxuICAgIHJldHVybiByXG4gIH1cblxuICBmdW5jdGlvbiBwcmV2aW91cyhuKSB7XG4gICAgd2hpbGUgKG4gPSBuLnByZXZpb3VzU2libGluZykgaWYgKG5bbm9kZVR5cGVdID09IDEpIGJyZWFrO1xuICAgIHJldHVybiBuXG4gIH1cblxuICBmdW5jdGlvbiBxKHF1ZXJ5KSB7XG4gICAgcmV0dXJuIHF1ZXJ5Lm1hdGNoKGNodW5rZXIpXG4gIH1cblxuICAvLyBjYWxsZWQgdXNpbmcgYHRoaXNgIGFzIGVsZW1lbnQgYW5kIGFyZ3VtZW50cyBmcm9tIHJlZ2V4IGdyb3VwIHJlc3VsdHMuXG4gIC8vIGdpdmVuID0+IGRpdi5oZWxsb1t0aXRsZT1cIndvcmxkXCJdOmZvbygnYmFyJylcbiAgLy8gZGl2LmhlbGxvW3RpdGxlPVwid29ybGRcIl06Zm9vKCdiYXInKSwgZGl2LCAuaGVsbG8sIFt0aXRsZT1cIndvcmxkXCJdLCB0aXRsZSwgPSwgd29ybGQsIDpmb28oJ2JhcicpLCBmb28sICgnYmFyJyksIGJhcl1cbiAgZnVuY3Rpb24gaW50ZXJwcmV0KHdob2xlLCB0YWcsIGlkc0FuZENsYXNzZXMsIHdob2xlQXR0cmlidXRlLCBhdHRyaWJ1dGUsIHF1YWxpZmllciwgdmFsdWUsIHdob2xlUHNldWRvLCBwc2V1ZG8sIHdob2xlUHNldWRvVmFsLCBwc2V1ZG9WYWwpIHtcbiAgICB2YXIgaSwgbSwgaywgbywgY2xhc3Nlc1xuICAgIGlmICh0aGlzW25vZGVUeXBlXSAhPT0gMSkgcmV0dXJuIGZhbHNlXG4gICAgaWYgKHRhZyAmJiB0YWcgIT09ICcqJyAmJiB0aGlzW3RhZ05hbWVdICYmIHRoaXNbdGFnTmFtZV0udG9Mb3dlckNhc2UoKSAhPT0gdGFnKSByZXR1cm4gZmFsc2VcbiAgICBpZiAoaWRzQW5kQ2xhc3NlcyAmJiAobSA9IGlkc0FuZENsYXNzZXMubWF0Y2goaWQpKSAmJiBtWzFdICE9PSB0aGlzLmlkKSByZXR1cm4gZmFsc2VcbiAgICBpZiAoaWRzQW5kQ2xhc3NlcyAmJiAoY2xhc3NlcyA9IGlkc0FuZENsYXNzZXMubWF0Y2goY2xhcykpKSB7XG4gICAgICBmb3IgKGkgPSBjbGFzc2VzLmxlbmd0aDsgaS0tOykgaWYgKCFjbGFzc1JlZ2V4KGNsYXNzZXNbaV0uc2xpY2UoMSkpLnRlc3QodGhpcy5jbGFzc05hbWUpKSByZXR1cm4gZmFsc2VcbiAgICB9XG4gICAgaWYgKHBzZXVkbyAmJiBxd2VyeS5wc2V1ZG9zW3BzZXVkb10gJiYgIXF3ZXJ5LnBzZXVkb3NbcHNldWRvXSh0aGlzLCBwc2V1ZG9WYWwpKSByZXR1cm4gZmFsc2VcbiAgICBpZiAod2hvbGVBdHRyaWJ1dGUgJiYgIXZhbHVlKSB7IC8vIHNlbGVjdCBpcyBqdXN0IGZvciBleGlzdGFuY2Ugb2YgYXR0cmliXG4gICAgICBvID0gdGhpcy5hdHRyaWJ1dGVzXG4gICAgICBmb3IgKGsgaW4gbykge1xuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG8sIGspICYmIChvW2tdLm5hbWUgfHwgaykgPT0gYXR0cmlidXRlKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXNcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAod2hvbGVBdHRyaWJ1dGUgJiYgIWNoZWNrQXR0cihxdWFsaWZpZXIsIGdldEF0dHIodGhpcywgYXR0cmlidXRlKSB8fCAnJywgdmFsdWUpKSB7XG4gICAgICAvLyBzZWxlY3QgaXMgZm9yIGF0dHJpYiBlcXVhbGl0eVxuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICBmdW5jdGlvbiBjbGVhbihzKSB7XG4gICAgcmV0dXJuIGNsZWFuQ2FjaGUuZyhzKSB8fCBjbGVhbkNhY2hlLnMocywgcy5yZXBsYWNlKHNwZWNpYWxDaGFycywgJ1xcXFwkMScpKVxuICB9XG5cbiAgZnVuY3Rpb24gY2hlY2tBdHRyKHF1YWxpZnksIGFjdHVhbCwgdmFsKSB7XG4gICAgc3dpdGNoIChxdWFsaWZ5KSB7XG4gICAgY2FzZSAnPSc6XG4gICAgICByZXR1cm4gYWN0dWFsID09IHZhbFxuICAgIGNhc2UgJ149JzpcbiAgICAgIHJldHVybiBhY3R1YWwubWF0Y2goYXR0ckNhY2hlLmcoJ149JyArIHZhbCkgfHwgYXR0ckNhY2hlLnMoJ149JyArIHZhbCwgJ14nICsgY2xlYW4odmFsKSwgMSkpXG4gICAgY2FzZSAnJD0nOlxuICAgICAgcmV0dXJuIGFjdHVhbC5tYXRjaChhdHRyQ2FjaGUuZygnJD0nICsgdmFsKSB8fCBhdHRyQ2FjaGUucygnJD0nICsgdmFsLCBjbGVhbih2YWwpICsgJyQnLCAxKSlcbiAgICBjYXNlICcqPSc6XG4gICAgICByZXR1cm4gYWN0dWFsLm1hdGNoKGF0dHJDYWNoZS5nKHZhbCkgfHwgYXR0ckNhY2hlLnModmFsLCBjbGVhbih2YWwpLCAxKSlcbiAgICBjYXNlICd+PSc6XG4gICAgICByZXR1cm4gYWN0dWFsLm1hdGNoKGF0dHJDYWNoZS5nKCd+PScgKyB2YWwpIHx8IGF0dHJDYWNoZS5zKCd+PScgKyB2YWwsICcoPzpefFxcXFxzKyknICsgY2xlYW4odmFsKSArICcoPzpcXFxccyt8JCknLCAxKSlcbiAgICBjYXNlICd8PSc6XG4gICAgICByZXR1cm4gYWN0dWFsLm1hdGNoKGF0dHJDYWNoZS5nKCd8PScgKyB2YWwpIHx8IGF0dHJDYWNoZS5zKCd8PScgKyB2YWwsICdeJyArIGNsZWFuKHZhbCkgKyAnKC18JCknLCAxKSlcbiAgICB9XG4gICAgcmV0dXJuIDBcbiAgfVxuXG4gIC8vIGdpdmVuIGEgc2VsZWN0b3IsIGZpcnN0IGNoZWNrIGZvciBzaW1wbGUgY2FzZXMgdGhlbiBjb2xsZWN0IGFsbCBiYXNlIGNhbmRpZGF0ZSBtYXRjaGVzIGFuZCBmaWx0ZXJcbiAgZnVuY3Rpb24gX3F3ZXJ5KHNlbGVjdG9yLCBfcm9vdCkge1xuICAgIHZhciByID0gW10sIHJldCA9IFtdLCBpLCBsLCBtLCB0b2tlbiwgdGFnLCBlbHMsIGludHIsIGl0ZW0sIHJvb3QgPSBfcm9vdFxuICAgICAgLCB0b2tlbnMgPSB0b2tlbkNhY2hlLmcoc2VsZWN0b3IpIHx8IHRva2VuQ2FjaGUucyhzZWxlY3Rvciwgc2VsZWN0b3Iuc3BsaXQodG9rZW5penIpKVxuICAgICAgLCBkaXZpZGVkVG9rZW5zID0gc2VsZWN0b3IubWF0Y2goZGl2aWRlcnMpXG5cbiAgICBpZiAoIXRva2Vucy5sZW5ndGgpIHJldHVybiByXG5cbiAgICB0b2tlbiA9ICh0b2tlbnMgPSB0b2tlbnMuc2xpY2UoMCkpLnBvcCgpIC8vIGNvcHkgY2FjaGVkIHRva2VucywgdGFrZSB0aGUgbGFzdCBvbmVcbiAgICBpZiAodG9rZW5zLmxlbmd0aCAmJiAobSA9IHRva2Vuc1t0b2tlbnMubGVuZ3RoIC0gMV0ubWF0Y2goaWRPbmx5KSkpIHJvb3QgPSBieUlkKF9yb290LCBtWzFdKVxuICAgIGlmICghcm9vdCkgcmV0dXJuIHJcblxuICAgIGludHIgPSBxKHRva2VuKVxuICAgIC8vIGNvbGxlY3QgYmFzZSBjYW5kaWRhdGVzIHRvIGZpbHRlclxuICAgIGVscyA9IHJvb3QgIT09IF9yb290ICYmIHJvb3Rbbm9kZVR5cGVdICE9PSA5ICYmIGRpdmlkZWRUb2tlbnMgJiYgL15bK35dJC8udGVzdChkaXZpZGVkVG9rZW5zW2RpdmlkZWRUb2tlbnMubGVuZ3RoIC0gMV0pID9cbiAgICAgIGZ1bmN0aW9uIChyKSB7XG4gICAgICAgIHdoaWxlIChyb290ID0gcm9vdC5uZXh0U2libGluZykge1xuICAgICAgICAgIHJvb3Rbbm9kZVR5cGVdID09IDEgJiYgKGludHJbMV0gPyBpbnRyWzFdID09IHJvb3RbdGFnTmFtZV0udG9Mb3dlckNhc2UoKSA6IDEpICYmIChyW3IubGVuZ3RoXSA9IHJvb3QpXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJcbiAgICAgIH0oW10pIDpcbiAgICAgIHJvb3RbYnlUYWddKGludHJbMV0gfHwgJyonKVxuICAgIC8vIGZpbHRlciBlbGVtZW50cyBhY2NvcmRpbmcgdG8gdGhlIHJpZ2h0LW1vc3QgcGFydCBvZiB0aGUgc2VsZWN0b3JcbiAgICBmb3IgKGkgPSAwLCBsID0gZWxzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgaWYgKGl0ZW0gPSBpbnRlcnByZXQuYXBwbHkoZWxzW2ldLCBpbnRyKSkgcltyLmxlbmd0aF0gPSBpdGVtXG4gICAgfVxuICAgIGlmICghdG9rZW5zLmxlbmd0aCkgcmV0dXJuIHJcblxuICAgIC8vIGZpbHRlciBmdXJ0aGVyIGFjY29yZGluZyB0byB0aGUgcmVzdCBvZiB0aGUgc2VsZWN0b3IgKHRoZSBsZWZ0IHNpZGUpXG4gICAgZWFjaChyLCBmdW5jdGlvbiAoZSkgeyBpZiAoYW5jZXN0b3JNYXRjaChlLCB0b2tlbnMsIGRpdmlkZWRUb2tlbnMpKSByZXRbcmV0Lmxlbmd0aF0gPSBlIH0pXG4gICAgcmV0dXJuIHJldFxuICB9XG5cbiAgLy8gY29tcGFyZSBlbGVtZW50IHRvIGEgc2VsZWN0b3JcbiAgZnVuY3Rpb24gaXMoZWwsIHNlbGVjdG9yLCByb290KSB7XG4gICAgaWYgKGlzTm9kZShzZWxlY3RvcikpIHJldHVybiBlbCA9PSBzZWxlY3RvclxuICAgIGlmIChhcnJheUxpa2Uoc2VsZWN0b3IpKSByZXR1cm4gISF+ZmxhdHRlbihzZWxlY3RvcikuaW5kZXhPZihlbCkgLy8gaWYgc2VsZWN0b3IgaXMgYW4gYXJyYXksIGlzIGVsIGEgbWVtYmVyP1xuXG4gICAgdmFyIHNlbGVjdG9ycyA9IHNlbGVjdG9yLnNwbGl0KCcsJyksIHRva2VucywgZGl2aWRlZFRva2Vuc1xuICAgIHdoaWxlIChzZWxlY3RvciA9IHNlbGVjdG9ycy5wb3AoKSkge1xuICAgICAgdG9rZW5zID0gdG9rZW5DYWNoZS5nKHNlbGVjdG9yKSB8fCB0b2tlbkNhY2hlLnMoc2VsZWN0b3IsIHNlbGVjdG9yLnNwbGl0KHRva2VuaXpyKSlcbiAgICAgIGRpdmlkZWRUb2tlbnMgPSBzZWxlY3Rvci5tYXRjaChkaXZpZGVycylcbiAgICAgIHRva2VucyA9IHRva2Vucy5zbGljZSgwKSAvLyBjb3B5IGFycmF5XG4gICAgICBpZiAoaW50ZXJwcmV0LmFwcGx5KGVsLCBxKHRva2Vucy5wb3AoKSkpICYmICghdG9rZW5zLmxlbmd0aCB8fCBhbmNlc3Rvck1hdGNoKGVsLCB0b2tlbnMsIGRpdmlkZWRUb2tlbnMsIHJvb3QpKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIC8vIGdpdmVuIGVsZW1lbnRzIG1hdGNoaW5nIHRoZSByaWdodC1tb3N0IHBhcnQgb2YgYSBzZWxlY3RvciwgZmlsdGVyIG91dCBhbnkgdGhhdCBkb24ndCBtYXRjaCB0aGUgcmVzdFxuICBmdW5jdGlvbiBhbmNlc3Rvck1hdGNoKGVsLCB0b2tlbnMsIGRpdmlkZWRUb2tlbnMsIHJvb3QpIHtcbiAgICB2YXIgY2FuZFxuICAgIC8vIHJlY3Vyc2l2ZWx5IHdvcmsgYmFja3dhcmRzIHRocm91Z2ggdGhlIHRva2VucyBhbmQgdXAgdGhlIGRvbSwgY292ZXJpbmcgYWxsIG9wdGlvbnNcbiAgICBmdW5jdGlvbiBjcmF3bChlLCBpLCBwKSB7XG4gICAgICB3aGlsZSAocCA9IHdhbGtlcltkaXZpZGVkVG9rZW5zW2ldXShwLCBlKSkge1xuICAgICAgICBpZiAoaXNOb2RlKHApICYmIChpbnRlcnByZXQuYXBwbHkocCwgcSh0b2tlbnNbaV0pKSkpIHtcbiAgICAgICAgICBpZiAoaSkge1xuICAgICAgICAgICAgaWYgKGNhbmQgPSBjcmF3bChwLCBpIC0gMSwgcCkpIHJldHVybiBjYW5kXG4gICAgICAgICAgfSBlbHNlIHJldHVybiBwXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIChjYW5kID0gY3Jhd2woZWwsIHRva2Vucy5sZW5ndGggLSAxLCBlbCkpICYmICghcm9vdCB8fCBpc0FuY2VzdG9yKGNhbmQsIHJvb3QpKVxuICB9XG5cbiAgZnVuY3Rpb24gaXNOb2RlKGVsLCB0KSB7XG4gICAgcmV0dXJuIGVsICYmIHR5cGVvZiBlbCA9PT0gJ29iamVjdCcgJiYgKHQgPSBlbFtub2RlVHlwZV0pICYmICh0ID09IDEgfHwgdCA9PSA5KVxuICB9XG5cbiAgZnVuY3Rpb24gdW5pcShhcikge1xuICAgIHZhciBhID0gW10sIGksIGo7XG4gICAgbzpcbiAgICBmb3IgKGkgPSAwOyBpIDwgYXIubGVuZ3RoOyArK2kpIHtcbiAgICAgIGZvciAoaiA9IDA7IGogPCBhLmxlbmd0aDsgKytqKSBpZiAoYVtqXSA9PSBhcltpXSkgY29udGludWUgb1xuICAgICAgYVthLmxlbmd0aF0gPSBhcltpXVxuICAgIH1cbiAgICByZXR1cm4gYVxuICB9XG5cbiAgZnVuY3Rpb24gYXJyYXlMaWtlKG8pIHtcbiAgICByZXR1cm4gKHR5cGVvZiBvID09PSAnb2JqZWN0JyAmJiBpc0Zpbml0ZShvLmxlbmd0aCkpXG4gIH1cblxuICBmdW5jdGlvbiBub3JtYWxpemVSb290KHJvb3QpIHtcbiAgICBpZiAoIXJvb3QpIHJldHVybiBkb2NcbiAgICBpZiAodHlwZW9mIHJvb3QgPT0gJ3N0cmluZycpIHJldHVybiBxd2VyeShyb290KVswXVxuICAgIGlmICghcm9vdFtub2RlVHlwZV0gJiYgYXJyYXlMaWtlKHJvb3QpKSByZXR1cm4gcm9vdFswXVxuICAgIHJldHVybiByb290XG4gIH1cblxuICBmdW5jdGlvbiBieUlkKHJvb3QsIGlkLCBlbCkge1xuICAgIC8vIGlmIGRvYywgcXVlcnkgb24gaXQsIGVsc2UgcXVlcnkgdGhlIHBhcmVudCBkb2Mgb3IgaWYgYSBkZXRhY2hlZCBmcmFnbWVudCByZXdyaXRlIHRoZSBxdWVyeSBhbmQgcnVuIG9uIHRoZSBmcmFnbWVudFxuICAgIHJldHVybiByb290W25vZGVUeXBlXSA9PT0gOSA/IHJvb3QuZ2V0RWxlbWVudEJ5SWQoaWQpIDpcbiAgICAgIHJvb3Qub3duZXJEb2N1bWVudCAmJlxuICAgICAgICAoKChlbCA9IHJvb3Qub3duZXJEb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkpICYmIGlzQW5jZXN0b3IoZWwsIHJvb3QpICYmIGVsKSB8fFxuICAgICAgICAgICghaXNBbmNlc3Rvcihyb290LCByb290Lm93bmVyRG9jdW1lbnQpICYmIHNlbGVjdCgnW2lkPVwiJyArIGlkICsgJ1wiXScsIHJvb3QpWzBdKSlcbiAgfVxuXG4gIGZ1bmN0aW9uIHF3ZXJ5KHNlbGVjdG9yLCBfcm9vdCkge1xuICAgIHZhciBtLCBlbCwgcm9vdCA9IG5vcm1hbGl6ZVJvb3QoX3Jvb3QpXG5cbiAgICAvLyBlYXN5LCBmYXN0IGNhc2VzIHRoYXQgd2UgY2FuIGRpc3BhdGNoIHdpdGggc2ltcGxlIERPTSBjYWxsc1xuICAgIGlmICghcm9vdCB8fCAhc2VsZWN0b3IpIHJldHVybiBbXVxuICAgIGlmIChzZWxlY3RvciA9PT0gd2luZG93IHx8IGlzTm9kZShzZWxlY3RvcikpIHtcbiAgICAgIHJldHVybiAhX3Jvb3QgfHwgKHNlbGVjdG9yICE9PSB3aW5kb3cgJiYgaXNOb2RlKHJvb3QpICYmIGlzQW5jZXN0b3Ioc2VsZWN0b3IsIHJvb3QpKSA/IFtzZWxlY3Rvcl0gOiBbXVxuICAgIH1cbiAgICBpZiAoc2VsZWN0b3IgJiYgYXJyYXlMaWtlKHNlbGVjdG9yKSkgcmV0dXJuIGZsYXR0ZW4oc2VsZWN0b3IpXG4gICAgaWYgKG0gPSBzZWxlY3Rvci5tYXRjaChlYXN5KSkge1xuICAgICAgaWYgKG1bMV0pIHJldHVybiAoZWwgPSBieUlkKHJvb3QsIG1bMV0pKSA/IFtlbF0gOiBbXVxuICAgICAgaWYgKG1bMl0pIHJldHVybiBhcnJheWlmeShyb290W2J5VGFnXShtWzJdKSlcbiAgICAgIGlmIChoYXNCeUNsYXNzICYmIG1bM10pIHJldHVybiBhcnJheWlmeShyb290W2J5Q2xhc3NdKG1bM10pKVxuICAgIH1cblxuICAgIHJldHVybiBzZWxlY3Qoc2VsZWN0b3IsIHJvb3QpXG4gIH1cblxuICAvLyB3aGVyZSB0aGUgcm9vdCBpcyBub3QgZG9jdW1lbnQgYW5kIGEgcmVsYXRpb25zaGlwIHNlbGVjdG9yIGlzIGZpcnN0IHdlIGhhdmUgdG9cbiAgLy8gZG8gc29tZSBhd2t3YXJkIGFkanVzdG1lbnRzIHRvIGdldCBpdCB0byB3b3JrLCBldmVuIHdpdGggcVNBXG4gIGZ1bmN0aW9uIGNvbGxlY3RTZWxlY3Rvcihyb290LCBjb2xsZWN0b3IpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHMpIHtcbiAgICAgIHZhciBvaWQsIG5pZFxuICAgICAgaWYgKHNwbGl0dGFibGUudGVzdChzKSkge1xuICAgICAgICBpZiAocm9vdFtub2RlVHlwZV0gIT09IDkpIHtcbiAgICAgICAgICAvLyBtYWtlIHN1cmUgdGhlIGVsIGhhcyBhbiBpZCwgcmV3cml0ZSB0aGUgcXVlcnksIHNldCByb290IHRvIGRvYyBhbmQgcnVuIGl0XG4gICAgICAgICAgaWYgKCEobmlkID0gb2lkID0gcm9vdC5nZXRBdHRyaWJ1dGUoJ2lkJykpKSByb290LnNldEF0dHJpYnV0ZSgnaWQnLCBuaWQgPSAnX19xd2VyeW1ldXBzY290dHknKVxuICAgICAgICAgIHMgPSAnW2lkPVwiJyArIG5pZCArICdcIl0nICsgcyAvLyBhdm9pZCBieUlkIGFuZCBhbGxvdyB1cyB0byBtYXRjaCBjb250ZXh0IGVsZW1lbnRcbiAgICAgICAgICBjb2xsZWN0b3Iocm9vdC5wYXJlbnROb2RlIHx8IHJvb3QsIHMsIHRydWUpXG4gICAgICAgICAgb2lkIHx8IHJvb3QucmVtb3ZlQXR0cmlidXRlKCdpZCcpXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgcy5sZW5ndGggJiYgY29sbGVjdG9yKHJvb3QsIHMsIGZhbHNlKVxuICAgIH1cbiAgfVxuXG4gIHZhciBpc0FuY2VzdG9yID0gJ2NvbXBhcmVEb2N1bWVudFBvc2l0aW9uJyBpbiBodG1sID9cbiAgICBmdW5jdGlvbiAoZWxlbWVudCwgY29udGFpbmVyKSB7XG4gICAgICByZXR1cm4gKGNvbnRhaW5lci5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihlbGVtZW50KSAmIDE2KSA9PSAxNlxuICAgIH0gOiAnY29udGFpbnMnIGluIGh0bWwgP1xuICAgIGZ1bmN0aW9uIChlbGVtZW50LCBjb250YWluZXIpIHtcbiAgICAgIGNvbnRhaW5lciA9IGNvbnRhaW5lcltub2RlVHlwZV0gPT09IDkgfHwgY29udGFpbmVyID09IHdpbmRvdyA/IGh0bWwgOiBjb250YWluZXJcbiAgICAgIHJldHVybiBjb250YWluZXIgIT09IGVsZW1lbnQgJiYgY29udGFpbmVyLmNvbnRhaW5zKGVsZW1lbnQpXG4gICAgfSA6XG4gICAgZnVuY3Rpb24gKGVsZW1lbnQsIGNvbnRhaW5lcikge1xuICAgICAgd2hpbGUgKGVsZW1lbnQgPSBlbGVtZW50LnBhcmVudE5vZGUpIGlmIChlbGVtZW50ID09PSBjb250YWluZXIpIHJldHVybiAxXG4gICAgICByZXR1cm4gMFxuICAgIH1cbiAgLCBnZXRBdHRyID0gZnVuY3Rpb24gKCkge1xuICAgICAgLy8gZGV0ZWN0IGJ1Z2d5IElFIHNyYy9ocmVmIGdldEF0dHJpYnV0ZSgpIGNhbGxcbiAgICAgIHZhciBlID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ3AnKVxuICAgICAgcmV0dXJuICgoZS5pbm5lckhUTUwgPSAnPGEgaHJlZj1cIiN4XCI+eDwvYT4nKSAmJiBlLmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKCdocmVmJykgIT0gJyN4JykgP1xuICAgICAgICBmdW5jdGlvbiAoZSwgYSkge1xuICAgICAgICAgIHJldHVybiBhID09PSAnY2xhc3MnID8gZS5jbGFzc05hbWUgOiAoYSA9PT0gJ2hyZWYnIHx8IGEgPT09ICdzcmMnKSA/XG4gICAgICAgICAgICBlLmdldEF0dHJpYnV0ZShhLCAyKSA6IGUuZ2V0QXR0cmlidXRlKGEpXG4gICAgICAgIH0gOlxuICAgICAgICBmdW5jdGlvbiAoZSwgYSkgeyByZXR1cm4gZS5nZXRBdHRyaWJ1dGUoYSkgfVxuICAgIH0oKVxuICAsIGhhc0J5Q2xhc3MgPSAhIWRvY1tieUNsYXNzXVxuICAgIC8vIGhhcyBuYXRpdmUgcVNBIHN1cHBvcnRcbiAgLCBoYXNRU0EgPSBkb2MucXVlcnlTZWxlY3RvciAmJiBkb2NbcVNBXVxuICAgIC8vIHVzZSBuYXRpdmUgcVNBXG4gICwgc2VsZWN0UVNBID0gZnVuY3Rpb24gKHNlbGVjdG9yLCByb290KSB7XG4gICAgICB2YXIgcmVzdWx0ID0gW10sIHNzLCBlXG4gICAgICB0cnkge1xuICAgICAgICBpZiAocm9vdFtub2RlVHlwZV0gPT09IDkgfHwgIXNwbGl0dGFibGUudGVzdChzZWxlY3RvcikpIHtcbiAgICAgICAgICAvLyBtb3N0IHdvcmsgaXMgZG9uZSByaWdodCBoZXJlLCBkZWZlciB0byBxU0FcbiAgICAgICAgICByZXR1cm4gYXJyYXlpZnkocm9vdFtxU0FdKHNlbGVjdG9yKSlcbiAgICAgICAgfVxuICAgICAgICAvLyBzcGVjaWFsIGNhc2Ugd2hlcmUgd2UgbmVlZCB0aGUgc2VydmljZXMgb2YgYGNvbGxlY3RTZWxlY3RvcigpYFxuICAgICAgICBlYWNoKHNzID0gc2VsZWN0b3Iuc3BsaXQoJywnKSwgY29sbGVjdFNlbGVjdG9yKHJvb3QsIGZ1bmN0aW9uIChjdHgsIHMpIHtcbiAgICAgICAgICBlID0gY3R4W3FTQV0ocylcbiAgICAgICAgICBpZiAoZS5sZW5ndGggPT0gMSkgcmVzdWx0W3Jlc3VsdC5sZW5ndGhdID0gZS5pdGVtKDApXG4gICAgICAgICAgZWxzZSBpZiAoZS5sZW5ndGgpIHJlc3VsdCA9IHJlc3VsdC5jb25jYXQoYXJyYXlpZnkoZSkpXG4gICAgICAgIH0pKVxuICAgICAgICByZXR1cm4gc3MubGVuZ3RoID4gMSAmJiByZXN1bHQubGVuZ3RoID4gMSA/IHVuaXEocmVzdWx0KSA6IHJlc3VsdFxuICAgICAgfSBjYXRjaCAoZXgpIHsgfVxuICAgICAgcmV0dXJuIHNlbGVjdE5vbk5hdGl2ZShzZWxlY3Rvciwgcm9vdClcbiAgICB9XG4gICAgLy8gbm8gbmF0aXZlIHNlbGVjdG9yIHN1cHBvcnRcbiAgLCBzZWxlY3ROb25OYXRpdmUgPSBmdW5jdGlvbiAoc2VsZWN0b3IsIHJvb3QpIHtcbiAgICAgIHZhciByZXN1bHQgPSBbXSwgaXRlbXMsIG0sIGksIGwsIHIsIHNzXG4gICAgICBzZWxlY3RvciA9IHNlbGVjdG9yLnJlcGxhY2Uobm9ybWFsaXpyLCAnJDEnKVxuICAgICAgaWYgKG0gPSBzZWxlY3Rvci5tYXRjaCh0YWdBbmRPckNsYXNzKSkge1xuICAgICAgICByID0gY2xhc3NSZWdleChtWzJdKVxuICAgICAgICBpdGVtcyA9IHJvb3RbYnlUYWddKG1bMV0gfHwgJyonKVxuICAgICAgICBmb3IgKGkgPSAwLCBsID0gaXRlbXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgaWYgKHIudGVzdChpdGVtc1tpXS5jbGFzc05hbWUpKSByZXN1bHRbcmVzdWx0Lmxlbmd0aF0gPSBpdGVtc1tpXVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHRcbiAgICAgIH1cbiAgICAgIC8vIG1vcmUgY29tcGxleCBzZWxlY3RvciwgZ2V0IGBfcXdlcnkoKWAgdG8gZG8gdGhlIHdvcmsgZm9yIHVzXG4gICAgICBlYWNoKHNzID0gc2VsZWN0b3Iuc3BsaXQoJywnKSwgY29sbGVjdFNlbGVjdG9yKHJvb3QsIGZ1bmN0aW9uIChjdHgsIHMsIHJld3JpdGUpIHtcbiAgICAgICAgciA9IF9xd2VyeShzLCBjdHgpXG4gICAgICAgIGZvciAoaSA9IDAsIGwgPSByLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgIGlmIChjdHhbbm9kZVR5cGVdID09PSA5IHx8IHJld3JpdGUgfHwgaXNBbmNlc3RvcihyW2ldLCByb290KSkgcmVzdWx0W3Jlc3VsdC5sZW5ndGhdID0gcltpXVxuICAgICAgICB9XG4gICAgICB9KSlcbiAgICAgIHJldHVybiBzcy5sZW5ndGggPiAxICYmIHJlc3VsdC5sZW5ndGggPiAxID8gdW5pcShyZXN1bHQpIDogcmVzdWx0XG4gICAgfVxuICAsIGNvbmZpZ3VyZSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICAvLyBjb25maWdOYXRpdmVRU0E6IHVzZSBmdWxseS1pbnRlcm5hbCBzZWxlY3RvciBvciBuYXRpdmUgcVNBIHdoZXJlIHByZXNlbnRcbiAgICAgIGlmICh0eXBlb2Ygb3B0aW9uc1t1c2VOYXRpdmVRU0FdICE9PSAndW5kZWZpbmVkJylcbiAgICAgICAgc2VsZWN0ID0gIW9wdGlvbnNbdXNlTmF0aXZlUVNBXSA/IHNlbGVjdE5vbk5hdGl2ZSA6IGhhc1FTQSA/IHNlbGVjdFFTQSA6IHNlbGVjdE5vbk5hdGl2ZVxuICAgIH1cblxuICBjb25maWd1cmUoeyB1c2VOYXRpdmVRU0E6IHRydWUgfSlcblxuICBxd2VyeS5jb25maWd1cmUgPSBjb25maWd1cmVcbiAgcXdlcnkudW5pcSA9IHVuaXFcbiAgcXdlcnkuaXMgPSBpc1xuICBxd2VyeS5wc2V1ZG9zID0ge31cblxuICByZXR1cm4gcXdlcnlcbn0pO1xuIiwiLyogdHJhay5qcyB2MC4zLjAgfCAoYykgMjAxNCBAbXJtYXJ0aW5lYXUgfCBodHRwczovL2dpdGh1Yi5jb20vdG13YWdlbmN5L3RyYWsuanNcbiAgIFVuaXZlcnNhbCBldmVudCB0cmFja2luZyBBUEkuICovXG52YXIgdHJhayA9IChmdW5jdGlvbigpIHtcblx0J3VzZSBzdHJpY3QnO1xuXG5cblx0LyoqXG5cdCAqIHRyYWsuY2xlYW4oKVxuXHQgKiBDbGVhbnMgdGhlIGlucHV0IHJlcGxhY2luZyBzcGFjZXMgd2l0aCBhIHNwZWNpZmllZCBkZWxpbWV0ZXIgKHNlZSB0cmFrLm9wdGlvbnMpIGFuZCBjb252ZXJ0cyB0byBsb3dlciBjYXNlXG5cdCAqIEBwYXJhbSAgc3RyaW5nIHN0clxuXHQgKiBAcmV0dXJuIHN0cmluZyBjbGVhbmVkIHN0cmluZ1xuXHQgKi9cblx0dmFyIGNsZWFuID0gZnVuY3Rpb24oc3RyKSB7XG5cdFx0aWYgKCFzdHIpIHtcblx0XHRcdHJldHVybiAnJztcblx0XHR9XG5cdFx0aWYgKCF0cmFrLm9wdGlvbnMuY2xlYW4pIHtcblx0XHRcdHJldHVybiB3aWxkY2FyZC5jYWxsKHRoaXMsIHN0cik7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiB3aWxkY2FyZC5jYWxsKHRoaXMsIHN0cikudG9TdHJpbmcoKS5yZXBsYWNlKC9cXHN8J3xcIi9nLCBzZXR0aW5ncy5kZWxpbWV0ZXIpLnRvTG93ZXJDYXNlKCk7XG5cdFx0fVxuXHR9O1xuXG5cblx0LyoqXG5cdCAqIHRyYWsuZXZlbnQoKVxuXHQgKiBAcGFyYW0gIG9iamVjdCBvcHRpb25zICAgICBTZWUgZ2V0T3B0aW9ucygpIGZ1bmN0aW9uIGZvciBhdmFpbGFibGUgaXRlbXNcblx0ICovXG5cdHZhciBldmVudCA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHR2YXIgb3B0cyAgICAgICAgICAgPSBnZXRPcHRpb25zKG9wdGlvbnMpO1xuXG5cdFx0Ly8gQ2FjaGUgdGhlIG9wdGlvbnNcblx0XHR2YXIgY2F0ZWdvcnkgICAgICAgPSBjbGVhbi5jYWxsKHRoaXMsIG9wdHMuY2F0ZWdvcnkpO1xuXHRcdHZhciBhY3Rpb24gICAgICAgICA9IGNsZWFuLmNhbGwodGhpcywgb3B0cy5hY3Rpb24pO1xuXHRcdHZhciBsYWJlbCAgICAgICAgICA9IGNsZWFuLmNhbGwodGhpcywgb3B0cy5sYWJlbCk7XG5cdFx0dmFyIGV2ZW50TmFtZSAgICAgID0gb3B0cy5ldmVudE5hbWU7XG5cdFx0dmFyIHZhbHVlICAgICAgICAgID0gb3B0cy52YWx1ZTtcblx0XHR2YXIgbm9uSW50ZXJhY3Rpb24gPSBvcHRzLm5vbkludGVyYWN0aW9uO1xuXG5cdFx0aWYgKHNldHRpbmdzLnRyYWNrVHlwZSA9PT0gJ2dhJyAmJiB0eXBlb2YgZ2EgIT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRnYSgnc2VuZCcsICdldmVudCcsIGNhdGVnb3J5LCBhY3Rpb24sIGxhYmVsLCB2YWx1ZSwgeydub25JbnRlcmFjdGlvbic6IG5vbkludGVyYWN0aW9ufSk7XG5cblx0XHR9IGVsc2UgaWYgKHNldHRpbmdzLnRyYWNrVHlwZSA9PT0gJ19nYXEnICYmIHR5cGVvZiBfZ2FxICE9PSAndW5kZWZpbmVkJykge1xuXHRcdFx0X2dhcS5wdXNoKFsnX3RyYWNrRXZlbnQnLCBjYXRlZ29yeSwgYWN0aW9uLCBsYWJlbCwgdmFsdWVdKTtcblxuXHRcdH0gZWxzZSBpZiAoc2V0dGluZ3MudHJhY2tUeXBlID09PSAnZ3RtJyAmJiB0eXBlb2YgZGF0YUxheWVyICE9PSAndW5kZWZpbmVkJykge1xuXHRcdFx0ZGF0YUxheWVyLnB1c2goe1xuXHRcdFx0XHQnZXZlbnQnICAgICAgICAgOiBldmVudE5hbWUsXG5cdFx0XHRcdCdldmVudENhdGVnb3J5JyA6IGNhdGVnb3J5LFxuXHRcdFx0XHQnZXZlbnRBY3Rpb24nICAgOiBhY3Rpb24sXG5cdFx0XHRcdCdldmVudExhYmVsJyAgICA6IGxhYmVsLFxuXHRcdFx0XHQnZXZlbnRWYWx1ZScgICAgOiB2YWx1ZVxuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0aWYgKHNldHRpbmdzLmFkZGl0aW9uYWxUeXBlcyAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRzZXR0aW5ncy5hZGRpdGlvbmFsVHlwZXMoKTtcblx0XHR9XG5cblx0XHRpZiAoc2V0dGluZ3MuZGVidWcpIHtcblx0XHRcdGNvbnNvbGUuZGVidWcoJ0RlYnVnIG1lc3NhZ2U6XFxuIENhdGVnb3J5OicsIGNhdGVnb3J5LCAnXFxuIEFjdGlvbjonLCBhY3Rpb24sICdcXG4gTGFiZWw6JywgbGFiZWwpO1xuXHRcdH1cblx0fTtcblxuXG5cdC8qKlxuXHQgKiBkYXRhQXR0ckV2ZW50XG5cdCAqIFRoaXMgaXMgY2FsbGVkIHdoZW4gYW55IGVsZW1lbnQgd2l0aCB0aGUgW2RhdGEtdHJha10gYXR0cmlidXRlIGlzIGNsaWNrZWQuXG5cdCAqIElmIFtkYXRhLXRyYWt3aXRoanNdIGlzIHByZXNlbnQgb24gdGhlIGVsZW1lbnQsIHRoZSB0cmFrLmF0dHIoKSBtZXRob2QgaXMgbm90IGNhbGxlZFxuXHQgKiBUbyBhbGxvdyB1c2Ugb2YgdGhlXG5cdCAqL1xuXHR2YXIgZGF0YUF0dHJFdmVudCA9IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB0cmFrV2l0aEpzID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ2RhdGEtdHJha3dpdGhqcycpICE9PSBudWxsID8gdHJ1ZSA6IGZhbHNlO1xuXHRcdGlmICghdHJha1dpdGhKcykge1xuXHRcdFx0YXR0ckV2ZW50LmNhbGwodGhpcyk7XG5cdFx0fVxuXHR9O1xuXG5cblx0LyoqXG5cdCAqIGF0dHJFdmVudFxuXHQgKiBUaGlzIGlzIHVzZWQgd2hlbiBlbGVtZW50cyB3aXRoIHRoZSBbZGF0YS10cmFrXSBpcyBwcmVzZW50LlxuXHQgKiBJdCBjYWxscyB0cmFrLmV2ZW50KClcblx0ICogVXNhZ2UgaW4geW91ciBqcyBjb2RlOlxuXHQgKiA+IHRyYWsuYXR0ckV2ZW50LmNhbGwodGhpcyk7XG5cdCAqL1xuXHR2YXIgYXR0ckV2ZW50ID0gZnVuY3Rpb24oKSB7XG5cdFx0dmFyIF9vcHRpb25zID0gSlNPTi5wYXJzZSh0aGlzLmdldEF0dHJpYnV0ZSgnZGF0YS10cmFrJykpO1xuXHRcdGV2ZW50LmNhbGwodGhpcywgX29wdGlvbnMpO1xuXHR9O1xuXG5cblx0LyoqXG5cdCAqIEZ1bmN0aW9uIHRvIGNvbnZlcnQgd2lsZGNhcmRzIGludG8gcmVhbCB2YWx1ZXNcblx0ICogQHBhcmFtICBzdHJpbmcgc3RyXG5cdCAqIEByZXR1cm4gc3RyaW5nICAgICBUaGUgY29udmVydGVkIG91cHV0IGZyb20gc3RyXG5cdCAqL1xuXHR2YXIgd2lsZGNhcmQgPSBmdW5jdGlvbihzdHIpIHtcblx0XHR2YXIgb3V0cHV0O1xuXG5cdFx0c3dpdGNoKHN0cikge1xuXHRcdFx0Y2FzZSAncGFnZS50aXRsZSc6XG5cdFx0XHRcdG91dHB1dCA9IGRvY3VtZW50LnRpdGxlO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgJ3BhZ2UuaHJlZic6XG5cdFx0XHRcdG91dHB1dCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgJ2xpbmsuaHJlZic6XG5cdFx0XHRcdG91dHB1dCA9IHRoaXMuaHJlZjtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlICdsaW5rLnRpdGxlJzpcblx0XHRcdFx0b3V0cHV0ID0gdGhpcy50aXRsZTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlICdyZWZlcnJlcic6XG5cdFx0XHRcdG91dHB1dCA9IGRvY3VtZW50LnJlZmVycmVyID8gZG9jdW1lbnQucmVmZXJyZXIgOiAnTm8gcmVmZXJyZXInO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdG91dHB1dCA9IHN0cjtcblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXHRcdHJldHVybiBvdXRwdXQ7XG5cdH07XG5cblxuXHQvKipcblx0ICogZ2V0T3B0aW9uc1xuXHQgKiBHZXQgYWxsIHRoZSBvcHRpb25zXG5cdCAqL1xuXHR2YXIgZ2V0T3B0aW9ucyA9IGZ1bmN0aW9uIChvcHRzKSB7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRjYXRlZ29yeSAgICAgICA6IG9wdHMgJiYgb3B0cy5jYXRlZ29yeSAgICAgICB8fCAnJyxcblx0XHRcdFx0YWN0aW9uICAgICAgICAgOiBvcHRzICYmIG9wdHMuYWN0aW9uICAgICAgICAgfHwgJycsXG5cdFx0XHRcdGxhYmVsICAgICAgICAgIDogb3B0cyAmJiBvcHRzLmxhYmVsICAgICAgICAgIHx8ICcnLFxuXHRcdFx0XHR2YWx1ZSAgICAgICAgICA6IG9wdHMgJiYgb3B0cy52YWx1ZSAgICAgICAgICB8fCAwLFxuXHRcdFx0XHRub25JbnRlcmFjdGlvbiA6IG9wdHMgJiYgb3B0cy5ub25JbnRlcmFjdGlvbiB8fCBmYWxzZSxcblx0XHRcdFx0ZXZlbnROYW1lICAgICAgOiBvcHRzICYmIG9wdHMuZXZlbnROYW1lICAgICAgfHwgdW5kZWZpbmVkXG5cdFx0XHR9O1xuXHR9O1xuXG5cblx0LyoqXG5cdCAqIHRyYWsub3B0aW9uc1xuXHQgKiBUaGVzZSBhcmUgdGhlIGRlZmF1bHQgb3B0aW9ucyBmb3IgdHJhay5qc1xuXHQgKiBUbyBvdmVycmlkZSB0aGVtLCByZWFzc2lnbiB0aGVzZSB2YWx1ZXMgaW4geW91ciBjb2RlLCBzZWVcblx0ICogaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vbXJtYXJ0aW5lYXUvMjRhZTI1OWYzNzNlNmRiZGE2NmYgZm9yIGFuIGV4YW1wbGVcblx0ICogQHR5cGUge09iamVjdH1cblx0ICovXG5cdHZhciBzZXR0aW5ncyA9IHtcblx0XHRjbGVhbiAgICAgICAgICAgOiB0cnVlLCAvLyB0cmFrLm9wdGlvbnMuY2xlYW4gICAgID0gZmFsc2Vcblx0XHRkZWxpbWV0ZXIgICAgICAgOiAnXycsICAvLyB0cmFrLm9wdGlvbnMuZGVsaW1ldGVyID0gJy0nXG5cdFx0dHJhY2tUeXBlICAgICAgIDogJ2dhJywgLy8gdHJhay5vcHRpb25zLnRyYWNrVHlwZSA9ICdnYScgQXZhaWxhYmxlIG9wdGlvbnM6IGdhLCBfZ2FxICYgZ3RtXG5cdFx0YWRkaXRpb25hbFR5cGVzIDogdW5kZWZpbmVkLFxuXHRcdGRlYnVnICAgICAgICAgICA6IGZhbHNlXG5cdH07XG5cblxuXHR2YXIgc3RhcnQgPSBmdW5jdGlvbigpIHtcblx0XHR2YXIgdHJha0VsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtdHJha10nKTtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHRyYWtFbGVtZW50cy5sZW5ndGggOyBpKyspIHtcblx0XHRcdGlmICh0cmFrRWxlbWVudHNbaV0uYWRkRXZlbnRMaXN0ZW5lcikge1xuXHRcdFx0XHR0cmFrRWxlbWVudHNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBkYXRhQXR0ckV2ZW50KTtcblx0XHRcdH0gZWxzZSBpZiAodHJha0VsZW1lbnRzW2ldLmF0dGFjaEV2ZW50KSB7XG5cdFx0XHRcdHRyYWtFbGVtZW50c1tpXS5hdHRhY2hFdmVudCgnb25jbGljaycsIGRhdGFBdHRyRXZlbnQpO1xuXHRcdFx0fVxuXHRcdH1cblx0fTtcblxuXHRyZXR1cm4ge1xuXHRcdHN0YXJ0ICAgICA6IHN0YXJ0LFxuXHRcdGNsZWFuICAgICA6IGNsZWFuLFxuXHRcdGV2ZW50ICAgICA6IGV2ZW50LFxuXHRcdGF0dHJFdmVudCA6IGF0dHJFdmVudCxcblx0XHR3aWxkY2FyZCAgOiB3aWxkY2FyZCxcblx0XHRvcHRpb25zICAgOiBzZXR0aW5nc1xuXHR9O1xuXG59KSgpO1xuXG5cbi8vIENoZWNrIGZvciBBTUQvTW9kdWxlIHN1cHBvcnQsIG90aGVyd2lzZSBkZWZpbmUgdHJhayBhcyBhIGdsb2JhbCB2YXJpYWJsZS5cbmlmICh0eXBlb2YgZGVmaW5lICE9PSAndW5kZWZpbmVkJyAmJiBkZWZpbmUuYW1kKSB7XG5cdC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cblx0ZGVmaW5lIChmdW5jdGlvbigpIHtcblx0XHQndXNlIHN0cmljdCc7XG5cdFx0cmV0dXJuIHRyYWs7XG5cdH0pO1xufSBlbHNlIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykge1xuXHRtb2R1bGUuZXhwb3J0cyA9IHRyYWs7XG59IGVsc2Uge1xuXHR3aW5kb3cudHJhayA9IHRyYWs7XG59XG4iLCIvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICogVHJhdmVyc3R5OiBBIERPTSBjb2xsZWN0aW9uIG1hbmFnZW1lbnQgYW5kIHRyYXZlcnNhbCB1dGlsaXR5XG4gICogKGMpIFJvZCBWYWdnIChAcnZhZ2cpIDIwMTJcbiAgKiBodHRwczovL2dpdGh1Yi5jb20vcnZhZ2cvdHJhdmVyc3R5XG4gICogTGljZW5zZTogTUlUXG4gICovXG5cbihmdW5jdGlvbiAobmFtZSwgY29udGV4dCwgZGVmaW5pdGlvbikge1xuICBpZiAodHlwZW9mIG1vZHVsZSAhPSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cylcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGRlZmluaXRpb24oKVxuICBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcbiAgICBkZWZpbmUoZGVmaW5pdGlvbilcbiAgZWxzZVxuICAgIGNvbnRleHRbbmFtZV0gPSBkZWZpbml0aW9uKClcbn0pKCd0cmF2ZXJzdHknLCB0aGlzLCBmdW5jdGlvbiAoKSB7XG5cbiAgdmFyIGNvbnRleHQgPSB0aGlzXG4gICAgLCBvbGQgPSBjb250ZXh0LnRyYXZlcnN0eVxuICAgICwgZG9jID0gd2luZG93LmRvY3VtZW50XG4gICAgLCBodG1sID0gZG9jLmRvY3VtZW50RWxlbWVudFxuICAgICwgdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nXG4gICAgLCBBcCA9IEFycmF5LnByb3RvdHlwZVxuICAgICwgc2xpY2UgPSBBcC5zbGljZVxuICAgICAgLy8gZmVhdHVyZSB0ZXN0IHRvIGZpbmQgbmF0aXZlIG1hdGNoZXNTZWxlY3RvcigpXG4gICAgLCBtYXRjaGVzU2VsZWN0b3IgPSAoZnVuY3Rpb24gKGVsLCBwZngsIG5hbWUsIGksIG1zKSB7XG4gICAgICAgIHdoaWxlIChpIDwgcGZ4Lmxlbmd0aClcbiAgICAgICAgICBpZiAoZWxbbXMgPSBwZnhbaSsrXSArIG5hbWVdKVxuICAgICAgICAgICAgcmV0dXJuIG1zXG4gICAgICB9KGh0bWwsIFsgJ21zTScsICd3ZWJraXRNJywgJ21vek0nLCAnb00nLCAnbScgXSwgJ2F0Y2hlc1NlbGVjdG9yJywgMCkpXG5cbiAgICAsIEtmYWxzZSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGZhbHNlIH1cblxuICAgICwgaXNOdW1iZXIgPSBmdW5jdGlvbiAobykge1xuICAgICAgICByZXR1cm4gdG9TdHJpbmcuY2FsbChvKSA9PT0gJ1tvYmplY3QgTnVtYmVyXSdcbiAgICAgIH1cblxuICAgICwgaXNTdHJpbmcgPSBmdW5jdGlvbiAobykge1xuICAgICAgICByZXR1cm4gdG9TdHJpbmcuY2FsbChvKSA9PT0gJ1tvYmplY3QgU3RyaW5nXSdcbiAgICAgIH1cblxuICAgICwgaXNGdW5jdGlvbiA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICAgIHJldHVybiB0b1N0cmluZy5jYWxsKG8pID09PSAnW29iamVjdCBGdW5jdGlvbl0nXG4gICAgICB9XG5cbiAgICAsIGlzVW5kZWZpbmVkID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgcmV0dXJuIG8gPT09IHZvaWQgMFxuICAgICAgfVxuXG4gICAgLCBpc0VsZW1lbnQgPSBmdW5jdGlvbiAobykge1xuICAgICAgICByZXR1cm4gbyAmJiBvLm5vZGVUeXBlID09PSAxXG4gICAgICB9XG5cbiAgICAgIC8vIGZpZ3VyZSBvdXQgd2hpY2ggYXJndW1lbnQsIGlmIGFueSwgaXMgb3VyICdpbmRleCdcbiAgICAsIGdldEluZGV4ID0gZnVuY3Rpb24gKHNlbGVjdG9yLCBpbmRleCkge1xuICAgICAgICByZXR1cm4gaXNVbmRlZmluZWQoc2VsZWN0b3IpICYmICFpc051bWJlcihpbmRleCkgPyAwIDpcbiAgICAgICAgICBpc051bWJlcihzZWxlY3RvcikgPyBzZWxlY3RvciA6IGlzTnVtYmVyKGluZGV4KSA/IGluZGV4IDogbnVsbFxuICAgICAgfVxuXG4gICAgICAvLyBmaWd1cmUgb3V0IHdoaWNoIGFyZ3VtZW50LCBpZiBhbnksIGlzIG91ciAnc2VsZWN0b3InXG4gICAgLCBnZXRTZWxlY3RvciA9IGZ1bmN0aW9uIChzZWxlY3Rvcikge1xuICAgICAgICByZXR1cm4gaXNTdHJpbmcoc2VsZWN0b3IpID8gc2VsZWN0b3IgOiAnKidcbiAgICAgIH1cblxuICAgICwgbmF0aXZlU2VsZWN0b3JGaW5kID0gZnVuY3Rpb24gKHNlbGVjdG9yLCBlbCkge1xuICAgICAgICByZXR1cm4gc2xpY2UuY2FsbChlbC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKSwgMClcbiAgICAgIH1cblxuICAgICwgbmF0aXZlU2VsZWN0b3JNYXRjaGVzID0gZnVuY3Rpb24gKHNlbGVjdG9yLCBlbCkge1xuICAgICAgICByZXR1cm4gc2VsZWN0b3IgPT09ICcqJyB8fCBlbFttYXRjaGVzU2VsZWN0b3JdKHNlbGVjdG9yKVxuICAgICAgfVxuXG4gICAgLCBzZWxlY3RvckZpbmQgPSBuYXRpdmVTZWxlY3RvckZpbmRcblxuICAgICwgc2VsZWN0b3JNYXRjaGVzID0gbmF0aXZlU2VsZWN0b3JNYXRjaGVzXG5cbiAgICAgIC8vIHVzZWQgaW4gdGhlIGNhc2Ugd2hlcmUgb3VyIHNlbGVjdG9yIGVuZ2luZSBkb2VzIG91dC1vZi1vcmRlciBlbGVtZW50IHJldHVybnMgZm9yXG4gICAgICAvLyBncm91cGVkIHNlbGVjdG9ycywgZS5nLiAnLmNsYXNzLCB0YWcnLCB3ZSBuZWVkIG91ciBlbGVtZW50cyBpbiBkb2N1bWVudC1vcmRlclxuICAgICAgLy8gc28gd2UgZG8gaXQgb3Vyc2VsdmVzIGlmIG5lZWQgYmVcbiAgICAsIGNyZWF0ZVVub3JkZXJlZEVuZ2luZVNlbGVjdG9yRmluZCA9IGZ1bmN0aW9uKGVuZ2luZVNlbGVjdCwgc2VsZWN0b3JNYXRjaGVzKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoc2VsZWN0b3IsIGVsKSB7XG4gICAgICAgICAgaWYgKC8sLy50ZXN0KHNlbGVjdG9yKSkge1xuICAgICAgICAgICAgdmFyIHJldCA9IFtdLCBpID0gLTEsIGVscyA9IGVsLmdldEVsZW1lbnRzQnlUYWdOYW1lKCcqJylcbiAgICAgICAgICAgIHdoaWxlICgrK2kgPCBlbHMubGVuZ3RoKVxuICAgICAgICAgICAgICBpZiAoaXNFbGVtZW50KGVsc1tpXSkgJiYgc2VsZWN0b3JNYXRjaGVzKHNlbGVjdG9yLCBlbHNbaV0pKVxuICAgICAgICAgICAgICAgIHJldC5wdXNoKGVsc1tpXSlcbiAgICAgICAgICAgIHJldHVybiByZXRcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGVuZ2luZVNlbGVjdChzZWxlY3RvciwgZWwpXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gaXMgJ2VsZW1lbnQnIHVuZGVybmVhdGggJ2NvbnRhaW5lcicgc29tZXdoZXJlXG4gICAgLCBpc0FuY2VzdG9yID0gJ2NvbXBhcmVEb2N1bWVudFBvc2l0aW9uJyBpbiBodG1sXG4gICAgICAgID8gZnVuY3Rpb24gKGVsZW1lbnQsIGNvbnRhaW5lcikge1xuICAgICAgICAgICAgcmV0dXJuIChjb250YWluZXIuY29tcGFyZURvY3VtZW50UG9zaXRpb24oZWxlbWVudCkgJiAxNikgPT0gMTZcbiAgICAgICAgICB9XG4gICAgICAgIDogJ2NvbnRhaW5zJyBpbiBodG1sXG4gICAgICAgICAgPyBmdW5jdGlvbiAoZWxlbWVudCwgY29udGFpbmVyKSB7XG4gICAgICAgICAgICAgIGNvbnRhaW5lciA9IGNvbnRhaW5lci5ub2RlVHlwZSA9PT0gOSB8fCBjb250YWluZXIgPT0gd2luZG93ID8gaHRtbCA6IGNvbnRhaW5lclxuICAgICAgICAgICAgICByZXR1cm4gY29udGFpbmVyICE9PSBlbGVtZW50ICYmIGNvbnRhaW5lci5jb250YWlucyhlbGVtZW50KVxuICAgICAgICAgICAgfVxuICAgICAgICAgIDogZnVuY3Rpb24gKGVsZW1lbnQsIGNvbnRhaW5lcikgeyAvLyBvbGQgc21lbGx5IGJyb3dzZXJcbiAgICAgICAgICAgICAgd2hpbGUgKGVsZW1lbnQgPSBlbGVtZW50LnBhcmVudE5vZGUpXG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQgPT09IGNvbnRhaW5lcilcbiAgICAgICAgICAgICAgICAgIHJldHVybiAxXG4gICAgICAgICAgICAgIHJldHVybiAwXG4gICAgICAgICAgICB9XG5cbiAgICAgIC8vIHJldHVybiBhbiBhcnJheSBjb250YWluaW5nIG9ubHkgdW5pcXVlIGVsZW1lbnRzXG4gICAgLCB1bmlxdWUgPSBmdW5jdGlvbiAoYXIpIHtcbiAgICAgICAgdmFyIGEgPSBbXSwgaSA9IC0xLCBqLCBoYXNcbiAgICAgICAgd2hpbGUgKCsraSA8IGFyLmxlbmd0aCkge1xuICAgICAgICAgIGogPSAtMVxuICAgICAgICAgIGhhcyA9IGZhbHNlXG4gICAgICAgICAgd2hpbGUgKCsraiA8IGEubGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAoYVtqXSA9PT0gYXJbaV0pIHtcbiAgICAgICAgICAgICAgaGFzID0gdHJ1ZVxuICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIWhhcylcbiAgICAgICAgICAgIGEucHVzaChhcltpXSlcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYVxuICAgICAgfVxuXG4gICAgICAvLyBmb3IgZWFjaCBlbGVtZW50IG9mICdlbHMnIGV4ZWN1dGUgJ2ZuJyB0byBnZXQgYW4gYXJyYXkgb2YgZWxlbWVudHMgdG8gY29sbGVjdFxuICAgICwgY29sbGVjdCA9IGZ1bmN0aW9uIChlbHMsIGZuKSB7XG4gICAgICAgIHZhciByZXQgPSBbXSwgcmVzLCBpID0gMCwgaiwgbCA9IGVscy5sZW5ndGgsIGwyXG4gICAgICAgIHdoaWxlIChpIDwgbCkge1xuICAgICAgICAgIGogPSAwXG4gICAgICAgICAgbDIgPSAocmVzID0gZm4oZWxzW2ldLCBpKyspKS5sZW5ndGhcbiAgICAgICAgICB3aGlsZSAoaiA8IGwyKVxuICAgICAgICAgICAgcmV0LnB1c2gocmVzW2orK10pXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJldFxuICAgICAgfVxuXG4gICAgIC8vIGdlbmVyaWMgRE9NIG5hdmlnYXRvciB0byBtb3ZlIG11bHRpcGxlIGVsZW1lbnRzIGFyb3VuZCB0aGUgRE9NXG4gICAsIG1vdmUgPSBmdW5jdGlvbiAoZWxzLCBtZXRob2QsIHNlbGVjdG9yLCBpbmRleCwgZmlsdGVyRm4pIHtcbiAgICAgICAgaW5kZXggPSBnZXRJbmRleChzZWxlY3RvciwgaW5kZXgpXG4gICAgICAgIHNlbGVjdG9yID0gZ2V0U2VsZWN0b3Ioc2VsZWN0b3IpXG4gICAgICAgIHJldHVybiBjb2xsZWN0KGVsc1xuICAgICAgICAgICwgZnVuY3Rpb24gKGVsLCBlbGluZCkge1xuICAgICAgICAgICAgICB2YXIgaSA9IGluZGV4IHx8IDAsIHJldCA9IFtdXG4gICAgICAgICAgICAgIGlmICghZmlsdGVyRm4pXG4gICAgICAgICAgICAgICAgZWwgPSBlbFttZXRob2RdXG4gICAgICAgICAgICAgIHdoaWxlIChlbCAmJiAoaW5kZXggPT09IG51bGwgfHwgaSA+PSAwKSkge1xuICAgICAgICAgICAgICAgIC8vIGlnbm9yZSBub24tZWxlbWVudHMsIG9ubHkgY29uc2lkZXIgc2VsZWN0b3ItbWF0Y2hpbmcgZWxlbWVudHNcbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgYm90aCB0aGUgaW5kZXggYW5kIG5vLWluZGV4IChzZWxlY3Rvci1vbmx5KSBjYXNlc1xuICAgICAgICAgICAgICAgIGlmIChpc0VsZW1lbnQoZWwpXG4gICAgICAgICAgICAgICAgICAgICYmICghZmlsdGVyRm4gfHwgZmlsdGVyRm4gPT09IHRydWUgfHwgZmlsdGVyRm4oZWwsIGVsaW5kKSlcbiAgICAgICAgICAgICAgICAgICAgJiYgc2VsZWN0b3JNYXRjaGVzKHNlbGVjdG9yLCBlbClcbiAgICAgICAgICAgICAgICAgICAgJiYgKGluZGV4ID09PSBudWxsIHx8IGktLSA9PT0gMCkpIHtcbiAgICAgICAgICAgICAgICAgIC8vIHRoaXMgY29uY2F0IHZzIHB1c2ggaXMgdG8gbWFrZSBzdXJlIHdlIGFkZCBlbGVtZW50cyB0byB0aGUgcmVzdWx0IGFycmF5XG4gICAgICAgICAgICAgICAgICAvLyBpbiByZXZlcnNlIG9yZGVyIHdoZW4gZG9pbmcgYSBwcmV2aW91cyhzZWxlY3RvcikgYW5kIHVwKHNlbGVjdG9yKVxuICAgICAgICAgICAgICAgICAgaW5kZXggPT09IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAmJiBtZXRob2QgIT0gJ25leHRTaWJsaW5nJ1xuICAgICAgICAgICAgICAgICAgICAgICYmIG1ldGhvZCAhPSAncGFyZW50Tm9kZSdcbiAgICAgICAgICAgICAgICAgICAgPyByZXQudW5zaGlmdChlbClcbiAgICAgICAgICAgICAgICAgICAgOiByZXQucHVzaChlbClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWwgPSBlbFttZXRob2RdXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIHJldFxuICAgICAgICAgICAgfVxuICAgICAgICApXG4gICAgICB9XG5cbiAgICAgIC8vIGdpdmVuIGFuIGluZGV4ICYgbGVuZ3RoLCByZXR1cm4gYSAnZml4ZWQnIGluZGV4LCBmaXhlcyBub24tbnVtYmVycyAmIG5lYXRpdmUgaW5kZXhlc1xuICAgICwgZXFJbmRleCA9IGZ1bmN0aW9uIChsZW5ndGgsIGluZGV4LCBkZWYpIHtcbiAgICAgICAgaWYgKGluZGV4IDwgMClcbiAgICAgICAgICBpbmRleCA9IGxlbmd0aCArIGluZGV4XG4gICAgICAgIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPj0gbGVuZ3RoKVxuICAgICAgICAgIHJldHVybiBudWxsXG4gICAgICAgIHJldHVybiAhaW5kZXggJiYgaW5kZXggIT09IDAgPyBkZWYgOiBpbmRleFxuICAgICAgfVxuXG4gICAgICAvLyBjb2xsZWN0IGVsZW1lbnRzIG9mIGFuIGFycmF5IHRoYXQgbWF0Y2ggYSBmaWx0ZXIgZnVuY3Rpb25cbiAgICAsIGZpbHRlciA9IGZ1bmN0aW9uIChlbHMsIGZuKSB7XG4gICAgICAgIHZhciBhcnIgPSBbXSwgaSA9IDAsIGwgPSBlbHMubGVuZ3RoXG4gICAgICAgIGZvciAoOyBpIDwgbDsgaSsrKVxuICAgICAgICAgIGlmIChmbihlbHNbaV0sIGkpKVxuICAgICAgICAgICAgYXJyLnB1c2goZWxzW2ldKVxuICAgICAgICByZXR1cm4gYXJyXG4gICAgICB9XG5cbiAgICAgIC8vIGNyZWF0ZSBhIGZpbHRlciBmdW5jdGlvbiwgZm9yIHVzZSBieSBmaWx0ZXIoKSwgaXMoKSAmIG5vdCgpXG4gICAgICAvLyBhbGxvd3MgdGhlIGFyZ3VtZW50IHRvIGJlIGFuIGVsZW1lbnQsIGEgZnVuY3Rpb24gb3IgYSBzZWxlY3RvclxuICAgICwgZmlsdGVyRm4gPSBmdW5jdGlvbiAoc2xmbikge1xuICAgICAgICB2YXIgdG9cbiAgICAgICAgcmV0dXJuIGlzRWxlbWVudChzbGZuKVxuICAgICAgICAgID8gZnVuY3Rpb24gKGVsKSB7IHJldHVybiBlbCA9PT0gc2xmbiB9XG4gICAgICAgICAgOiAodG8gPSB0eXBlb2Ygc2xmbikgPT0gJ2Z1bmN0aW9uJ1xuICAgICAgICAgICAgPyBmdW5jdGlvbiAoZWwsIGkpIHsgcmV0dXJuIHNsZm4uY2FsbChlbCwgaSkgfVxuICAgICAgICAgICAgOiB0byA9PSAnc3RyaW5nJyAmJiBzbGZuLmxlbmd0aFxuICAgICAgICAgICAgICA/IGZ1bmN0aW9uIChlbCkgeyByZXR1cm4gc2VsZWN0b3JNYXRjaGVzKHNsZm4sIGVsKSB9XG4gICAgICAgICAgICAgIDogS2ZhbHNlXG4gICAgICB9XG5cbiAgICAgIC8vIGZuID0gIWZuXG4gICAgLCBpbnYgPSBmdW5jdGlvbiAoZm4pIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gIWZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgLCB0cmF2ZXJzdHkgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBUKGVscykge1xuICAgICAgICAgIHRoaXMubGVuZ3RoID0gMFxuICAgICAgICAgIGlmIChlbHMpIHtcbiAgICAgICAgICAgIGVscyA9IHVuaXF1ZSghZWxzLm5vZGVUeXBlICYmICFpc1VuZGVmaW5lZChlbHMubGVuZ3RoKSA/IGVscyA6IFsgZWxzIF0pXG4gICAgICAgICAgICB2YXIgaSA9IHRoaXMubGVuZ3RoID0gZWxzLmxlbmd0aFxuICAgICAgICAgICAgd2hpbGUgKGktLSlcbiAgICAgICAgICAgICAgdGhpc1tpXSA9IGVsc1tpXVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIFQucHJvdG90eXBlID0ge1xuICAgICAgICAgICAgZG93bjogZnVuY3Rpb24gKHNlbGVjdG9yLCBpbmRleCkge1xuICAgICAgICAgICAgICBpbmRleCA9IGdldEluZGV4KHNlbGVjdG9yLCBpbmRleClcbiAgICAgICAgICAgICAgc2VsZWN0b3IgPSBnZXRTZWxlY3RvcihzZWxlY3RvcilcbiAgICAgICAgICAgICAgcmV0dXJuIHRyYXZlcnN0eShjb2xsZWN0KHRoaXNcbiAgICAgICAgICAgICAgICAsIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IHNlbGVjdG9yRmluZChzZWxlY3RvciwgZWwpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpbmRleCA9PT0gbnVsbCA/IGYgOiAoWyBmW2luZGV4XSBdIHx8IFtdKVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICkpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAsIHVwOiBmdW5jdGlvbiAoc2VsZWN0b3IsIGluZGV4KSB7XG4gICAgICAgICAgICAgIHJldHVybiB0cmF2ZXJzdHkobW92ZSh0aGlzLCAncGFyZW50Tm9kZScsIHNlbGVjdG9yLCBpbmRleCkpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAsIHBhcmVudHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIFQucHJvdG90eXBlLnVwLmFwcGx5KHRoaXMsIGFyZ3VtZW50cy5sZW5ndGggPyBhcmd1bWVudHMgOiBbICcqJyBdKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgLCBjbG9zZXN0OiBmdW5jdGlvbiAoc2VsZWN0b3IsIGluZGV4KSB7XG4gICAgICAgICAgICAgIGlmIChpc051bWJlcihzZWxlY3RvcikpIHtcbiAgICAgICAgICAgICAgICBpbmRleCA9IHNlbGVjdG9yXG4gICAgICAgICAgICAgICAgc2VsZWN0b3IgPSAnKidcbiAgICAgICAgICAgICAgfSBlbHNlIGlmICghaXNTdHJpbmcoc2VsZWN0b3IpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRyYXZlcnN0eShbXSlcbiAgICAgICAgICAgICAgfSBlbHNlIGlmICghaXNOdW1iZXIoaW5kZXgpKSB7XG4gICAgICAgICAgICAgICAgaW5kZXggPSAwXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIHRyYXZlcnN0eShtb3ZlKHRoaXMsICdwYXJlbnROb2RlJywgc2VsZWN0b3IsIGluZGV4LCB0cnVlKSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICwgcHJldmlvdXM6IGZ1bmN0aW9uIChzZWxlY3RvciwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRyYXZlcnN0eShtb3ZlKHRoaXMsICdwcmV2aW91c1NpYmxpbmcnLCBzZWxlY3RvciwgaW5kZXgpKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgLCBuZXh0OiBmdW5jdGlvbiAoc2VsZWN0b3IsIGluZGV4KSB7XG4gICAgICAgICAgICAgIHJldHVybiB0cmF2ZXJzdHkobW92ZSh0aGlzLCAnbmV4dFNpYmxpbmcnLCBzZWxlY3RvciwgaW5kZXgpKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgLCBzaWJsaW5nczogZnVuY3Rpb24gKHNlbGVjdG9yLCBpbmRleCkge1xuICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXNcbiAgICAgICAgICAgICAgICAsIGFyciA9IHNsaWNlLmNhbGwodGhpcywgMClcbiAgICAgICAgICAgICAgICAsIGkgPSAwLCBsID0gYXJyLmxlbmd0aFxuXG4gICAgICAgICAgICAgIGZvciAoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgYXJyW2ldID0gYXJyW2ldLnBhcmVudE5vZGUuZmlyc3RDaGlsZFxuICAgICAgICAgICAgICAgIHdoaWxlICghaXNFbGVtZW50KGFycltpXSkpXG4gICAgICAgICAgICAgICAgICBhcnJbaV0gPSBhcnJbaV0ubmV4dFNpYmxpbmdcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChpc1VuZGVmaW5lZChzZWxlY3RvcikpXG4gICAgICAgICAgICAgICAgc2VsZWN0b3IgPSAnKidcblxuICAgICAgICAgICAgICByZXR1cm4gdHJhdmVyc3R5KG1vdmUoYXJyLCAnbmV4dFNpYmxpbmcnLCBzZWxlY3RvciB8fCAnKicsIGluZGV4XG4gICAgICAgICAgICAgICAgICAgICwgZnVuY3Rpb24gKGVsLCBpKSB7IHJldHVybiBlbCAhPT0gc2VsZltpXSB9IC8vIGZpbHRlclxuICAgICAgICAgICAgICAgICAgKSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICwgY2hpbGRyZW46IGZ1bmN0aW9uIChzZWxlY3RvciwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRyYXZlcnN0eShtb3ZlKFQucHJvdG90eXBlLmRvd24uY2FsbCh0aGlzKSwgJ25leHRTaWJsaW5nJywgc2VsZWN0b3IgfHwgJyonLCBpbmRleCwgdHJ1ZSkpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAsIGZpcnN0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBULnByb3RvdHlwZS5lcS5jYWxsKHRoaXMsIDApXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAsIGxhc3Q6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIFQucHJvdG90eXBlLmVxLmNhbGwodGhpcywgLTEpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAsIGVxOiBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRyYXZlcnN0eSh0aGlzLmdldChpbmRleCkpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAsIGdldDogZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzW2VxSW5kZXgodGhpcy5sZW5ndGgsIGluZGV4LCAwKV1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYSBjcmF6eSBtYW4gd3JvdGUgdGhpcywgZG9uJ3QgdHJ5IHRvIHVuZGVyc3RhbmQgaXQsIHNlZSB0aGUgdGVzdHNcbiAgICAgICAgICAsIHNsaWNlOiBmdW5jdGlvbiAoc3RhcnQsIGVuZCkge1xuICAgICAgICAgICAgICB2YXIgZSA9IGVuZCwgbCA9IHRoaXMubGVuZ3RoLCBhcnIgPSBbXVxuICAgICAgICAgICAgICBzdGFydCA9IGVxSW5kZXgobCwgTWF0aC5tYXgoLXRoaXMubGVuZ3RoLCBzdGFydCksIDApXG4gICAgICAgICAgICAgIGUgPSBlcUluZGV4KGVuZCA8IDAgPyBsIDogbCArIDEsIGVuZCwgbClcbiAgICAgICAgICAgICAgZW5kID0gZSA9PT0gbnVsbCB8fCBlID4gbCA/IGVuZCA8IDAgPyAwIDogbCA6IGVcbiAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0ICE9PSBudWxsICYmIHN0YXJ0IDwgZW5kKVxuICAgICAgICAgICAgICAgIGFyci5wdXNoKHRoaXNbc3RhcnQrK10pXG4gICAgICAgICAgICAgIHJldHVybiB0cmF2ZXJzdHkoYXJyKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgLCBmaWx0ZXI6IGZ1bmN0aW9uIChzbGZuKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0cmF2ZXJzdHkoZmlsdGVyKHRoaXMsIGZpbHRlckZuKHNsZm4pKSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICwgbm90OiBmdW5jdGlvbiAoc2xmbikge1xuICAgICAgICAgICAgICByZXR1cm4gdHJhdmVyc3R5KGZpbHRlcih0aGlzLCBpbnYoZmlsdGVyRm4oc2xmbikpKSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gc2ltaWxhciB0byBmaWx0ZXIoKSBidXQgY2FyZXMgYWJvdXQgZGVzY2VuZGVudCBlbGVtZW50c1xuICAgICAgICAgICwgaGFzOiBmdW5jdGlvbiAoc2xlbCkge1xuICAgICAgICAgICAgICByZXR1cm4gdHJhdmVyc3R5KGZpbHRlcihcbiAgICAgICAgICAgICAgICAgIHRoaXNcbiAgICAgICAgICAgICAgICAsIGlzRWxlbWVudChzbGVsKVxuICAgICAgICAgICAgICAgICAgICA/IGZ1bmN0aW9uIChlbCkgeyByZXR1cm4gaXNBbmNlc3RvcihzbGVsLCBlbCkgfVxuICAgICAgICAgICAgICAgICAgICA6IHR5cGVvZiBzbGVsID09ICdzdHJpbmcnICYmIHNsZWwubGVuZ3RoXG4gICAgICAgICAgICAgICAgICAgICAgPyBmdW5jdGlvbiAoZWwpIHsgcmV0dXJuIHNlbGVjdG9yRmluZChzbGVsLCBlbCkubGVuZ3RoIH0gLy9UT0RPOiBwZXJmb3JtYW5jZVxuICAgICAgICAgICAgICAgICAgICAgIDogS2ZhbHNlXG4gICAgICAgICAgICAgICkpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIHNhbWUgYXMgZmlsdGVyKCkgYnV0IHJldHVybiBhIGJvb2xlYW4gc28gcXVpY2stcmV0dXJuIGFmdGVyIGZpcnN0IHN1Y2Nlc3NmdWwgZmluZFxuICAgICAgICAgICwgaXM6IGZ1bmN0aW9uIChzbGZuKSB7XG4gICAgICAgICAgICAgIHZhciBpID0gMCwgbCA9IHRoaXMubGVuZ3RoXG4gICAgICAgICAgICAgICAgLCBmbiA9IGZpbHRlckZuKHNsZm4pXG4gICAgICAgICAgICAgIGZvciAoOyBpIDwgbDsgaSsrKVxuICAgICAgICAgICAgICAgIGlmIChmbih0aGlzW2ldLCBpKSlcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgLCB0b0FycmF5OiBmdW5jdGlvbiAoKSB7IHJldHVybiBBcC5zbGljZS5jYWxsKHRoaXMpIH1cblxuICAgICAgICAgICwgc2l6ZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5sZW5ndGggfVxuXG4gICAgICAgICAgLCBlYWNoOiBmdW5jdGlvbiAoZm4sIGN0eCkge1xuICAgICAgICAgICAgICB2YXIgaSA9IDAsIGwgPSB0aGlzLmxlbmd0aFxuICAgICAgICAgICAgICBmb3IgKDsgaSA8IGw7IGkrKylcbiAgICAgICAgICAgICAgICBmbi5jYWxsKGN0eCB8fCB0aGlzW2ldLCB0aGlzW2ldLCBpLCB0aGlzKVxuICAgICAgICAgICAgICByZXR1cm4gdGhpc1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBxdWFjayBsaWtlIGEgZHVjayAoQXJyYXkpXG4gICAgICAgICAgLCBwdXNoOiBBcC5wdXNoXG4gICAgICAgICAgLCBzb3J0OiBBcC5zb3J0XG4gICAgICAgICAgLCBzcGxpY2U6IEFwLnNwbGljZVxuICAgICAgICB9XG5cbiAgICAgICAgVC5wcm90b3R5cGUucHJldiA9IFQucHJvdG90eXBlLnByZXZpb3VzXG5cbiAgICAgICAgZnVuY3Rpb24gdChlbHMpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFQoaXNTdHJpbmcoZWxzKSA/IHNlbGVjdG9yRmluZChlbHMsIGRvYykgOiBlbHMpXG4gICAgICAgIH1cblxuICAgICAgICAvLyBleHRlbmQgdHJhdmVyc3R5IGZ1bmN0aW9uYWxpdHkgd2l0aCBjdXN0b20gbWV0aG9kc1xuICAgICAgICB0LmF1ZyA9IGZ1bmN0aW9uIChtZXRob2RzKSB7XG4gICAgICAgICAgdmFyIGtleSwgbWV0aG9kXG4gICAgICAgICAgZm9yIChrZXkgaW4gbWV0aG9kcykge1xuICAgICAgICAgICAgbWV0aG9kID0gbWV0aG9kc1trZXldXG4gICAgICAgICAgICBpZiAodHlwZW9mIG1ldGhvZCA9PSAnZnVuY3Rpb24nKVxuICAgICAgICAgICAgICBULnByb3RvdHlwZVtrZXldID0gbWV0aG9kXG4gICAgICAgICAgfVxuICAgICAgICB9XG5cblxuICAgICAgICB0LnNldFNlbGVjdG9yRW5naW5lID0gZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgICAvLyBmZWF0dXJlIHRlc3RpbmcgdGhlIHNlbGVjdG9yIGVuZ2luZSBsaWtlIGEgYm9zc1xuICAgICAgICAgIHZhciBzcywgciwgYSwgX3NlbGVjdG9yTWF0Y2hlcywgX3NlbGVjdG9yRmluZFxuICAgICAgICAgICAgLCBlID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ3AnKVxuICAgICAgICAgICAgLCBzZWxlY3QgPSBzLnNlbGVjdCB8fCBzLnNlbCB8fCBzXG5cbiAgICAgICAgICBlLmlubmVySFRNTCA9ICc8YS8+PGkvPjxiLz4nXG4gICAgICAgICAgYSA9IGUuZmlyc3RDaGlsZFxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBZTyEgSSBIRUFSRCBZT1UgTElLRUQgTkVTVEVEIFRFUk5BUlkgT1BFUkFUT1JTIFNPIEkgQ09PS0VEIFNPTUUgVVAgRk9SIFlPVSFcbiAgICAgICAgICAgIC8vIChvbmUgZGF5IEkgbWlnaHQgbG9vcCB0aGlzLi4uKVxuXG4gICAgICAgICAgICAvLyBjaGVjayB0byBzZWUgaG93IHdlIGRvIGEgbWF0Y2hlc1NlbGVjdG9yXG4gICAgICAgICAgICBfc2VsZWN0b3JNYXRjaGVzID0gaXNGdW5jdGlvbihzLm1hdGNoaW5nKVxuICAgICAgICAgICAgICA/IGZ1bmN0aW9uIChzZWxlY3RvciwgZWwpIHsgcmV0dXJuIHMubWF0Y2hpbmcoW2VsXSwgc2VsZWN0b3IpLmxlbmd0aCA+IDAgfVxuICAgICAgICAgICAgICA6IGlzRnVuY3Rpb24ocy5pcylcbiAgICAgICAgICAgICAgICA/IGZ1bmN0aW9uIChzZWxlY3RvciwgZWwpIHsgcmV0dXJuIHMuaXMoZWwsIHNlbGVjdG9yKSB9XG4gICAgICAgICAgICAgICAgOiBpc0Z1bmN0aW9uKHMubWF0Y2hlc1NlbGVjdG9yKVxuICAgICAgICAgICAgICAgICAgPyBmdW5jdGlvbiAoc2VsZWN0b3IsIGVsKSB7IHJldHVybiBzLm1hdGNoZXNTZWxlY3RvcihlbCwgc2VsZWN0b3IpIH1cbiAgICAgICAgICAgICAgICAgIDogaXNGdW5jdGlvbihzLm1hdGNoKVxuICAgICAgICAgICAgICAgICAgICA/IGZ1bmN0aW9uIChzZWxlY3RvciwgZWwpIHsgcmV0dXJuIHMubWF0Y2goZWwsIHNlbGVjdG9yKSB9XG4gICAgICAgICAgICAgICAgICAgIDogaXNGdW5jdGlvbihzLm1hdGNoZXMpXG4gICAgICAgICAgICAgICAgICAgICAgPyBmdW5jdGlvbiAoc2VsZWN0b3IsIGVsKSB7IHJldHVybiBzLm1hdGNoZXMoZWwsIHNlbGVjdG9yKSB9XG4gICAgICAgICAgICAgICAgICAgICAgOiBudWxsXG5cbiAgICAgICAgICAgIGlmICghX3NlbGVjdG9yTWF0Y2hlcykge1xuICAgICAgICAgICAgICAvLyBwZXJoYXBzIGl0J3MgYW4gc2VsZWN0b3IoeCkuaXMoeSkgdHlwZSBzZWxlY3Rvcj9cbiAgICAgICAgICAgICAgc3MgPSBzKCdhJywgZSlcbiAgICAgICAgICAgICAgX3NlbGVjdG9yTWF0Y2hlcyA9IGlzRnVuY3Rpb24oc3MuX2lzKVxuICAgICAgICAgICAgICAgID8gZnVuY3Rpb24gKHNlbGVjdG9yLCBlbCkgeyByZXR1cm4gcyhlbCkuX2lzKHNlbGVjdG9yKSB9IC8vIG9yaWdpbmFsIC5pcygpLCByZXBsYWNlZCBieSBFbmRlciBicmlkZ2VcbiAgICAgICAgICAgICAgICA6IGlzRnVuY3Rpb24oc3MubWF0Y2hpbmcpXG4gICAgICAgICAgICAgICAgICA/IGZ1bmN0aW9uIChzZWxlY3RvciwgZWwpIHsgcmV0dXJuIHMoZWwpLm1hdGNoaW5nKHNlbGVjdG9yKS5sZW5ndGggPiAwIH1cbiAgICAgICAgICAgICAgICAgIDogaXNGdW5jdGlvbihzcy5pcykgJiYgIXNzLmlzLl9faWdub3JlXG4gICAgICAgICAgICAgICAgICAgID8gZnVuY3Rpb24gKHNlbGVjdG9yLCBlbCkgeyByZXR1cm4gcyhlbCkuaXMoc2VsZWN0b3IpIH1cbiAgICAgICAgICAgICAgICAgICAgICA6IGlzRnVuY3Rpb24oc3MubWF0Y2hlc1NlbGVjdG9yKVxuICAgICAgICAgICAgICAgICAgICAgICAgPyBmdW5jdGlvbiAoc2VsZWN0b3IsIGVsKSB7IHJldHVybiBzKGVsKS5tYXRjaGVzU2VsZWN0b3Ioc2VsZWN0b3IpIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIDogaXNGdW5jdGlvbihzcy5tYXRjaClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPyBmdW5jdGlvbiAoc2VsZWN0b3IsIGVsKSB7IHJldHVybiBzKGVsKS5tYXRjaChzZWxlY3RvcikgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICA6IGlzRnVuY3Rpb24oc3MubWF0Y2hlcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGZ1bmN0aW9uIChzZWxlY3RvciwgZWwpIHsgcmV0dXJuIHMoZWwpLm1hdGNoZXMoc2VsZWN0b3IpIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IG51bGxcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFfc2VsZWN0b3JNYXRjaGVzKVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVHJhdmVyc3R5OiBjb3VsZG5cXCd0IGZpbmQgc2VsZWN0b3IgZW5naW5lXFwncyBgbWF0Y2hlc1NlbGVjdG9yYCcpXG5cbiAgICAgICAgICAgIC8vIHZlcmlmeSB0aGF0IHdlIGhhdmUgYSB3b3JraW5nIGBtYXRjaGVzU2VsZWN0b3JgXG4gICAgICAgICAgICBpZiAoX3NlbGVjdG9yTWF0Y2hlcygneCx5JywgZSkgfHwgIV9zZWxlY3Rvck1hdGNoZXMoJ2EscCcsIGUpKVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVHJhdmVyc3R5OiBjb3VsZG5cXCd0IG1ha2Ugc2VsZWN0b3IgZW5naW5lXFwncyBgbWF0Y2hlc1NlbGVjdG9yYCB3b3JrJylcblxuICAgICAgICAgICAgLy8gYmFzaWMgc2VsZWN0XG4gICAgICAgICAgICBpZiAoKHIgPSBzZWxlY3QoJ2IsYScsIGUpKS5sZW5ndGggIT09IDIpXG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVHJhdmVyc3R5OiBkb25cXCd0IGtub3cgaG93IHRvIHVzZSB0aGlzIHNlbGVjdG9yIGVuZ2luZScpXG5cbiAgICAgICAgICAgIC8vIGNoZWNrIHRvIHNlZSBpZiB0aGUgc2VsZWN0b3IgZW5naW5lIGhhcyBnaXZlbiB1cyB0aGUgcmVzdWx0cyBpbiBkb2N1bWVudC1vcmRlclxuICAgICAgICAgICAgLy8gYW5kIGlmIG5vdCwgd29yayBhcm91bmQgaXRcbiAgICAgICAgICAgIF9zZWxlY3RvckZpbmQgPSByWzBdID09PSBhID8gc2VsZWN0IDogY3JlYXRlVW5vcmRlcmVkRW5naW5lU2VsZWN0b3JGaW5kKHNlbGVjdCwgX3NlbGVjdG9yTWF0Y2hlcylcblxuICAgICAgICAgICAgLy8gaGF2ZSB3ZSBkb25lIGVub3VnaCB0byBnZXQgYSB3b3JraW5nIGBzZWxlY3RvckZpbmRgP1xuICAgICAgICAgICAgaWYgKChyID0gX3NlbGVjdG9yRmluZCgnYixhJywgZSkpLmxlbmd0aCAhPT0gMiB8fCByWzBdICE9PSBhKVxuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RyYXZlcnN0eTogY291bGRuXFwndCBtYWtlIHNlbGVjdG9yIGVuZ2luZSB3b3JrJylcblxuICAgICAgICAgICAgc2VsZWN0b3JNYXRjaGVzID0gX3NlbGVjdG9yTWF0Y2hlc1xuICAgICAgICAgICAgc2VsZWN0b3JGaW5kID0gX3NlbGVjdG9yRmluZFxuICAgICAgICAgIH0gY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICB0aHJvdyBpc1N0cmluZyhleClcbiAgICAgICAgICAgICAgPyBleFxuICAgICAgICAgICAgICA6IG5ldyBFcnJvcignVHJhdmVyc3R5OiBlcnJvciB3aGlsZSBmaWd1cmluZyBvdXQgaG93IHRoZSBzZWxlY3RvciBlbmdpbmUgd29ya3M6ICcgKyAoZXgubWVzc2FnZSB8fCBleCkpXG4gICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIGUgPSBudWxsXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHRcbiAgICAgICAgfVxuXG4gICAgICAgIHQubm9Db25mbGljdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBjb250ZXh0LnRyYXZlcnN0eSA9IG9sZFxuICAgICAgICAgIHJldHVybiB0aGlzXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdFxuICAgICAgfSgpKVxuIFxuICByZXR1cm4gdHJhdmVyc3R5XG59KTsiLCIvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgTG9nLmpzIC0gTGlnaHR3ZWlnaHQgd3JhcHBlciBmb3IgY29uc29sZS5sb2dcblxuICAgVXNhZ2U6IGxvZygnaW5zaWRlIGNvb2xGdW5jJywgdGhpcywgYXJndW1lbnRzKTtcbiAgICogcGF1bGlyaXNoLmNvbS8yMDA5L2xvZy1hLWxpZ2h0d2VpZ2h0LXdyYXBwZXItZm9yLWNvbnNvbGVsb2cvXG4gICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xud2luZG93LmxvZyA9IGZ1bmN0aW9uIGYoKSB7XG5cdGxvZy5oaXN0b3J5ID0gbG9nLmhpc3RvcnkgfHwgW107XG5cdGxvZy5oaXN0b3J5LnB1c2goYXJndW1lbnRzKTtcblx0aWYgKHRoaXMuY29uc29sZSkge1xuXHRcdHZhciBhcmdzID0gYXJndW1lbnRzLFxuXHRcdFx0bmV3YXJyO1xuXHRcdHRyeSB7XG5cdFx0XHRhcmdzLmNhbGxlZSA9IGYuY2FsbGVyO1xuXHRcdH0gY2F0Y2ggKGUpIHt9XG5cdFx0bmV3YXJyID0gW10uc2xpY2UuY2FsbChhcmdzKTtcblx0XHRpZiAodHlwZW9mIGNvbnNvbGUubG9nID09PSAnb2JqZWN0JykgIHtcblx0XHRcdGxvZy5hcHBseS5jYWxsKGNvbnNvbGUubG9nLCBjb25zb2xlLCBuZXdhcnIpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBuZXdhcnIpO1xuXHRcdH1cblx0fVxufTtcbiIsIi8qISBcbkluY2x1ZGVkIHNoaW1zOiBBcnJheS5mb3JFYWNoLEFycmF5LmZpbHRlcixBcnJheS5tYXAsRnVuY3Rpb24uYmluZCxFdmVudExpc3RlbmVyLEVsZW1lbnQuY2xhc3NMaXN0XG4qL1xuXG4vKlxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoKClcbiovXG5pZiAoIUFycmF5LnByb3RvdHlwZS5mb3JFYWNoKSB7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIHZhciBuLCByO1xuICAgICAgICBpZiAodGhpcyA9PSBudWxsKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiIHRoaXMgaXMgbnVsbCBvciBub3QgZGVmaW5lZFwiKTtcbiAgICAgICAgfVxuICAgICAgICAvLyAxLiBMZXQgTyBiZSB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgVG9PYmplY3QgcGFzc2luZyB0aGUgfHRoaXN8IHZhbHVlIGFzIHRoZSBhcmd1bWVudC5cbiAgICAgICAgdmFyIGkgPSBPYmplY3QodGhpcyk7XG4gICAgICAgIC8vIDIuIExldCBsZW5WYWx1ZSBiZSB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgdGhlIEdldCBpbnRlcm5hbCBtZXRob2Qgb2YgTyB3aXRoIHRoZSBhcmd1bWVudCBcImxlbmd0aFwiLlxuICAgICAgICAvLyAzLiBMZXQgbGVuIGJlIFRvVWludDMyKGxlblZhbHVlKS5cbiAgICAgICAgdmFyIG8gPSBpLmxlbmd0aCA+Pj4gMDtcbiAgICAgICAgLy8gNC4gSWYgSXNDYWxsYWJsZShjYWxsYmFjaykgaXMgZmFsc2UsIHRocm93IGEgVHlwZUVycm9yIGV4Y2VwdGlvbi5cbiAgICAgICAgLy8gU2VlOiBodHRwOi8vZXM1LmdpdGh1Yi5jb20vI3g5LjExXG4gICAgICAgIGlmICh0eXBlb2YgdCAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHQgKyBcIiBpcyBub3QgYSBmdW5jdGlvblwiKTtcbiAgICAgICAgfVxuICAgICAgICAvLyA1LiBJZiB0aGlzQXJnIHdhcyBzdXBwbGllZCwgbGV0IFQgYmUgdGhpc0FyZzsgZWxzZSBsZXQgVCBiZSB1bmRlZmluZWQuXG4gICAgICAgIGlmIChlKSB7XG4gICAgICAgICAgICBuID0gZTtcbiAgICAgICAgfVxuICAgICAgICAvLyA2LiBMZXQgayBiZSAwXG4gICAgICAgIHIgPSAwO1xuICAgICAgICAvLyA3LiBSZXBlYXQsIHdoaWxlIGsgPCBsZW5cbiAgICAgICAgd2hpbGUgKHIgPCBvKSB7XG4gICAgICAgICAgICB2YXIgYTtcbiAgICAgICAgICAgIC8vIGEuIExldCBQayBiZSBUb1N0cmluZyhrKS5cbiAgICAgICAgICAgIC8vICAgVGhpcyBpcyBpbXBsaWNpdCBmb3IgTEhTIG9wZXJhbmRzIG9mIHRoZSBpbiBvcGVyYXRvclxuICAgICAgICAgICAgLy8gYi4gTGV0IGtQcmVzZW50IGJlIHRoZSByZXN1bHQgb2YgY2FsbGluZyB0aGUgSGFzUHJvcGVydHkgaW50ZXJuYWwgbWV0aG9kIG9mIE8gd2l0aCBhcmd1bWVudCBQay5cbiAgICAgICAgICAgIC8vICAgVGhpcyBzdGVwIGNhbiBiZSBjb21iaW5lZCB3aXRoIGNcbiAgICAgICAgICAgIC8vIGMuIElmIGtQcmVzZW50IGlzIHRydWUsIHRoZW5cbiAgICAgICAgICAgIGlmIChyIGluIGkpIHtcbiAgICAgICAgICAgICAgICAvLyBpLiBMZXQga1ZhbHVlIGJlIHRoZSByZXN1bHQgb2YgY2FsbGluZyB0aGUgR2V0IGludGVybmFsIG1ldGhvZCBvZiBPIHdpdGggYXJndW1lbnQgUGsuXG4gICAgICAgICAgICAgICAgYSA9IGlbcl07XG4gICAgICAgICAgICAgICAgLy8gaWkuIENhbGwgdGhlIENhbGwgaW50ZXJuYWwgbWV0aG9kIG9mIGNhbGxiYWNrIHdpdGggVCBhcyB0aGUgdGhpcyB2YWx1ZSBhbmRcbiAgICAgICAgICAgICAgICAvLyBhcmd1bWVudCBsaXN0IGNvbnRhaW5pbmcga1ZhbHVlLCBrLCBhbmQgTy5cbiAgICAgICAgICAgICAgICB0LmNhbGwobiwgYSwgciwgaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBkLiBJbmNyZWFzZSBrIGJ5IDEuXG4gICAgICAgICAgICByKys7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG4vKlxuICAgIEFycmF5LnByb3RvdHlwZS5maWx0ZXIoKVxuKi9cbmlmICghQXJyYXkucHJvdG90eXBlLmZpbHRlcikge1xuICAgIEFycmF5LnByb3RvdHlwZS5maWx0ZXIgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgICBpZiAodGhpcyA9PT0gdm9pZCAwIHx8IHRoaXMgPT09IG51bGwpIHRocm93IG5ldyBUeXBlRXJyb3IoKTtcbiAgICAgICAgdmFyIGUgPSBPYmplY3QodGhpcyk7XG4gICAgICAgIHZhciBuID0gZS5sZW5ndGggPj4+IDA7XG4gICAgICAgIGlmICh0eXBlb2YgdCAhPT0gXCJmdW5jdGlvblwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XG4gICAgICAgIHZhciByID0gW107XG4gICAgICAgIHZhciBpID0gYXJndW1lbnRzLmxlbmd0aCA+PSAyID8gYXJndW1lbnRzWzFdIDogdm9pZCAwO1xuICAgICAgICBmb3IgKHZhciBvID0gMDsgbyA8IG47IG8rKykge1xuICAgICAgICAgICAgaWYgKG8gaW4gZSkge1xuICAgICAgICAgICAgICAgIHZhciBhID0gZVtvXTtcbiAgICAgICAgICAgICAgICAvLyBOT1RFOiBUZWNobmljYWxseSB0aGlzIHNob3VsZCBPYmplY3QuZGVmaW5lUHJvcGVydHkgYXRcbiAgICAgICAgICAgICAgICAvLyAgICAgICB0aGUgbmV4dCBpbmRleCwgYXMgcHVzaCBjYW4gYmUgYWZmZWN0ZWQgYnlcbiAgICAgICAgICAgICAgICAvLyAgICAgICBwcm9wZXJ0aWVzIG9uIE9iamVjdC5wcm90b3R5cGUgYW5kIEFycmF5LnByb3RvdHlwZS5cbiAgICAgICAgICAgICAgICAvLyAgICAgICBCdXQgdGhhdCBtZXRob2QncyBuZXcsIGFuZCBjb2xsaXNpb25zIHNob3VsZCBiZVxuICAgICAgICAgICAgICAgIC8vICAgICAgIHJhcmUsIHNvIHVzZSB0aGUgbW9yZS1jb21wYXRpYmxlIGFsdGVybmF0aXZlLlxuICAgICAgICAgICAgICAgIGlmICh0LmNhbGwoaSwgYSwgbywgZSkpIHIucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcjtcbiAgICB9O1xufVxuXG4vKlxuICAgQXJyYXkgbWFwIHBhdGNoXG4gICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuaWYgKCEoXCJtYXBcIiBpbiBBcnJheS5wcm90b3R5cGUpKSB7XG4gICAgQXJyYXkucHJvdG90eXBlLm1hcCA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgdmFyIG4gPSB0aGlzLmxlbmd0aCA+Pj4gMCwgciA9IEFycmF5KG4pO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG47IGkrKykge1xuICAgICAgICAgICAgaWYgKGkgaW4gdGhpcykge1xuICAgICAgICAgICAgICAgIHJbaV0gPSB0LmNhbGwoZSwgdGhpc1tpXSwgaSwgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHI7XG4gICAgfTtcbn1cblxuLypcbiAgICBGdW5jdGlvbi5wcm90b3R5cGUuYmluZCgpXG4qL1xuaWYgKCFGdW5jdGlvbi5wcm90b3R5cGUuYmluZCkge1xuICAgIEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24odCkge1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgLy8gY2xvc2VzdCB0aGluZyBwb3NzaWJsZSB0byB0aGUgRUNNQVNjcmlwdCA1XG4gICAgICAgICAgICAvLyBpbnRlcm5hbCBJc0NhbGxhYmxlIGZ1bmN0aW9uXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQgLSB3aGF0IGlzIHRyeWluZyB0byBiZSBib3VuZCBpcyBub3QgY2FsbGFibGVcIik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGUgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpLCBuID0gdGhpcywgciA9IGZ1bmN0aW9uKCkge30sIGkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBuLmFwcGx5KHRoaXMgaW5zdGFuY2VvZiByICYmIHQgPyB0aGlzIDogdCwgZS5jb25jYXQoQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKSkpO1xuICAgICAgICB9O1xuICAgICAgICByLnByb3RvdHlwZSA9IHRoaXMucHJvdG90eXBlO1xuICAgICAgICBpLnByb3RvdHlwZSA9IG5ldyByKCk7XG4gICAgICAgIHJldHVybiBpO1xuICAgIH07XG59XG5cbi8vIEV2ZW50TGlzdGVuZXIgfCBNSVQvR1BMMiB8IGh0dHBzOi8vZ2l0aHViLmNvbS9qb25hdGhhbnRuZWFsL0V2ZW50TGlzdGVuZXJcbnRoaXMuRWxlbWVudCAmJiBFbGVtZW50LnByb3RvdHlwZS5hdHRhY2hFdmVudCAmJiAhRWxlbWVudC5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lciAmJiBmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiB0KHQsIGUpIHtcbiAgICAgICAgV2luZG93LnByb3RvdHlwZVt0XSA9IEhUTUxEb2N1bWVudC5wcm90b3R5cGVbdF0gPSBFbGVtZW50LnByb3RvdHlwZVt0XSA9IGU7XG4gICAgfVxuICAgIC8vIGFkZFxuICAgIHQoXCJhZGRFdmVudExpc3RlbmVyXCIsIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgdmFyIG4gPSB0aGlzLCByID0gbi5hZGRFdmVudExpc3RlbmVyLmxpc3RlbmVycyA9IG4uYWRkRXZlbnRMaXN0ZW5lci5saXN0ZW5lcnMgfHwge30sIGkgPSByW3RdID0gclt0XSB8fCBbXTtcbiAgICAgICAgLy8gaWYgbm8gZXZlbnRzIGV4aXN0LCBhdHRhY2ggdGhlIGxpc3RlbmVyXG4gICAgICAgIGlmICghaS5sZW5ndGgpIHtcbiAgICAgICAgICAgIG4uYXR0YWNoRXZlbnQoXCJvblwiICsgdCwgaS5ldmVudCA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZSA9IG4uZG9jdW1lbnQgJiYgbi5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgfHwgbi5kb2N1bWVudEVsZW1lbnQgfHwge1xuICAgICAgICAgICAgICAgICAgICBzY3JvbGxMZWZ0OiAwLFxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb3A6IDBcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIC8vIHBvbHlmaWxsIHczYyBwcm9wZXJ0aWVzIGFuZCBtZXRob2RzXG4gICAgICAgICAgICAgICAgdC5jdXJyZW50VGFyZ2V0ID0gbjtcbiAgICAgICAgICAgICAgICB0LnBhZ2VYID0gdC5jbGllbnRYICsgZS5zY3JvbGxMZWZ0O1xuICAgICAgICAgICAgICAgIHQucGFnZVkgPSB0LmNsaWVudFkgKyBlLnNjcm9sbFRvcDtcbiAgICAgICAgICAgICAgICB0LnByZXZlbnREZWZhdWx0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHQucmV0dXJuVmFsdWUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHQucmVsYXRlZFRhcmdldCA9IHQuZnJvbUVsZW1lbnQgfHwgbnVsbDtcbiAgICAgICAgICAgICAgICB0LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHQuY2FuY2VsQnViYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHQuc3RvcFByb3BhZ2F0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHQuY2FuY2VsQnViYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHQudGFyZ2V0ID0gdC5zcmNFbGVtZW50IHx8IG47XG4gICAgICAgICAgICAgICAgdC50aW1lU3RhbXAgPSArbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICAvLyBjcmVhdGUgYW4gY2FjaGVkIGxpc3Qgb2YgdGhlIG1hc3RlciBldmVudHMgbGlzdCAodG8gcHJvdGVjdCB0aGlzIGxvb3AgZnJvbSBicmVha2luZyB3aGVuIGFuIGV2ZW50IGlzIHJlbW92ZWQpXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgciA9IDAsIG8gPSBbXS5jb25jYXQoaSksIGEsIHMgPSB0cnVlOyBzICYmIChhID0gb1tyXSk7ICsrcikge1xuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayB0byBzZWUgaWYgdGhlIGNhY2hlZCBldmVudCBzdGlsbCBleGlzdHMgaW4gdGhlIG1hc3RlciBldmVudHMgbGlzdFxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBsID0gMCwgYzsgYyA9IGlbbF07ICsrbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGMgPT0gYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuY2FsbChuLCB0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vIGFkZCB0aGUgZXZlbnQgdG8gdGhlIG1hc3RlciBldmVudCBsaXN0XG4gICAgICAgIGkucHVzaChlKTtcbiAgICB9KTtcbiAgICAvLyByZW1vdmVcbiAgICB0KFwicmVtb3ZlRXZlbnRMaXN0ZW5lclwiLCBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIHZhciBuID0gdGhpcywgciA9IG4uYWRkRXZlbnRMaXN0ZW5lci5saXN0ZW5lcnMgPSBuLmFkZEV2ZW50TGlzdGVuZXIubGlzdGVuZXJzIHx8IHt9LCBpID0gclt0XSA9IHJbdF0gfHwgW107XG4gICAgICAgIC8vIHJlbW92ZSB0aGUgbmV3ZXN0IG1hdGNoaW5nIGV2ZW50IGZyb20gdGhlIG1hc3RlciBldmVudCBsaXN0XG4gICAgICAgIGZvciAodmFyIG8gPSBpLmxlbmd0aCAtIDEsIGE7IGEgPSBpW29dOyAtLW8pIHtcbiAgICAgICAgICAgIGlmIChhID09IGUpIHtcbiAgICAgICAgICAgICAgICBpLnNwbGljZShvLCAxKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBpZiBubyBldmVudHMgZXhpc3QsIGRldGFjaCB0aGUgbGlzdGVuZXJcbiAgICAgICAgaWYgKCFpLmxlbmd0aCAmJiBpLmV2ZW50KSB7XG4gICAgICAgICAgICBuLmRldGFjaEV2ZW50KFwib25cIiArIHQsIGkuZXZlbnQpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgLy8gZGlzcGF0Y2hcbiAgICB0KFwiZGlzcGF0Y2hFdmVudFwiLCBmdW5jdGlvbih0KSB7XG4gICAgICAgIHZhciBlID0gdGhpcywgbiA9IHQudHlwZSwgciA9IGUuYWRkRXZlbnRMaXN0ZW5lci5saXN0ZW5lcnMgPSBlLmFkZEV2ZW50TGlzdGVuZXIubGlzdGVuZXJzIHx8IHt9LCBpID0gcltuXSA9IHJbbl0gfHwgW107XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gZS5maXJlRXZlbnQoXCJvblwiICsgbiwgdCk7XG4gICAgICAgIH0gY2F0Y2ggKG8pIHtcbiAgICAgICAgICAgIGlmIChpLmV2ZW50KSB7XG4gICAgICAgICAgICAgICAgaS5ldmVudCh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIC8vIEN1c3RvbUV2ZW50XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFdpbmRvdy5wcm90b3R5cGUsIFwiQ3VzdG9tRXZlbnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGUobiwgcikge1xuICAgICAgICAgICAgICAgIHZhciBpID0gdC5kb2N1bWVudC5jcmVhdGVFdmVudE9iamVjdCgpLCBvO1xuICAgICAgICAgICAgICAgIGkudHlwZSA9IG47XG4gICAgICAgICAgICAgICAgZm9yIChvIGluIHIpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG8gPT0gXCJjYW5jZWxhYmxlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGkucmV0dXJuVmFsdWUgPSAhci5jYW5jZWxhYmxlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG8gPT0gXCJidWJibGVzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGkuY2FuY2VsQnViYmxlID0gIXIuYnViYmxlcztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChvID09IFwiZGV0YWlsXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGkuZGV0YWlsID0gci5kZXRhaWw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgLy8gcmVhZHlcbiAgICBmdW5jdGlvbiBlKHQpIHtcbiAgICAgICAgaWYgKGUuaW50ZXJ2YWwgJiYgZG9jdW1lbnQuYm9keSkge1xuICAgICAgICAgICAgZS5pbnRlcnZhbCA9IGNsZWFySW50ZXJ2YWwoZS5pbnRlcnZhbCk7XG4gICAgICAgICAgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcIkRPTUNvbnRlbnRMb2FkZWRcIikpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGUuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChlLCAxKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgZSk7XG59KCk7XG5cbiF0aGlzLkN1c3RvbUV2ZW50ICYmIGZ1bmN0aW9uKCkge1xuICAgIC8vIEN1c3RvbUV2ZW50IGZvciBicm93c2VycyB3aGljaCBkb24ndCBuYXRpdmVseSBzdXBwb3J0IHRoZSBDb25zdHJ1Y3RvciBtZXRob2RcbiAgICB3aW5kb3cuQ3VzdG9tRXZlbnQgPSBmdW5jdGlvbiB0KGUsIG4pIHtcbiAgICAgICAgdmFyIHI7XG4gICAgICAgIG4gPSBuIHx8IHtcbiAgICAgICAgICAgIGJ1YmJsZXM6IGZhbHNlLFxuICAgICAgICAgICAgY2FuY2VsYWJsZTogZmFsc2UsXG4gICAgICAgICAgICBkZXRhaWw6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgciA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KFwiQ3VzdG9tRXZlbnRcIik7XG4gICAgICAgICAgICByLmluaXRDdXN0b21FdmVudChlLCBuLmJ1YmJsZXMsIG4uY2FuY2VsYWJsZSwgbi5kZXRhaWwpO1xuICAgICAgICB9IGNhdGNoIChpKSB7XG4gICAgICAgICAgICAvLyBmb3IgYnJvd3NlcnMgd2hpY2ggZG9uJ3Qgc3VwcG9ydCBDdXN0b21FdmVudCBhdCBhbGwsIHdlIHVzZSBhIHJlZ3VsYXIgZXZlbnQgaW5zdGVhZFxuICAgICAgICAgICAgciA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KFwiRXZlbnRcIik7XG4gICAgICAgICAgICByLmluaXRFdmVudChlLCBuLmJ1YmJsZXMsIG4uY2FuY2VsYWJsZSk7XG4gICAgICAgICAgICByLmRldGFpbCA9IG4uZGV0YWlsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByO1xuICAgIH07XG59KCk7XG5cbi8qXG4gKiBjbGFzc0xpc3QuanM6IENyb3NzLWJyb3dzZXIgZnVsbCBlbGVtZW50LmNsYXNzTGlzdCBpbXBsZW1lbnRhdGlvbi5cbiAqIDIwMTQtMDEtMzFcbiAqXG4gKiBCeSBFbGkgR3JleSwgaHR0cDovL2VsaWdyZXkuY29tXG4gKiBQdWJsaWMgRG9tYWluLlxuICogTk8gV0FSUkFOVFkgRVhQUkVTU0VEIE9SIElNUExJRUQuIFVTRSBBVCBZT1VSIE9XTiBSSVNLLlxuICovXG4vKmdsb2JhbCBzZWxmLCBkb2N1bWVudCwgRE9NRXhjZXB0aW9uICovXG4vKiEgQHNvdXJjZSBodHRwOi8vcHVybC5lbGlncmV5LmNvbS9naXRodWIvY2xhc3NMaXN0LmpzL2Jsb2IvbWFzdGVyL2NsYXNzTGlzdC5qcyovXG5pZiAoXCJkb2N1bWVudFwiIGluIHNlbGYgJiYgIShcImNsYXNzTGlzdFwiIGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJfXCIpKSkge1xuICAgIChmdW5jdGlvbih0KSB7XG4gICAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgICBpZiAoIShcIkVsZW1lbnRcIiBpbiB0KSkgcmV0dXJuO1xuICAgICAgICB2YXIgZSA9IFwiY2xhc3NMaXN0XCIsIG4gPSBcInByb3RvdHlwZVwiLCByID0gdC5FbGVtZW50W25dLCBpID0gT2JqZWN0LCBvID0gU3RyaW5nW25dLnRyaW0gfHwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCBcIlwiKTtcbiAgICAgICAgfSwgYSA9IEFycmF5W25dLmluZGV4T2YgfHwgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgdmFyIGUgPSAwLCBuID0gdGhpcy5sZW5ndGg7XG4gICAgICAgICAgICBmb3IgKDtlIDwgbjsgZSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGUgaW4gdGhpcyAmJiB0aGlzW2VdID09PSB0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfSwgcyA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHRoaXMubmFtZSA9IHQ7XG4gICAgICAgICAgICB0aGlzLmNvZGUgPSBET01FeGNlcHRpb25bdF07XG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2UgPSBlO1xuICAgICAgICB9LCBsID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgaWYgKGUgPT09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgcyhcIlNZTlRBWF9FUlJcIiwgXCJBbiBpbnZhbGlkIG9yIGlsbGVnYWwgc3RyaW5nIHdhcyBzcGVjaWZpZWRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoL1xccy8udGVzdChlKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBzKFwiSU5WQUxJRF9DSEFSQUNURVJfRVJSXCIsIFwiU3RyaW5nIGNvbnRhaW5zIGFuIGludmFsaWQgY2hhcmFjdGVyXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGEuY2FsbCh0LCBlKTtcbiAgICAgICAgfSwgYyA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHZhciBlID0gby5jYWxsKHQuZ2V0QXR0cmlidXRlKFwiY2xhc3NcIikgfHwgXCJcIiksIG4gPSBlID8gZS5zcGxpdCgvXFxzKy8pIDogW10sIHIgPSAwLCBpID0gbi5sZW5ndGg7XG4gICAgICAgICAgICBmb3IgKDtyIDwgaTsgcisrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wdXNoKG5bcl0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fdXBkYXRlQ2xhc3NOYW1lID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdC5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCB0aGlzLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSwgdSA9IGNbbl0gPSBbXSwgZiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBjKHRoaXMpO1xuICAgICAgICB9O1xuICAgICAgICAvLyBNb3N0IERPTUV4Y2VwdGlvbiBpbXBsZW1lbnRhdGlvbnMgZG9uJ3QgYWxsb3cgY2FsbGluZyBET01FeGNlcHRpb24ncyB0b1N0cmluZygpXG4gICAgICAgIC8vIG9uIG5vbi1ET01FeGNlcHRpb25zLiBFcnJvcidzIHRvU3RyaW5nKCkgaXMgc3VmZmljaWVudCBoZXJlLlxuICAgICAgICBzW25dID0gRXJyb3Jbbl07XG4gICAgICAgIHUuaXRlbSA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzW3RdIHx8IG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIHUuY29udGFpbnMgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICB0ICs9IFwiXCI7XG4gICAgICAgICAgICByZXR1cm4gbCh0aGlzLCB0KSAhPT0gLTE7XG4gICAgICAgIH07XG4gICAgICAgIHUuYWRkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgdCA9IGFyZ3VtZW50cywgZSA9IDAsIG4gPSB0Lmxlbmd0aCwgciwgaSA9IGZhbHNlO1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIHIgPSB0W2VdICsgXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAobCh0aGlzLCByKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wdXNoKHIpO1xuICAgICAgICAgICAgICAgICAgICBpID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IHdoaWxlICgrK2UgPCBuKTtcbiAgICAgICAgICAgIGlmIChpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlQ2xhc3NOYW1lKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHUucmVtb3ZlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgdCA9IGFyZ3VtZW50cywgZSA9IDAsIG4gPSB0Lmxlbmd0aCwgciwgaSA9IGZhbHNlO1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIHIgPSB0W2VdICsgXCJcIjtcbiAgICAgICAgICAgICAgICB2YXIgbyA9IGwodGhpcywgcik7XG4gICAgICAgICAgICAgICAgaWYgKG8gIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3BsaWNlKG8sIDEpO1xuICAgICAgICAgICAgICAgICAgICBpID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IHdoaWxlICgrK2UgPCBuKTtcbiAgICAgICAgICAgIGlmIChpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlQ2xhc3NOYW1lKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHUudG9nZ2xlID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgdCArPSBcIlwiO1xuICAgICAgICAgICAgdmFyIG4gPSB0aGlzLmNvbnRhaW5zKHQpLCByID0gbiA/IGUgIT09IHRydWUgJiYgXCJyZW1vdmVcIiA6IGUgIT09IGZhbHNlICYmIFwiYWRkXCI7XG4gICAgICAgICAgICBpZiAocikge1xuICAgICAgICAgICAgICAgIHRoaXNbcl0odCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gIW47XG4gICAgICAgIH07XG4gICAgICAgIHUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmpvaW4oXCIgXCIpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoaS5kZWZpbmVQcm9wZXJ0eSkge1xuICAgICAgICAgICAgdmFyIHAgPSB7XG4gICAgICAgICAgICAgICAgZ2V0OiBmLFxuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpLmRlZmluZVByb3BlcnR5KHIsIGUsIHApO1xuICAgICAgICAgICAgfSBjYXRjaCAoaCkge1xuICAgICAgICAgICAgICAgIC8vIElFIDggZG9lc24ndCBzdXBwb3J0IGVudW1lcmFibGU6dHJ1ZVxuICAgICAgICAgICAgICAgIGlmIChoLm51bWJlciA9PT0gLTIxNDY4MjMyNTIpIHtcbiAgICAgICAgICAgICAgICAgICAgcC5lbnVtZXJhYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGkuZGVmaW5lUHJvcGVydHkociwgZSwgcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGlbbl0uX19kZWZpbmVHZXR0ZXJfXykge1xuICAgICAgICAgICAgci5fX2RlZmluZUdldHRlcl9fKGUsIGYpO1xuICAgICAgICB9XG4gICAgfSkoc2VsZik7XG59IiwiKGZ1bmN0aW9uIChnbG9iYWwpe1xuIWZ1bmN0aW9uKGUpe2lmKFwib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgbW9kdWxlKW1vZHVsZS5leHBvcnRzPWUoKTtlbHNlIGlmKFwiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZClkZWZpbmUoW10sZSk7ZWxzZXt2YXIgZjtcInVuZGVmaW5lZFwiIT10eXBlb2Ygd2luZG93P2Y9d2luZG93OlwidW5kZWZpbmVkXCIhPXR5cGVvZiBnbG9iYWw/Zj1nbG9iYWw6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHNlbGYmJihmPXNlbGYpLGYuaW89ZSgpfX0oZnVuY3Rpb24oKXt2YXIgZGVmaW5lLG1vZHVsZSxleHBvcnRzO3JldHVybiBmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKX12YXIgZj1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwoZi5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxmLGYuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30oezE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe21vZHVsZS5leHBvcnRzPV9kZXJlcV8oXCIuL2xpYi9cIil9LHtcIi4vbGliL1wiOjJ9XSwyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXt2YXIgdXJsPV9kZXJlcV8oXCIuL3VybFwiKTt2YXIgcGFyc2VyPV9kZXJlcV8oXCJzb2NrZXQuaW8tcGFyc2VyXCIpO3ZhciBNYW5hZ2VyPV9kZXJlcV8oXCIuL21hbmFnZXJcIik7dmFyIGRlYnVnPV9kZXJlcV8oXCJkZWJ1Z1wiKShcInNvY2tldC5pby1jbGllbnRcIik7bW9kdWxlLmV4cG9ydHM9ZXhwb3J0cz1sb29rdXA7dmFyIGNhY2hlPWV4cG9ydHMubWFuYWdlcnM9e307ZnVuY3Rpb24gbG9va3VwKHVyaSxvcHRzKXtpZih0eXBlb2YgdXJpPT1cIm9iamVjdFwiKXtvcHRzPXVyaTt1cmk9dW5kZWZpbmVkfW9wdHM9b3B0c3x8e307dmFyIHBhcnNlZD11cmwodXJpKTt2YXIgc291cmNlPXBhcnNlZC5zb3VyY2U7dmFyIGlkPXBhcnNlZC5pZDt2YXIgaW87aWYob3B0cy5mb3JjZU5ld3x8b3B0c1tcImZvcmNlIG5ldyBjb25uZWN0aW9uXCJdfHxmYWxzZT09PW9wdHMubXVsdGlwbGV4KXtkZWJ1ZyhcImlnbm9yaW5nIHNvY2tldCBjYWNoZSBmb3IgJXNcIixzb3VyY2UpO2lvPU1hbmFnZXIoc291cmNlLG9wdHMpfWVsc2V7aWYoIWNhY2hlW2lkXSl7ZGVidWcoXCJuZXcgaW8gaW5zdGFuY2UgZm9yICVzXCIsc291cmNlKTtjYWNoZVtpZF09TWFuYWdlcihzb3VyY2Usb3B0cyl9aW89Y2FjaGVbaWRdfXJldHVybiBpby5zb2NrZXQocGFyc2VkLnBhdGgpfWV4cG9ydHMucHJvdG9jb2w9cGFyc2VyLnByb3RvY29sO2V4cG9ydHMuY29ubmVjdD1sb29rdXA7ZXhwb3J0cy5NYW5hZ2VyPV9kZXJlcV8oXCIuL21hbmFnZXJcIik7ZXhwb3J0cy5Tb2NrZXQ9X2RlcmVxXyhcIi4vc29ja2V0XCIpfSx7XCIuL21hbmFnZXJcIjozLFwiLi9zb2NrZXRcIjo1LFwiLi91cmxcIjo2LGRlYnVnOjksXCJzb2NrZXQuaW8tcGFyc2VyXCI6NDB9XSwzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXt2YXIgdXJsPV9kZXJlcV8oXCIuL3VybFwiKTt2YXIgZWlvPV9kZXJlcV8oXCJlbmdpbmUuaW8tY2xpZW50XCIpO3ZhciBTb2NrZXQ9X2RlcmVxXyhcIi4vc29ja2V0XCIpO3ZhciBFbWl0dGVyPV9kZXJlcV8oXCJjb21wb25lbnQtZW1pdHRlclwiKTt2YXIgcGFyc2VyPV9kZXJlcV8oXCJzb2NrZXQuaW8tcGFyc2VyXCIpO3ZhciBvbj1fZGVyZXFfKFwiLi9vblwiKTt2YXIgYmluZD1fZGVyZXFfKFwiY29tcG9uZW50LWJpbmRcIik7dmFyIG9iamVjdD1fZGVyZXFfKFwib2JqZWN0LWNvbXBvbmVudFwiKTt2YXIgZGVidWc9X2RlcmVxXyhcImRlYnVnXCIpKFwic29ja2V0LmlvLWNsaWVudDptYW5hZ2VyXCIpO21vZHVsZS5leHBvcnRzPU1hbmFnZXI7ZnVuY3Rpb24gTWFuYWdlcih1cmksb3B0cyl7aWYoISh0aGlzIGluc3RhbmNlb2YgTWFuYWdlcikpcmV0dXJuIG5ldyBNYW5hZ2VyKHVyaSxvcHRzKTtpZih1cmkmJlwib2JqZWN0XCI9PXR5cGVvZiB1cmkpe29wdHM9dXJpO3VyaT11bmRlZmluZWR9b3B0cz1vcHRzfHx7fTtvcHRzLnBhdGg9b3B0cy5wYXRofHxcIi9zb2NrZXQuaW9cIjt0aGlzLm5zcHM9e307dGhpcy5zdWJzPVtdO3RoaXMub3B0cz1vcHRzO3RoaXMucmVjb25uZWN0aW9uKG9wdHMucmVjb25uZWN0aW9uIT09ZmFsc2UpO3RoaXMucmVjb25uZWN0aW9uQXR0ZW1wdHMob3B0cy5yZWNvbm5lY3Rpb25BdHRlbXB0c3x8SW5maW5pdHkpO3RoaXMucmVjb25uZWN0aW9uRGVsYXkob3B0cy5yZWNvbm5lY3Rpb25EZWxheXx8MWUzKTt0aGlzLnJlY29ubmVjdGlvbkRlbGF5TWF4KG9wdHMucmVjb25uZWN0aW9uRGVsYXlNYXh8fDVlMyk7dGhpcy50aW1lb3V0KG51bGw9PW9wdHMudGltZW91dD8yZTQ6b3B0cy50aW1lb3V0KTt0aGlzLnJlYWR5U3RhdGU9XCJjbG9zZWRcIjt0aGlzLnVyaT11cmk7dGhpcy5jb25uZWN0ZWQ9MDt0aGlzLmF0dGVtcHRzPTA7dGhpcy5lbmNvZGluZz1mYWxzZTt0aGlzLnBhY2tldEJ1ZmZlcj1bXTt0aGlzLmVuY29kZXI9bmV3IHBhcnNlci5FbmNvZGVyO3RoaXMuZGVjb2Rlcj1uZXcgcGFyc2VyLkRlY29kZXI7dGhpcy5hdXRvQ29ubmVjdD1vcHRzLmF1dG9Db25uZWN0IT09ZmFsc2U7aWYodGhpcy5hdXRvQ29ubmVjdCl0aGlzLm9wZW4oKX1NYW5hZ2VyLnByb3RvdHlwZS5lbWl0QWxsPWZ1bmN0aW9uKCl7dGhpcy5lbWl0LmFwcGx5KHRoaXMsYXJndW1lbnRzKTtmb3IodmFyIG5zcCBpbiB0aGlzLm5zcHMpe3RoaXMubnNwc1tuc3BdLmVtaXQuYXBwbHkodGhpcy5uc3BzW25zcF0sYXJndW1lbnRzKX19O0VtaXR0ZXIoTWFuYWdlci5wcm90b3R5cGUpO01hbmFnZXIucHJvdG90eXBlLnJlY29ubmVjdGlvbj1mdW5jdGlvbih2KXtpZighYXJndW1lbnRzLmxlbmd0aClyZXR1cm4gdGhpcy5fcmVjb25uZWN0aW9uO3RoaXMuX3JlY29ubmVjdGlvbj0hIXY7cmV0dXJuIHRoaXN9O01hbmFnZXIucHJvdG90eXBlLnJlY29ubmVjdGlvbkF0dGVtcHRzPWZ1bmN0aW9uKHYpe2lmKCFhcmd1bWVudHMubGVuZ3RoKXJldHVybiB0aGlzLl9yZWNvbm5lY3Rpb25BdHRlbXB0czt0aGlzLl9yZWNvbm5lY3Rpb25BdHRlbXB0cz12O3JldHVybiB0aGlzfTtNYW5hZ2VyLnByb3RvdHlwZS5yZWNvbm5lY3Rpb25EZWxheT1mdW5jdGlvbih2KXtpZighYXJndW1lbnRzLmxlbmd0aClyZXR1cm4gdGhpcy5fcmVjb25uZWN0aW9uRGVsYXk7dGhpcy5fcmVjb25uZWN0aW9uRGVsYXk9djtyZXR1cm4gdGhpc307TWFuYWdlci5wcm90b3R5cGUucmVjb25uZWN0aW9uRGVsYXlNYXg9ZnVuY3Rpb24odil7aWYoIWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHRoaXMuX3JlY29ubmVjdGlvbkRlbGF5TWF4O3RoaXMuX3JlY29ubmVjdGlvbkRlbGF5TWF4PXY7cmV0dXJuIHRoaXN9O01hbmFnZXIucHJvdG90eXBlLnRpbWVvdXQ9ZnVuY3Rpb24odil7aWYoIWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHRoaXMuX3RpbWVvdXQ7dGhpcy5fdGltZW91dD12O3JldHVybiB0aGlzfTtNYW5hZ2VyLnByb3RvdHlwZS5tYXliZVJlY29ubmVjdE9uT3Blbj1mdW5jdGlvbigpe2lmKCF0aGlzLm9wZW5SZWNvbm5lY3QmJiF0aGlzLnJlY29ubmVjdGluZyYmdGhpcy5fcmVjb25uZWN0aW9uJiZ0aGlzLmF0dGVtcHRzPT09MCl7dGhpcy5vcGVuUmVjb25uZWN0PXRydWU7dGhpcy5yZWNvbm5lY3QoKX19O01hbmFnZXIucHJvdG90eXBlLm9wZW49TWFuYWdlci5wcm90b3R5cGUuY29ubmVjdD1mdW5jdGlvbihmbil7ZGVidWcoXCJyZWFkeVN0YXRlICVzXCIsdGhpcy5yZWFkeVN0YXRlKTtpZih+dGhpcy5yZWFkeVN0YXRlLmluZGV4T2YoXCJvcGVuXCIpKXJldHVybiB0aGlzO2RlYnVnKFwib3BlbmluZyAlc1wiLHRoaXMudXJpKTt0aGlzLmVuZ2luZT1laW8odGhpcy51cmksdGhpcy5vcHRzKTt2YXIgc29ja2V0PXRoaXMuZW5naW5lO3ZhciBzZWxmPXRoaXM7dGhpcy5yZWFkeVN0YXRlPVwib3BlbmluZ1wiO3ZhciBvcGVuU3ViPW9uKHNvY2tldCxcIm9wZW5cIixmdW5jdGlvbigpe3NlbGYub25vcGVuKCk7Zm4mJmZuKCl9KTt2YXIgZXJyb3JTdWI9b24oc29ja2V0LFwiZXJyb3JcIixmdW5jdGlvbihkYXRhKXtkZWJ1ZyhcImNvbm5lY3RfZXJyb3JcIik7c2VsZi5jbGVhbnVwKCk7c2VsZi5yZWFkeVN0YXRlPVwiY2xvc2VkXCI7c2VsZi5lbWl0QWxsKFwiY29ubmVjdF9lcnJvclwiLGRhdGEpO2lmKGZuKXt2YXIgZXJyPW5ldyBFcnJvcihcIkNvbm5lY3Rpb24gZXJyb3JcIik7ZXJyLmRhdGE9ZGF0YTtmbihlcnIpfXNlbGYubWF5YmVSZWNvbm5lY3RPbk9wZW4oKX0pO2lmKGZhbHNlIT09dGhpcy5fdGltZW91dCl7dmFyIHRpbWVvdXQ9dGhpcy5fdGltZW91dDtkZWJ1ZyhcImNvbm5lY3QgYXR0ZW1wdCB3aWxsIHRpbWVvdXQgYWZ0ZXIgJWRcIix0aW1lb3V0KTt2YXIgdGltZXI9c2V0VGltZW91dChmdW5jdGlvbigpe2RlYnVnKFwiY29ubmVjdCBhdHRlbXB0IHRpbWVkIG91dCBhZnRlciAlZFwiLHRpbWVvdXQpO29wZW5TdWIuZGVzdHJveSgpO3NvY2tldC5jbG9zZSgpO3NvY2tldC5lbWl0KFwiZXJyb3JcIixcInRpbWVvdXRcIik7c2VsZi5lbWl0QWxsKFwiY29ubmVjdF90aW1lb3V0XCIsdGltZW91dCl9LHRpbWVvdXQpO3RoaXMuc3Vicy5wdXNoKHtkZXN0cm95OmZ1bmN0aW9uKCl7Y2xlYXJUaW1lb3V0KHRpbWVyKX19KX10aGlzLnN1YnMucHVzaChvcGVuU3ViKTt0aGlzLnN1YnMucHVzaChlcnJvclN1Yik7cmV0dXJuIHRoaXN9O01hbmFnZXIucHJvdG90eXBlLm9ub3Blbj1mdW5jdGlvbigpe2RlYnVnKFwib3BlblwiKTt0aGlzLmNsZWFudXAoKTt0aGlzLnJlYWR5U3RhdGU9XCJvcGVuXCI7dGhpcy5lbWl0KFwib3BlblwiKTt2YXIgc29ja2V0PXRoaXMuZW5naW5lO3RoaXMuc3Vicy5wdXNoKG9uKHNvY2tldCxcImRhdGFcIixiaW5kKHRoaXMsXCJvbmRhdGFcIikpKTt0aGlzLnN1YnMucHVzaChvbih0aGlzLmRlY29kZXIsXCJkZWNvZGVkXCIsYmluZCh0aGlzLFwib25kZWNvZGVkXCIpKSk7dGhpcy5zdWJzLnB1c2gob24oc29ja2V0LFwiZXJyb3JcIixiaW5kKHRoaXMsXCJvbmVycm9yXCIpKSk7dGhpcy5zdWJzLnB1c2gob24oc29ja2V0LFwiY2xvc2VcIixiaW5kKHRoaXMsXCJvbmNsb3NlXCIpKSl9O01hbmFnZXIucHJvdG90eXBlLm9uZGF0YT1mdW5jdGlvbihkYXRhKXt0aGlzLmRlY29kZXIuYWRkKGRhdGEpfTtNYW5hZ2VyLnByb3RvdHlwZS5vbmRlY29kZWQ9ZnVuY3Rpb24ocGFja2V0KXt0aGlzLmVtaXQoXCJwYWNrZXRcIixwYWNrZXQpfTtNYW5hZ2VyLnByb3RvdHlwZS5vbmVycm9yPWZ1bmN0aW9uKGVycil7ZGVidWcoXCJlcnJvclwiLGVycik7dGhpcy5lbWl0QWxsKFwiZXJyb3JcIixlcnIpfTtNYW5hZ2VyLnByb3RvdHlwZS5zb2NrZXQ9ZnVuY3Rpb24obnNwKXt2YXIgc29ja2V0PXRoaXMubnNwc1tuc3BdO2lmKCFzb2NrZXQpe3NvY2tldD1uZXcgU29ja2V0KHRoaXMsbnNwKTt0aGlzLm5zcHNbbnNwXT1zb2NrZXQ7dmFyIHNlbGY9dGhpcztzb2NrZXQub24oXCJjb25uZWN0XCIsZnVuY3Rpb24oKXtzZWxmLmNvbm5lY3RlZCsrfSl9cmV0dXJuIHNvY2tldH07TWFuYWdlci5wcm90b3R5cGUuZGVzdHJveT1mdW5jdGlvbihzb2NrZXQpey0tdGhpcy5jb25uZWN0ZWR8fHRoaXMuY2xvc2UoKX07TWFuYWdlci5wcm90b3R5cGUucGFja2V0PWZ1bmN0aW9uKHBhY2tldCl7ZGVidWcoXCJ3cml0aW5nIHBhY2tldCAlalwiLHBhY2tldCk7dmFyIHNlbGY9dGhpcztpZighc2VsZi5lbmNvZGluZyl7c2VsZi5lbmNvZGluZz10cnVlO3RoaXMuZW5jb2Rlci5lbmNvZGUocGFja2V0LGZ1bmN0aW9uKGVuY29kZWRQYWNrZXRzKXtmb3IodmFyIGk9MDtpPGVuY29kZWRQYWNrZXRzLmxlbmd0aDtpKyspe3NlbGYuZW5naW5lLndyaXRlKGVuY29kZWRQYWNrZXRzW2ldKX1zZWxmLmVuY29kaW5nPWZhbHNlO3NlbGYucHJvY2Vzc1BhY2tldFF1ZXVlKCl9KX1lbHNle3NlbGYucGFja2V0QnVmZmVyLnB1c2gocGFja2V0KX19O01hbmFnZXIucHJvdG90eXBlLnByb2Nlc3NQYWNrZXRRdWV1ZT1mdW5jdGlvbigpe2lmKHRoaXMucGFja2V0QnVmZmVyLmxlbmd0aD4wJiYhdGhpcy5lbmNvZGluZyl7dmFyIHBhY2s9dGhpcy5wYWNrZXRCdWZmZXIuc2hpZnQoKTt0aGlzLnBhY2tldChwYWNrKX19O01hbmFnZXIucHJvdG90eXBlLmNsZWFudXA9ZnVuY3Rpb24oKXt2YXIgc3ViO3doaWxlKHN1Yj10aGlzLnN1YnMuc2hpZnQoKSlzdWIuZGVzdHJveSgpO3RoaXMucGFja2V0QnVmZmVyPVtdO3RoaXMuZW5jb2Rpbmc9ZmFsc2U7dGhpcy5kZWNvZGVyLmRlc3Ryb3koKX07TWFuYWdlci5wcm90b3R5cGUuY2xvc2U9TWFuYWdlci5wcm90b3R5cGUuZGlzY29ubmVjdD1mdW5jdGlvbigpe3RoaXMuc2tpcFJlY29ubmVjdD10cnVlO3RoaXMuZW5naW5lLmNsb3NlKCl9O01hbmFnZXIucHJvdG90eXBlLm9uY2xvc2U9ZnVuY3Rpb24ocmVhc29uKXtkZWJ1ZyhcImNsb3NlXCIpO3RoaXMuY2xlYW51cCgpO3RoaXMucmVhZHlTdGF0ZT1cImNsb3NlZFwiO3RoaXMuZW1pdChcImNsb3NlXCIscmVhc29uKTtpZih0aGlzLl9yZWNvbm5lY3Rpb24mJiF0aGlzLnNraXBSZWNvbm5lY3Qpe3RoaXMucmVjb25uZWN0KCl9fTtNYW5hZ2VyLnByb3RvdHlwZS5yZWNvbm5lY3Q9ZnVuY3Rpb24oKXtpZih0aGlzLnJlY29ubmVjdGluZylyZXR1cm4gdGhpczt2YXIgc2VsZj10aGlzO3RoaXMuYXR0ZW1wdHMrKztpZih0aGlzLmF0dGVtcHRzPnRoaXMuX3JlY29ubmVjdGlvbkF0dGVtcHRzKXtkZWJ1ZyhcInJlY29ubmVjdCBmYWlsZWRcIik7dGhpcy5lbWl0QWxsKFwicmVjb25uZWN0X2ZhaWxlZFwiKTt0aGlzLnJlY29ubmVjdGluZz1mYWxzZX1lbHNle3ZhciBkZWxheT10aGlzLmF0dGVtcHRzKnRoaXMucmVjb25uZWN0aW9uRGVsYXkoKTtkZWxheT1NYXRoLm1pbihkZWxheSx0aGlzLnJlY29ubmVjdGlvbkRlbGF5TWF4KCkpO2RlYnVnKFwid2lsbCB3YWl0ICVkbXMgYmVmb3JlIHJlY29ubmVjdCBhdHRlbXB0XCIsZGVsYXkpO3RoaXMucmVjb25uZWN0aW5nPXRydWU7dmFyIHRpbWVyPXNldFRpbWVvdXQoZnVuY3Rpb24oKXtkZWJ1ZyhcImF0dGVtcHRpbmcgcmVjb25uZWN0XCIpO3NlbGYuZW1pdEFsbChcInJlY29ubmVjdF9hdHRlbXB0XCIsc2VsZi5hdHRlbXB0cyk7c2VsZi5lbWl0QWxsKFwicmVjb25uZWN0aW5nXCIsc2VsZi5hdHRlbXB0cyk7c2VsZi5vcGVuKGZ1bmN0aW9uKGVycil7aWYoZXJyKXtkZWJ1ZyhcInJlY29ubmVjdCBhdHRlbXB0IGVycm9yXCIpO3NlbGYucmVjb25uZWN0aW5nPWZhbHNlO3NlbGYucmVjb25uZWN0KCk7c2VsZi5lbWl0QWxsKFwicmVjb25uZWN0X2Vycm9yXCIsZXJyLmRhdGEpfWVsc2V7ZGVidWcoXCJyZWNvbm5lY3Qgc3VjY2Vzc1wiKTtzZWxmLm9ucmVjb25uZWN0KCl9fSl9LGRlbGF5KTt0aGlzLnN1YnMucHVzaCh7ZGVzdHJveTpmdW5jdGlvbigpe2NsZWFyVGltZW91dCh0aW1lcil9fSl9fTtNYW5hZ2VyLnByb3RvdHlwZS5vbnJlY29ubmVjdD1mdW5jdGlvbigpe3ZhciBhdHRlbXB0PXRoaXMuYXR0ZW1wdHM7dGhpcy5hdHRlbXB0cz0wO3RoaXMucmVjb25uZWN0aW5nPWZhbHNlO3RoaXMuZW1pdEFsbChcInJlY29ubmVjdFwiLGF0dGVtcHQpfX0se1wiLi9vblwiOjQsXCIuL3NvY2tldFwiOjUsXCIuL3VybFwiOjYsXCJjb21wb25lbnQtYmluZFwiOjcsXCJjb21wb25lbnQtZW1pdHRlclwiOjgsZGVidWc6OSxcImVuZ2luZS5pby1jbGllbnRcIjoxMCxcIm9iamVjdC1jb21wb25lbnRcIjozNyxcInNvY2tldC5pby1wYXJzZXJcIjo0MH1dLDQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe21vZHVsZS5leHBvcnRzPW9uO2Z1bmN0aW9uIG9uKG9iaixldixmbil7b2JqLm9uKGV2LGZuKTtyZXR1cm57ZGVzdHJveTpmdW5jdGlvbigpe29iai5yZW1vdmVMaXN0ZW5lcihldixmbil9fX19LHt9XSw1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXt2YXIgcGFyc2VyPV9kZXJlcV8oXCJzb2NrZXQuaW8tcGFyc2VyXCIpO3ZhciBFbWl0dGVyPV9kZXJlcV8oXCJjb21wb25lbnQtZW1pdHRlclwiKTt2YXIgdG9BcnJheT1fZGVyZXFfKFwidG8tYXJyYXlcIik7dmFyIG9uPV9kZXJlcV8oXCIuL29uXCIpO3ZhciBiaW5kPV9kZXJlcV8oXCJjb21wb25lbnQtYmluZFwiKTt2YXIgZGVidWc9X2RlcmVxXyhcImRlYnVnXCIpKFwic29ja2V0LmlvLWNsaWVudDpzb2NrZXRcIik7dmFyIGhhc0Jpbj1fZGVyZXFfKFwiaGFzLWJpbmFyeVwiKTt2YXIgaW5kZXhPZj1fZGVyZXFfKFwiaW5kZXhvZlwiKTttb2R1bGUuZXhwb3J0cz1leHBvcnRzPVNvY2tldDt2YXIgZXZlbnRzPXtjb25uZWN0OjEsY29ubmVjdF9lcnJvcjoxLGNvbm5lY3RfdGltZW91dDoxLGRpc2Nvbm5lY3Q6MSxlcnJvcjoxLHJlY29ubmVjdDoxLHJlY29ubmVjdF9hdHRlbXB0OjEscmVjb25uZWN0X2ZhaWxlZDoxLHJlY29ubmVjdF9lcnJvcjoxLHJlY29ubmVjdGluZzoxfTt2YXIgZW1pdD1FbWl0dGVyLnByb3RvdHlwZS5lbWl0O2Z1bmN0aW9uIFNvY2tldChpbyxuc3Ape3RoaXMuaW89aW87dGhpcy5uc3A9bnNwO3RoaXMuanNvbj10aGlzO3RoaXMuaWRzPTA7dGhpcy5hY2tzPXt9O2lmKHRoaXMuaW8uYXV0b0Nvbm5lY3QpdGhpcy5vcGVuKCk7dGhpcy5yZWNlaXZlQnVmZmVyPVtdO3RoaXMuc2VuZEJ1ZmZlcj1bXTt0aGlzLmNvbm5lY3RlZD1mYWxzZTt0aGlzLmRpc2Nvbm5lY3RlZD10cnVlO3RoaXMuc3ViRXZlbnRzKCl9RW1pdHRlcihTb2NrZXQucHJvdG90eXBlKTtTb2NrZXQucHJvdG90eXBlLnN1YkV2ZW50cz1mdW5jdGlvbigpe3ZhciBpbz10aGlzLmlvO3RoaXMuc3Vicz1bb24oaW8sXCJvcGVuXCIsYmluZCh0aGlzLFwib25vcGVuXCIpKSxvbihpbyxcInBhY2tldFwiLGJpbmQodGhpcyxcIm9ucGFja2V0XCIpKSxvbihpbyxcImNsb3NlXCIsYmluZCh0aGlzLFwib25jbG9zZVwiKSldfTtTb2NrZXQucHJvdG90eXBlLm9wZW49U29ja2V0LnByb3RvdHlwZS5jb25uZWN0PWZ1bmN0aW9uKCl7aWYodGhpcy5jb25uZWN0ZWQpcmV0dXJuIHRoaXM7dGhpcy5pby5vcGVuKCk7aWYoXCJvcGVuXCI9PXRoaXMuaW8ucmVhZHlTdGF0ZSl0aGlzLm9ub3BlbigpO3JldHVybiB0aGlzfTtTb2NrZXQucHJvdG90eXBlLnNlbmQ9ZnVuY3Rpb24oKXt2YXIgYXJncz10b0FycmF5KGFyZ3VtZW50cyk7YXJncy51bnNoaWZ0KFwibWVzc2FnZVwiKTt0aGlzLmVtaXQuYXBwbHkodGhpcyxhcmdzKTtyZXR1cm4gdGhpc307U29ja2V0LnByb3RvdHlwZS5lbWl0PWZ1bmN0aW9uKGV2KXtpZihldmVudHMuaGFzT3duUHJvcGVydHkoZXYpKXtlbWl0LmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm4gdGhpc312YXIgYXJncz10b0FycmF5KGFyZ3VtZW50cyk7dmFyIHBhcnNlclR5cGU9cGFyc2VyLkVWRU5UO2lmKGhhc0JpbihhcmdzKSl7cGFyc2VyVHlwZT1wYXJzZXIuQklOQVJZX0VWRU5UfXZhciBwYWNrZXQ9e3R5cGU6cGFyc2VyVHlwZSxkYXRhOmFyZ3N9O2lmKFwiZnVuY3Rpb25cIj09dHlwZW9mIGFyZ3NbYXJncy5sZW5ndGgtMV0pe2RlYnVnKFwiZW1pdHRpbmcgcGFja2V0IHdpdGggYWNrIGlkICVkXCIsdGhpcy5pZHMpO3RoaXMuYWNrc1t0aGlzLmlkc109YXJncy5wb3AoKTtwYWNrZXQuaWQ9dGhpcy5pZHMrK31pZih0aGlzLmNvbm5lY3RlZCl7dGhpcy5wYWNrZXQocGFja2V0KX1lbHNle3RoaXMuc2VuZEJ1ZmZlci5wdXNoKHBhY2tldCl9cmV0dXJuIHRoaXN9O1NvY2tldC5wcm90b3R5cGUucGFja2V0PWZ1bmN0aW9uKHBhY2tldCl7cGFja2V0Lm5zcD10aGlzLm5zcDt0aGlzLmlvLnBhY2tldChwYWNrZXQpfTtTb2NrZXQucHJvdG90eXBlLm9ub3Blbj1mdW5jdGlvbigpe2RlYnVnKFwidHJhbnNwb3J0IGlzIG9wZW4gLSBjb25uZWN0aW5nXCIpO2lmKFwiL1wiIT10aGlzLm5zcCl7dGhpcy5wYWNrZXQoe3R5cGU6cGFyc2VyLkNPTk5FQ1R9KX19O1NvY2tldC5wcm90b3R5cGUub25jbG9zZT1mdW5jdGlvbihyZWFzb24pe2RlYnVnKFwiY2xvc2UgKCVzKVwiLHJlYXNvbik7dGhpcy5jb25uZWN0ZWQ9ZmFsc2U7dGhpcy5kaXNjb25uZWN0ZWQ9dHJ1ZTt0aGlzLmVtaXQoXCJkaXNjb25uZWN0XCIscmVhc29uKX07U29ja2V0LnByb3RvdHlwZS5vbnBhY2tldD1mdW5jdGlvbihwYWNrZXQpe2lmKHBhY2tldC5uc3AhPXRoaXMubnNwKXJldHVybjtzd2l0Y2gocGFja2V0LnR5cGUpe2Nhc2UgcGFyc2VyLkNPTk5FQ1Q6dGhpcy5vbmNvbm5lY3QoKTticmVhaztjYXNlIHBhcnNlci5FVkVOVDp0aGlzLm9uZXZlbnQocGFja2V0KTticmVhaztjYXNlIHBhcnNlci5CSU5BUllfRVZFTlQ6dGhpcy5vbmV2ZW50KHBhY2tldCk7YnJlYWs7Y2FzZSBwYXJzZXIuQUNLOnRoaXMub25hY2socGFja2V0KTticmVhaztjYXNlIHBhcnNlci5CSU5BUllfQUNLOnRoaXMub25hY2socGFja2V0KTticmVhaztjYXNlIHBhcnNlci5ESVNDT05ORUNUOnRoaXMub25kaXNjb25uZWN0KCk7YnJlYWs7Y2FzZSBwYXJzZXIuRVJST1I6dGhpcy5lbWl0KFwiZXJyb3JcIixwYWNrZXQuZGF0YSk7YnJlYWt9fTtTb2NrZXQucHJvdG90eXBlLm9uZXZlbnQ9ZnVuY3Rpb24ocGFja2V0KXt2YXIgYXJncz1wYWNrZXQuZGF0YXx8W107ZGVidWcoXCJlbWl0dGluZyBldmVudCAlalwiLGFyZ3MpO2lmKG51bGwhPXBhY2tldC5pZCl7ZGVidWcoXCJhdHRhY2hpbmcgYWNrIGNhbGxiYWNrIHRvIGV2ZW50XCIpO2FyZ3MucHVzaCh0aGlzLmFjayhwYWNrZXQuaWQpKX1pZih0aGlzLmNvbm5lY3RlZCl7ZW1pdC5hcHBseSh0aGlzLGFyZ3MpfWVsc2V7dGhpcy5yZWNlaXZlQnVmZmVyLnB1c2goYXJncyl9fTtTb2NrZXQucHJvdG90eXBlLmFjaz1mdW5jdGlvbihpZCl7dmFyIHNlbGY9dGhpczt2YXIgc2VudD1mYWxzZTtyZXR1cm4gZnVuY3Rpb24oKXtpZihzZW50KXJldHVybjtzZW50PXRydWU7dmFyIGFyZ3M9dG9BcnJheShhcmd1bWVudHMpO2RlYnVnKFwic2VuZGluZyBhY2sgJWpcIixhcmdzKTt2YXIgdHlwZT1oYXNCaW4oYXJncyk/cGFyc2VyLkJJTkFSWV9BQ0s6cGFyc2VyLkFDSztzZWxmLnBhY2tldCh7dHlwZTp0eXBlLGlkOmlkLGRhdGE6YXJnc30pfX07U29ja2V0LnByb3RvdHlwZS5vbmFjaz1mdW5jdGlvbihwYWNrZXQpe2RlYnVnKFwiY2FsbGluZyBhY2sgJXMgd2l0aCAlalwiLHBhY2tldC5pZCxwYWNrZXQuZGF0YSk7dmFyIGZuPXRoaXMuYWNrc1twYWNrZXQuaWRdO2ZuLmFwcGx5KHRoaXMscGFja2V0LmRhdGEpO2RlbGV0ZSB0aGlzLmFja3NbcGFja2V0LmlkXX07U29ja2V0LnByb3RvdHlwZS5vbmNvbm5lY3Q9ZnVuY3Rpb24oKXt0aGlzLmNvbm5lY3RlZD10cnVlO3RoaXMuZGlzY29ubmVjdGVkPWZhbHNlO3RoaXMuZW1pdChcImNvbm5lY3RcIik7dGhpcy5lbWl0QnVmZmVyZWQoKX07U29ja2V0LnByb3RvdHlwZS5lbWl0QnVmZmVyZWQ9ZnVuY3Rpb24oKXt2YXIgaTtmb3IoaT0wO2k8dGhpcy5yZWNlaXZlQnVmZmVyLmxlbmd0aDtpKyspe2VtaXQuYXBwbHkodGhpcyx0aGlzLnJlY2VpdmVCdWZmZXJbaV0pfXRoaXMucmVjZWl2ZUJ1ZmZlcj1bXTtmb3IoaT0wO2k8dGhpcy5zZW5kQnVmZmVyLmxlbmd0aDtpKyspe3RoaXMucGFja2V0KHRoaXMuc2VuZEJ1ZmZlcltpXSl9dGhpcy5zZW5kQnVmZmVyPVtdfTtTb2NrZXQucHJvdG90eXBlLm9uZGlzY29ubmVjdD1mdW5jdGlvbigpe2RlYnVnKFwic2VydmVyIGRpc2Nvbm5lY3QgKCVzKVwiLHRoaXMubnNwKTt0aGlzLmRlc3Ryb3koKTt0aGlzLm9uY2xvc2UoXCJpbyBzZXJ2ZXIgZGlzY29ubmVjdFwiKX07U29ja2V0LnByb3RvdHlwZS5kZXN0cm95PWZ1bmN0aW9uKCl7Zm9yKHZhciBpPTA7aTx0aGlzLnN1YnMubGVuZ3RoO2krKyl7dGhpcy5zdWJzW2ldLmRlc3Ryb3koKX10aGlzLmlvLmRlc3Ryb3kodGhpcyl9O1NvY2tldC5wcm90b3R5cGUuY2xvc2U9U29ja2V0LnByb3RvdHlwZS5kaXNjb25uZWN0PWZ1bmN0aW9uKCl7aWYoIXRoaXMuY29ubmVjdGVkKXJldHVybiB0aGlzO2RlYnVnKFwicGVyZm9ybWluZyBkaXNjb25uZWN0ICglcylcIix0aGlzLm5zcCk7dGhpcy5wYWNrZXQoe3R5cGU6cGFyc2VyLkRJU0NPTk5FQ1R9KTt0aGlzLmRlc3Ryb3koKTt0aGlzLm9uY2xvc2UoXCJpbyBjbGllbnQgZGlzY29ubmVjdFwiKTtyZXR1cm4gdGhpc319LHtcIi4vb25cIjo0LFwiY29tcG9uZW50LWJpbmRcIjo3LFwiY29tcG9uZW50LWVtaXR0ZXJcIjo4LGRlYnVnOjksXCJoYXMtYmluYXJ5XCI6MzIsaW5kZXhvZjozNixcInNvY2tldC5pby1wYXJzZXJcIjo0MCxcInRvLWFycmF5XCI6NDR9XSw2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsoZnVuY3Rpb24oZ2xvYmFsKXt2YXIgcGFyc2V1cmk9X2RlcmVxXyhcInBhcnNldXJpXCIpO3ZhciBkZWJ1Zz1fZGVyZXFfKFwiZGVidWdcIikoXCJzb2NrZXQuaW8tY2xpZW50OnVybFwiKTttb2R1bGUuZXhwb3J0cz11cmw7ZnVuY3Rpb24gdXJsKHVyaSxsb2Mpe3ZhciBvYmo9dXJpO3ZhciBsb2M9bG9jfHxnbG9iYWwubG9jYXRpb247aWYobnVsbD09dXJpKXVyaT1sb2MucHJvdG9jb2wrXCIvL1wiK2xvYy5ob3N0bmFtZTtpZihcInN0cmluZ1wiPT10eXBlb2YgdXJpKXtpZihcIi9cIj09dXJpLmNoYXJBdCgwKSl7aWYoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGxvYyl7dXJpPWxvYy5ob3N0bmFtZSt1cml9fWlmKCEvXihodHRwcz98d3NzPyk6XFwvXFwvLy50ZXN0KHVyaSkpe2RlYnVnKFwicHJvdG9jb2wtbGVzcyB1cmwgJXNcIix1cmkpO2lmKFwidW5kZWZpbmVkXCIhPXR5cGVvZiBsb2Mpe3VyaT1sb2MucHJvdG9jb2wrXCIvL1wiK3VyaX1lbHNle3VyaT1cImh0dHBzOi8vXCIrdXJpfX1kZWJ1ZyhcInBhcnNlICVzXCIsdXJpKTtvYmo9cGFyc2V1cmkodXJpKX1pZighb2JqLnBvcnQpe2lmKC9eKGh0dHB8d3MpJC8udGVzdChvYmoucHJvdG9jb2wpKXtvYmoucG9ydD1cIjgwXCJ9ZWxzZSBpZigvXihodHRwfHdzKXMkLy50ZXN0KG9iai5wcm90b2NvbCkpe29iai5wb3J0PVwiNDQzXCJ9fW9iai5wYXRoPW9iai5wYXRofHxcIi9cIjtvYmouaWQ9b2JqLnByb3RvY29sK1wiOi8vXCIrb2JqLmhvc3QrXCI6XCIrb2JqLnBvcnQ7b2JqLmhyZWY9b2JqLnByb3RvY29sK1wiOi8vXCIrb2JqLmhvc3QrKGxvYyYmbG9jLnBvcnQ9PW9iai5wb3J0P1wiXCI6XCI6XCIrb2JqLnBvcnQpO3JldHVybiBvYmp9fSkuY2FsbCh0aGlzLHR5cGVvZiBzZWxmIT09XCJ1bmRlZmluZWRcIj9zZWxmOnR5cGVvZiB3aW5kb3chPT1cInVuZGVmaW5lZFwiP3dpbmRvdzp7fSl9LHtkZWJ1Zzo5LHBhcnNldXJpOjM4fV0sNzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7dmFyIHNsaWNlPVtdLnNsaWNlO21vZHVsZS5leHBvcnRzPWZ1bmN0aW9uKG9iaixmbil7aWYoXCJzdHJpbmdcIj09dHlwZW9mIGZuKWZuPW9ialtmbl07aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgZm4pdGhyb3cgbmV3IEVycm9yKFwiYmluZCgpIHJlcXVpcmVzIGEgZnVuY3Rpb25cIik7dmFyIGFyZ3M9c2xpY2UuY2FsbChhcmd1bWVudHMsMik7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGZuLmFwcGx5KG9iaixhcmdzLmNvbmNhdChzbGljZS5jYWxsKGFyZ3VtZW50cykpKX19fSx7fV0sODpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7bW9kdWxlLmV4cG9ydHM9RW1pdHRlcjtmdW5jdGlvbiBFbWl0dGVyKG9iail7aWYob2JqKXJldHVybiBtaXhpbihvYmopfWZ1bmN0aW9uIG1peGluKG9iail7Zm9yKHZhciBrZXkgaW4gRW1pdHRlci5wcm90b3R5cGUpe29ialtrZXldPUVtaXR0ZXIucHJvdG90eXBlW2tleV19cmV0dXJuIG9ian1FbWl0dGVyLnByb3RvdHlwZS5vbj1FbWl0dGVyLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyPWZ1bmN0aW9uKGV2ZW50LGZuKXt0aGlzLl9jYWxsYmFja3M9dGhpcy5fY2FsbGJhY2tzfHx7fTsodGhpcy5fY2FsbGJhY2tzW2V2ZW50XT10aGlzLl9jYWxsYmFja3NbZXZlbnRdfHxbXSkucHVzaChmbik7cmV0dXJuIHRoaXN9O0VtaXR0ZXIucHJvdG90eXBlLm9uY2U9ZnVuY3Rpb24oZXZlbnQsZm4pe3ZhciBzZWxmPXRoaXM7dGhpcy5fY2FsbGJhY2tzPXRoaXMuX2NhbGxiYWNrc3x8e307ZnVuY3Rpb24gb24oKXtzZWxmLm9mZihldmVudCxvbik7Zm4uYXBwbHkodGhpcyxhcmd1bWVudHMpfW9uLmZuPWZuO3RoaXMub24oZXZlbnQsb24pO3JldHVybiB0aGlzfTtFbWl0dGVyLnByb3RvdHlwZS5vZmY9RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXI9RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlQWxsTGlzdGVuZXJzPUVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXI9ZnVuY3Rpb24oZXZlbnQsZm4pe3RoaXMuX2NhbGxiYWNrcz10aGlzLl9jYWxsYmFja3N8fHt9O2lmKDA9PWFyZ3VtZW50cy5sZW5ndGgpe3RoaXMuX2NhbGxiYWNrcz17fTtyZXR1cm4gdGhpc312YXIgY2FsbGJhY2tzPXRoaXMuX2NhbGxiYWNrc1tldmVudF07aWYoIWNhbGxiYWNrcylyZXR1cm4gdGhpcztpZigxPT1hcmd1bWVudHMubGVuZ3RoKXtkZWxldGUgdGhpcy5fY2FsbGJhY2tzW2V2ZW50XTtyZXR1cm4gdGhpc312YXIgY2I7Zm9yKHZhciBpPTA7aTxjYWxsYmFja3MubGVuZ3RoO2krKyl7Y2I9Y2FsbGJhY2tzW2ldO2lmKGNiPT09Zm58fGNiLmZuPT09Zm4pe2NhbGxiYWNrcy5zcGxpY2UoaSwxKTticmVha319cmV0dXJuIHRoaXN9O0VtaXR0ZXIucHJvdG90eXBlLmVtaXQ9ZnVuY3Rpb24oZXZlbnQpe3RoaXMuX2NhbGxiYWNrcz10aGlzLl9jYWxsYmFja3N8fHt9O3ZhciBhcmdzPVtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLGNhbGxiYWNrcz10aGlzLl9jYWxsYmFja3NbZXZlbnRdO2lmKGNhbGxiYWNrcyl7Y2FsbGJhY2tzPWNhbGxiYWNrcy5zbGljZSgwKTtmb3IodmFyIGk9MCxsZW49Y2FsbGJhY2tzLmxlbmd0aDtpPGxlbjsrK2kpe2NhbGxiYWNrc1tpXS5hcHBseSh0aGlzLGFyZ3MpfX1yZXR1cm4gdGhpc307RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJzPWZ1bmN0aW9uKGV2ZW50KXt0aGlzLl9jYWxsYmFja3M9dGhpcy5fY2FsbGJhY2tzfHx7fTtyZXR1cm4gdGhpcy5fY2FsbGJhY2tzW2V2ZW50XXx8W119O0VtaXR0ZXIucHJvdG90eXBlLmhhc0xpc3RlbmVycz1mdW5jdGlvbihldmVudCl7cmV0dXJuISF0aGlzLmxpc3RlbmVycyhldmVudCkubGVuZ3RofX0se31dLDk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe21vZHVsZS5leHBvcnRzPWRlYnVnO2Z1bmN0aW9uIGRlYnVnKG5hbWUpe2lmKCFkZWJ1Zy5lbmFibGVkKG5hbWUpKXJldHVybiBmdW5jdGlvbigpe307cmV0dXJuIGZ1bmN0aW9uKGZtdCl7Zm10PWNvZXJjZShmbXQpO3ZhciBjdXJyPW5ldyBEYXRlO3ZhciBtcz1jdXJyLShkZWJ1Z1tuYW1lXXx8Y3Vycik7ZGVidWdbbmFtZV09Y3VycjtmbXQ9bmFtZStcIiBcIitmbXQrXCIgK1wiK2RlYnVnLmh1bWFuaXplKG1zKTt3aW5kb3cuY29uc29sZSYmY29uc29sZS5sb2cmJkZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseS5jYWxsKGNvbnNvbGUubG9nLGNvbnNvbGUsYXJndW1lbnRzKX19ZGVidWcubmFtZXM9W107ZGVidWcuc2tpcHM9W107ZGVidWcuZW5hYmxlPWZ1bmN0aW9uKG5hbWUpe3RyeXtsb2NhbFN0b3JhZ2UuZGVidWc9bmFtZX1jYXRjaChlKXt9dmFyIHNwbGl0PShuYW1lfHxcIlwiKS5zcGxpdCgvW1xccyxdKy8pLGxlbj1zcGxpdC5sZW5ndGg7Zm9yKHZhciBpPTA7aTxsZW47aSsrKXtuYW1lPXNwbGl0W2ldLnJlcGxhY2UoXCIqXCIsXCIuKj9cIik7aWYobmFtZVswXT09PVwiLVwiKXtkZWJ1Zy5za2lwcy5wdXNoKG5ldyBSZWdFeHAoXCJeXCIrbmFtZS5zdWJzdHIoMSkrXCIkXCIpKX1lbHNle2RlYnVnLm5hbWVzLnB1c2gobmV3IFJlZ0V4cChcIl5cIituYW1lK1wiJFwiKSl9fX07ZGVidWcuZGlzYWJsZT1mdW5jdGlvbigpe2RlYnVnLmVuYWJsZShcIlwiKX07ZGVidWcuaHVtYW5pemU9ZnVuY3Rpb24obXMpe3ZhciBzZWM9MWUzLG1pbj02MCoxZTMsaG91cj02MCptaW47aWYobXM+PWhvdXIpcmV0dXJuKG1zL2hvdXIpLnRvRml4ZWQoMSkrXCJoXCI7aWYobXM+PW1pbilyZXR1cm4obXMvbWluKS50b0ZpeGVkKDEpK1wibVwiO2lmKG1zPj1zZWMpcmV0dXJuKG1zL3NlY3wwKStcInNcIjtyZXR1cm4gbXMrXCJtc1wifTtkZWJ1Zy5lbmFibGVkPWZ1bmN0aW9uKG5hbWUpe2Zvcih2YXIgaT0wLGxlbj1kZWJ1Zy5za2lwcy5sZW5ndGg7aTxsZW47aSsrKXtpZihkZWJ1Zy5za2lwc1tpXS50ZXN0KG5hbWUpKXtyZXR1cm4gZmFsc2V9fWZvcih2YXIgaT0wLGxlbj1kZWJ1Zy5uYW1lcy5sZW5ndGg7aTxsZW47aSsrKXtpZihkZWJ1Zy5uYW1lc1tpXS50ZXN0KG5hbWUpKXtyZXR1cm4gdHJ1ZX19cmV0dXJuIGZhbHNlfTtmdW5jdGlvbiBjb2VyY2UodmFsKXtpZih2YWwgaW5zdGFuY2VvZiBFcnJvcilyZXR1cm4gdmFsLnN0YWNrfHx2YWwubWVzc2FnZTtyZXR1cm4gdmFsfXRyeXtpZih3aW5kb3cubG9jYWxTdG9yYWdlKWRlYnVnLmVuYWJsZShsb2NhbFN0b3JhZ2UuZGVidWcpfWNhdGNoKGUpe319LHt9XSwxMDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7bW9kdWxlLmV4cG9ydHM9X2RlcmVxXyhcIi4vbGliL1wiKX0se1wiLi9saWIvXCI6MTF9XSwxMTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7bW9kdWxlLmV4cG9ydHM9X2RlcmVxXyhcIi4vc29ja2V0XCIpO21vZHVsZS5leHBvcnRzLnBhcnNlcj1fZGVyZXFfKFwiZW5naW5lLmlvLXBhcnNlclwiKX0se1wiLi9zb2NrZXRcIjoxMixcImVuZ2luZS5pby1wYXJzZXJcIjoyMX1dLDEyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsoZnVuY3Rpb24oZ2xvYmFsKXt2YXIgdHJhbnNwb3J0cz1fZGVyZXFfKFwiLi90cmFuc3BvcnRzXCIpO3ZhciBFbWl0dGVyPV9kZXJlcV8oXCJjb21wb25lbnQtZW1pdHRlclwiKTt2YXIgZGVidWc9X2RlcmVxXyhcImRlYnVnXCIpKFwiZW5naW5lLmlvLWNsaWVudDpzb2NrZXRcIik7dmFyIGluZGV4PV9kZXJlcV8oXCJpbmRleG9mXCIpO3ZhciBwYXJzZXI9X2RlcmVxXyhcImVuZ2luZS5pby1wYXJzZXJcIik7dmFyIHBhcnNldXJpPV9kZXJlcV8oXCJwYXJzZXVyaVwiKTt2YXIgcGFyc2Vqc29uPV9kZXJlcV8oXCJwYXJzZWpzb25cIik7dmFyIHBhcnNlcXM9X2RlcmVxXyhcInBhcnNlcXNcIik7bW9kdWxlLmV4cG9ydHM9U29ja2V0O2Z1bmN0aW9uIG5vb3AoKXt9ZnVuY3Rpb24gU29ja2V0KHVyaSxvcHRzKXtpZighKHRoaXMgaW5zdGFuY2VvZiBTb2NrZXQpKXJldHVybiBuZXcgU29ja2V0KHVyaSxvcHRzKTtvcHRzPW9wdHN8fHt9O2lmKHVyaSYmXCJvYmplY3RcIj09dHlwZW9mIHVyaSl7b3B0cz11cmk7dXJpPW51bGx9aWYodXJpKXt1cmk9cGFyc2V1cmkodXJpKTtvcHRzLmhvc3Q9dXJpLmhvc3Q7b3B0cy5zZWN1cmU9dXJpLnByb3RvY29sPT1cImh0dHBzXCJ8fHVyaS5wcm90b2NvbD09XCJ3c3NcIjtvcHRzLnBvcnQ9dXJpLnBvcnQ7aWYodXJpLnF1ZXJ5KW9wdHMucXVlcnk9dXJpLnF1ZXJ5fXRoaXMuc2VjdXJlPW51bGwhPW9wdHMuc2VjdXJlP29wdHMuc2VjdXJlOmdsb2JhbC5sb2NhdGlvbiYmXCJodHRwczpcIj09bG9jYXRpb24ucHJvdG9jb2w7aWYob3B0cy5ob3N0KXt2YXIgcGllY2VzPW9wdHMuaG9zdC5zcGxpdChcIjpcIik7b3B0cy5ob3N0bmFtZT1waWVjZXMuc2hpZnQoKTtpZihwaWVjZXMubGVuZ3RoKW9wdHMucG9ydD1waWVjZXMucG9wKCl9dGhpcy5hZ2VudD1vcHRzLmFnZW50fHxmYWxzZTt0aGlzLmhvc3RuYW1lPW9wdHMuaG9zdG5hbWV8fChnbG9iYWwubG9jYXRpb24/bG9jYXRpb24uaG9zdG5hbWU6XCJsb2NhbGhvc3RcIik7dGhpcy5wb3J0PW9wdHMucG9ydHx8KGdsb2JhbC5sb2NhdGlvbiYmbG9jYXRpb24ucG9ydD9sb2NhdGlvbi5wb3J0OnRoaXMuc2VjdXJlPzQ0Mzo4MCk7dGhpcy5xdWVyeT1vcHRzLnF1ZXJ5fHx7fTtpZihcInN0cmluZ1wiPT10eXBlb2YgdGhpcy5xdWVyeSl0aGlzLnF1ZXJ5PXBhcnNlcXMuZGVjb2RlKHRoaXMucXVlcnkpO3RoaXMudXBncmFkZT1mYWxzZSE9PW9wdHMudXBncmFkZTt0aGlzLnBhdGg9KG9wdHMucGF0aHx8XCIvZW5naW5lLmlvXCIpLnJlcGxhY2UoL1xcLyQvLFwiXCIpK1wiL1wiO3RoaXMuZm9yY2VKU09OUD0hIW9wdHMuZm9yY2VKU09OUDt0aGlzLmpzb25wPWZhbHNlIT09b3B0cy5qc29ucDt0aGlzLmZvcmNlQmFzZTY0PSEhb3B0cy5mb3JjZUJhc2U2NDt0aGlzLmVuYWJsZXNYRFI9ISFvcHRzLmVuYWJsZXNYRFI7dGhpcy50aW1lc3RhbXBQYXJhbT1vcHRzLnRpbWVzdGFtcFBhcmFtfHxcInRcIjt0aGlzLnRpbWVzdGFtcFJlcXVlc3RzPW9wdHMudGltZXN0YW1wUmVxdWVzdHM7dGhpcy50cmFuc3BvcnRzPW9wdHMudHJhbnNwb3J0c3x8W1wicG9sbGluZ1wiLFwid2Vic29ja2V0XCJdO3RoaXMucmVhZHlTdGF0ZT1cIlwiO3RoaXMud3JpdGVCdWZmZXI9W107dGhpcy5jYWxsYmFja0J1ZmZlcj1bXTt0aGlzLnBvbGljeVBvcnQ9b3B0cy5wb2xpY3lQb3J0fHw4NDM7dGhpcy5yZW1lbWJlclVwZ3JhZGU9b3B0cy5yZW1lbWJlclVwZ3JhZGV8fGZhbHNlO3RoaXMub3BlbigpO3RoaXMuYmluYXJ5VHlwZT1udWxsO3RoaXMub25seUJpbmFyeVVwZ3JhZGVzPW9wdHMub25seUJpbmFyeVVwZ3JhZGVzfVNvY2tldC5wcmlvcldlYnNvY2tldFN1Y2Nlc3M9ZmFsc2U7RW1pdHRlcihTb2NrZXQucHJvdG90eXBlKTtTb2NrZXQucHJvdG9jb2w9cGFyc2VyLnByb3RvY29sO1NvY2tldC5Tb2NrZXQ9U29ja2V0O1NvY2tldC5UcmFuc3BvcnQ9X2RlcmVxXyhcIi4vdHJhbnNwb3J0XCIpO1NvY2tldC50cmFuc3BvcnRzPV9kZXJlcV8oXCIuL3RyYW5zcG9ydHNcIik7U29ja2V0LnBhcnNlcj1fZGVyZXFfKFwiZW5naW5lLmlvLXBhcnNlclwiKTtTb2NrZXQucHJvdG90eXBlLmNyZWF0ZVRyYW5zcG9ydD1mdW5jdGlvbihuYW1lKXtkZWJ1ZygnY3JlYXRpbmcgdHJhbnNwb3J0IFwiJXNcIicsbmFtZSk7dmFyIHF1ZXJ5PWNsb25lKHRoaXMucXVlcnkpO3F1ZXJ5LkVJTz1wYXJzZXIucHJvdG9jb2w7cXVlcnkudHJhbnNwb3J0PW5hbWU7aWYodGhpcy5pZClxdWVyeS5zaWQ9dGhpcy5pZDt2YXIgdHJhbnNwb3J0PW5ldyB0cmFuc3BvcnRzW25hbWVdKHthZ2VudDp0aGlzLmFnZW50LGhvc3RuYW1lOnRoaXMuaG9zdG5hbWUscG9ydDp0aGlzLnBvcnQsc2VjdXJlOnRoaXMuc2VjdXJlLHBhdGg6dGhpcy5wYXRoLHF1ZXJ5OnF1ZXJ5LGZvcmNlSlNPTlA6dGhpcy5mb3JjZUpTT05QLGpzb25wOnRoaXMuanNvbnAsZm9yY2VCYXNlNjQ6dGhpcy5mb3JjZUJhc2U2NCxlbmFibGVzWERSOnRoaXMuZW5hYmxlc1hEUix0aW1lc3RhbXBSZXF1ZXN0czp0aGlzLnRpbWVzdGFtcFJlcXVlc3RzLHRpbWVzdGFtcFBhcmFtOnRoaXMudGltZXN0YW1wUGFyYW0scG9saWN5UG9ydDp0aGlzLnBvbGljeVBvcnQsc29ja2V0OnRoaXN9KTtyZXR1cm4gdHJhbnNwb3J0fTtmdW5jdGlvbiBjbG9uZShvYmope3ZhciBvPXt9O2Zvcih2YXIgaSBpbiBvYmope2lmKG9iai5oYXNPd25Qcm9wZXJ0eShpKSl7b1tpXT1vYmpbaV19fXJldHVybiBvfVNvY2tldC5wcm90b3R5cGUub3Blbj1mdW5jdGlvbigpe3ZhciB0cmFuc3BvcnQ7aWYodGhpcy5yZW1lbWJlclVwZ3JhZGUmJlNvY2tldC5wcmlvcldlYnNvY2tldFN1Y2Nlc3MmJnRoaXMudHJhbnNwb3J0cy5pbmRleE9mKFwid2Vic29ja2V0XCIpIT0tMSl7dHJhbnNwb3J0PVwid2Vic29ja2V0XCJ9ZWxzZSBpZigwPT10aGlzLnRyYW5zcG9ydHMubGVuZ3RoKXt2YXIgc2VsZj10aGlzO3NldFRpbWVvdXQoZnVuY3Rpb24oKXtzZWxmLmVtaXQoXCJlcnJvclwiLFwiTm8gdHJhbnNwb3J0cyBhdmFpbGFibGVcIil9LDApO3JldHVybn1lbHNle3RyYW5zcG9ydD10aGlzLnRyYW5zcG9ydHNbMF19dGhpcy5yZWFkeVN0YXRlPVwib3BlbmluZ1wiO3ZhciB0cmFuc3BvcnQ7dHJ5e3RyYW5zcG9ydD10aGlzLmNyZWF0ZVRyYW5zcG9ydCh0cmFuc3BvcnQpfWNhdGNoKGUpe3RoaXMudHJhbnNwb3J0cy5zaGlmdCgpO3RoaXMub3BlbigpO3JldHVybn10cmFuc3BvcnQub3BlbigpO3RoaXMuc2V0VHJhbnNwb3J0KHRyYW5zcG9ydCl9O1NvY2tldC5wcm90b3R5cGUuc2V0VHJhbnNwb3J0PWZ1bmN0aW9uKHRyYW5zcG9ydCl7ZGVidWcoXCJzZXR0aW5nIHRyYW5zcG9ydCAlc1wiLHRyYW5zcG9ydC5uYW1lKTt2YXIgc2VsZj10aGlzO2lmKHRoaXMudHJhbnNwb3J0KXtkZWJ1ZyhcImNsZWFyaW5nIGV4aXN0aW5nIHRyYW5zcG9ydCAlc1wiLHRoaXMudHJhbnNwb3J0Lm5hbWUpO3RoaXMudHJhbnNwb3J0LnJlbW92ZUFsbExpc3RlbmVycygpfXRoaXMudHJhbnNwb3J0PXRyYW5zcG9ydDt0cmFuc3BvcnQub24oXCJkcmFpblwiLGZ1bmN0aW9uKCl7c2VsZi5vbkRyYWluKCl9KS5vbihcInBhY2tldFwiLGZ1bmN0aW9uKHBhY2tldCl7c2VsZi5vblBhY2tldChwYWNrZXQpfSkub24oXCJlcnJvclwiLGZ1bmN0aW9uKGUpe3NlbGYub25FcnJvcihlKX0pLm9uKFwiY2xvc2VcIixmdW5jdGlvbigpe3NlbGYub25DbG9zZShcInRyYW5zcG9ydCBjbG9zZVwiKX0pfTtTb2NrZXQucHJvdG90eXBlLnByb2JlPWZ1bmN0aW9uKG5hbWUpe2RlYnVnKCdwcm9iaW5nIHRyYW5zcG9ydCBcIiVzXCInLG5hbWUpO3ZhciB0cmFuc3BvcnQ9dGhpcy5jcmVhdGVUcmFuc3BvcnQobmFtZSx7cHJvYmU6MX0pLGZhaWxlZD1mYWxzZSxzZWxmPXRoaXM7U29ja2V0LnByaW9yV2Vic29ja2V0U3VjY2Vzcz1mYWxzZTtmdW5jdGlvbiBvblRyYW5zcG9ydE9wZW4oKXtpZihzZWxmLm9ubHlCaW5hcnlVcGdyYWRlcyl7dmFyIHVwZ3JhZGVMb3Nlc0JpbmFyeT0hdGhpcy5zdXBwb3J0c0JpbmFyeSYmc2VsZi50cmFuc3BvcnQuc3VwcG9ydHNCaW5hcnk7ZmFpbGVkPWZhaWxlZHx8dXBncmFkZUxvc2VzQmluYXJ5fWlmKGZhaWxlZClyZXR1cm47ZGVidWcoJ3Byb2JlIHRyYW5zcG9ydCBcIiVzXCIgb3BlbmVkJyxuYW1lKTt0cmFuc3BvcnQuc2VuZChbe3R5cGU6XCJwaW5nXCIsZGF0YTpcInByb2JlXCJ9XSk7dHJhbnNwb3J0Lm9uY2UoXCJwYWNrZXRcIixmdW5jdGlvbihtc2cpe2lmKGZhaWxlZClyZXR1cm47aWYoXCJwb25nXCI9PW1zZy50eXBlJiZcInByb2JlXCI9PW1zZy5kYXRhKXtkZWJ1ZygncHJvYmUgdHJhbnNwb3J0IFwiJXNcIiBwb25nJyxuYW1lKTtzZWxmLnVwZ3JhZGluZz10cnVlO3NlbGYuZW1pdChcInVwZ3JhZGluZ1wiLHRyYW5zcG9ydCk7U29ja2V0LnByaW9yV2Vic29ja2V0U3VjY2Vzcz1cIndlYnNvY2tldFwiPT10cmFuc3BvcnQubmFtZTtkZWJ1ZygncGF1c2luZyBjdXJyZW50IHRyYW5zcG9ydCBcIiVzXCInLHNlbGYudHJhbnNwb3J0Lm5hbWUpO3NlbGYudHJhbnNwb3J0LnBhdXNlKGZ1bmN0aW9uKCl7aWYoZmFpbGVkKXJldHVybjtpZihcImNsb3NlZFwiPT1zZWxmLnJlYWR5U3RhdGV8fFwiY2xvc2luZ1wiPT1zZWxmLnJlYWR5U3RhdGUpe3JldHVybn1kZWJ1ZyhcImNoYW5naW5nIHRyYW5zcG9ydCBhbmQgc2VuZGluZyB1cGdyYWRlIHBhY2tldFwiKTtjbGVhbnVwKCk7c2VsZi5zZXRUcmFuc3BvcnQodHJhbnNwb3J0KTt0cmFuc3BvcnQuc2VuZChbe3R5cGU6XCJ1cGdyYWRlXCJ9XSk7c2VsZi5lbWl0KFwidXBncmFkZVwiLHRyYW5zcG9ydCk7dHJhbnNwb3J0PW51bGw7c2VsZi51cGdyYWRpbmc9ZmFsc2U7c2VsZi5mbHVzaCgpfSl9ZWxzZXtkZWJ1ZygncHJvYmUgdHJhbnNwb3J0IFwiJXNcIiBmYWlsZWQnLG5hbWUpO3ZhciBlcnI9bmV3IEVycm9yKFwicHJvYmUgZXJyb3JcIik7ZXJyLnRyYW5zcG9ydD10cmFuc3BvcnQubmFtZTtzZWxmLmVtaXQoXCJ1cGdyYWRlRXJyb3JcIixlcnIpfX0pfWZ1bmN0aW9uIGZyZWV6ZVRyYW5zcG9ydCgpe2lmKGZhaWxlZClyZXR1cm47ZmFpbGVkPXRydWU7Y2xlYW51cCgpO3RyYW5zcG9ydC5jbG9zZSgpO3RyYW5zcG9ydD1udWxsfWZ1bmN0aW9uIG9uZXJyb3IoZXJyKXt2YXIgZXJyb3I9bmV3IEVycm9yKFwicHJvYmUgZXJyb3I6IFwiK2Vycik7ZXJyb3IudHJhbnNwb3J0PXRyYW5zcG9ydC5uYW1lO2ZyZWV6ZVRyYW5zcG9ydCgpO2RlYnVnKCdwcm9iZSB0cmFuc3BvcnQgXCIlc1wiIGZhaWxlZCBiZWNhdXNlIG9mIGVycm9yOiAlcycsbmFtZSxlcnIpO3NlbGYuZW1pdChcInVwZ3JhZGVFcnJvclwiLGVycm9yKX1mdW5jdGlvbiBvblRyYW5zcG9ydENsb3NlKCl7b25lcnJvcihcInRyYW5zcG9ydCBjbG9zZWRcIil9ZnVuY3Rpb24gb25jbG9zZSgpe29uZXJyb3IoXCJzb2NrZXQgY2xvc2VkXCIpfWZ1bmN0aW9uIG9udXBncmFkZSh0byl7aWYodHJhbnNwb3J0JiZ0by5uYW1lIT10cmFuc3BvcnQubmFtZSl7ZGVidWcoJ1wiJXNcIiB3b3JrcyAtIGFib3J0aW5nIFwiJXNcIicsdG8ubmFtZSx0cmFuc3BvcnQubmFtZSk7ZnJlZXplVHJhbnNwb3J0KCl9fWZ1bmN0aW9uIGNsZWFudXAoKXt0cmFuc3BvcnQucmVtb3ZlTGlzdGVuZXIoXCJvcGVuXCIsb25UcmFuc3BvcnRPcGVuKTt0cmFuc3BvcnQucmVtb3ZlTGlzdGVuZXIoXCJlcnJvclwiLG9uZXJyb3IpO3RyYW5zcG9ydC5yZW1vdmVMaXN0ZW5lcihcImNsb3NlXCIsb25UcmFuc3BvcnRDbG9zZSk7c2VsZi5yZW1vdmVMaXN0ZW5lcihcImNsb3NlXCIsb25jbG9zZSk7c2VsZi5yZW1vdmVMaXN0ZW5lcihcInVwZ3JhZGluZ1wiLG9udXBncmFkZSl9dHJhbnNwb3J0Lm9uY2UoXCJvcGVuXCIsb25UcmFuc3BvcnRPcGVuKTt0cmFuc3BvcnQub25jZShcImVycm9yXCIsb25lcnJvcik7dHJhbnNwb3J0Lm9uY2UoXCJjbG9zZVwiLG9uVHJhbnNwb3J0Q2xvc2UpO3RoaXMub25jZShcImNsb3NlXCIsb25jbG9zZSk7dGhpcy5vbmNlKFwidXBncmFkaW5nXCIsb251cGdyYWRlKTt0cmFuc3BvcnQub3BlbigpfTtTb2NrZXQucHJvdG90eXBlLm9uT3Blbj1mdW5jdGlvbigpe2RlYnVnKFwic29ja2V0IG9wZW5cIik7dGhpcy5yZWFkeVN0YXRlPVwib3BlblwiO1NvY2tldC5wcmlvcldlYnNvY2tldFN1Y2Nlc3M9XCJ3ZWJzb2NrZXRcIj09dGhpcy50cmFuc3BvcnQubmFtZTt0aGlzLmVtaXQoXCJvcGVuXCIpO3RoaXMuZmx1c2goKTtpZihcIm9wZW5cIj09dGhpcy5yZWFkeVN0YXRlJiZ0aGlzLnVwZ3JhZGUmJnRoaXMudHJhbnNwb3J0LnBhdXNlKXtkZWJ1ZyhcInN0YXJ0aW5nIHVwZ3JhZGUgcHJvYmVzXCIpO2Zvcih2YXIgaT0wLGw9dGhpcy51cGdyYWRlcy5sZW5ndGg7aTxsO2krKyl7dGhpcy5wcm9iZSh0aGlzLnVwZ3JhZGVzW2ldKX19fTtTb2NrZXQucHJvdG90eXBlLm9uUGFja2V0PWZ1bmN0aW9uKHBhY2tldCl7aWYoXCJvcGVuaW5nXCI9PXRoaXMucmVhZHlTdGF0ZXx8XCJvcGVuXCI9PXRoaXMucmVhZHlTdGF0ZSl7ZGVidWcoJ3NvY2tldCByZWNlaXZlOiB0eXBlIFwiJXNcIiwgZGF0YSBcIiVzXCInLHBhY2tldC50eXBlLHBhY2tldC5kYXRhKTt0aGlzLmVtaXQoXCJwYWNrZXRcIixwYWNrZXQpO3RoaXMuZW1pdChcImhlYXJ0YmVhdFwiKTtzd2l0Y2gocGFja2V0LnR5cGUpe2Nhc2VcIm9wZW5cIjp0aGlzLm9uSGFuZHNoYWtlKHBhcnNlanNvbihwYWNrZXQuZGF0YSkpO2JyZWFrO2Nhc2VcInBvbmdcIjp0aGlzLnNldFBpbmcoKTticmVhaztjYXNlXCJlcnJvclwiOnZhciBlcnI9bmV3IEVycm9yKFwic2VydmVyIGVycm9yXCIpO2Vyci5jb2RlPXBhY2tldC5kYXRhO3RoaXMuZW1pdChcImVycm9yXCIsZXJyKTticmVhaztjYXNlXCJtZXNzYWdlXCI6dGhpcy5lbWl0KFwiZGF0YVwiLHBhY2tldC5kYXRhKTt0aGlzLmVtaXQoXCJtZXNzYWdlXCIscGFja2V0LmRhdGEpO2JyZWFrfX1lbHNle2RlYnVnKCdwYWNrZXQgcmVjZWl2ZWQgd2l0aCBzb2NrZXQgcmVhZHlTdGF0ZSBcIiVzXCInLHRoaXMucmVhZHlTdGF0ZSl9fTtTb2NrZXQucHJvdG90eXBlLm9uSGFuZHNoYWtlPWZ1bmN0aW9uKGRhdGEpe3RoaXMuZW1pdChcImhhbmRzaGFrZVwiLGRhdGEpO3RoaXMuaWQ9ZGF0YS5zaWQ7dGhpcy50cmFuc3BvcnQucXVlcnkuc2lkPWRhdGEuc2lkO3RoaXMudXBncmFkZXM9dGhpcy5maWx0ZXJVcGdyYWRlcyhkYXRhLnVwZ3JhZGVzKTt0aGlzLnBpbmdJbnRlcnZhbD1kYXRhLnBpbmdJbnRlcnZhbDt0aGlzLnBpbmdUaW1lb3V0PWRhdGEucGluZ1RpbWVvdXQ7dGhpcy5vbk9wZW4oKTtpZihcImNsb3NlZFwiPT10aGlzLnJlYWR5U3RhdGUpcmV0dXJuO3RoaXMuc2V0UGluZygpO3RoaXMucmVtb3ZlTGlzdGVuZXIoXCJoZWFydGJlYXRcIix0aGlzLm9uSGVhcnRiZWF0KTt0aGlzLm9uKFwiaGVhcnRiZWF0XCIsdGhpcy5vbkhlYXJ0YmVhdCl9O1NvY2tldC5wcm90b3R5cGUub25IZWFydGJlYXQ9ZnVuY3Rpb24odGltZW91dCl7Y2xlYXJUaW1lb3V0KHRoaXMucGluZ1RpbWVvdXRUaW1lcik7dmFyIHNlbGY9dGhpcztzZWxmLnBpbmdUaW1lb3V0VGltZXI9c2V0VGltZW91dChmdW5jdGlvbigpe2lmKFwiY2xvc2VkXCI9PXNlbGYucmVhZHlTdGF0ZSlyZXR1cm47c2VsZi5vbkNsb3NlKFwicGluZyB0aW1lb3V0XCIpfSx0aW1lb3V0fHxzZWxmLnBpbmdJbnRlcnZhbCtzZWxmLnBpbmdUaW1lb3V0KX07U29ja2V0LnByb3RvdHlwZS5zZXRQaW5nPWZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcztjbGVhclRpbWVvdXQoc2VsZi5waW5nSW50ZXJ2YWxUaW1lcik7c2VsZi5waW5nSW50ZXJ2YWxUaW1lcj1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZGVidWcoXCJ3cml0aW5nIHBpbmcgcGFja2V0IC0gZXhwZWN0aW5nIHBvbmcgd2l0aGluICVzbXNcIixzZWxmLnBpbmdUaW1lb3V0KTtzZWxmLnBpbmcoKTtzZWxmLm9uSGVhcnRiZWF0KHNlbGYucGluZ1RpbWVvdXQpfSxzZWxmLnBpbmdJbnRlcnZhbCl9O1NvY2tldC5wcm90b3R5cGUucGluZz1mdW5jdGlvbigpe3RoaXMuc2VuZFBhY2tldChcInBpbmdcIil9O1NvY2tldC5wcm90b3R5cGUub25EcmFpbj1mdW5jdGlvbigpe2Zvcih2YXIgaT0wO2k8dGhpcy5wcmV2QnVmZmVyTGVuO2krKyl7aWYodGhpcy5jYWxsYmFja0J1ZmZlcltpXSl7dGhpcy5jYWxsYmFja0J1ZmZlcltpXSgpfX10aGlzLndyaXRlQnVmZmVyLnNwbGljZSgwLHRoaXMucHJldkJ1ZmZlckxlbik7dGhpcy5jYWxsYmFja0J1ZmZlci5zcGxpY2UoMCx0aGlzLnByZXZCdWZmZXJMZW4pO3RoaXMucHJldkJ1ZmZlckxlbj0wO2lmKHRoaXMud3JpdGVCdWZmZXIubGVuZ3RoPT0wKXt0aGlzLmVtaXQoXCJkcmFpblwiKX1lbHNle3RoaXMuZmx1c2goKX19O1NvY2tldC5wcm90b3R5cGUuZmx1c2g9ZnVuY3Rpb24oKXtpZihcImNsb3NlZFwiIT10aGlzLnJlYWR5U3RhdGUmJnRoaXMudHJhbnNwb3J0LndyaXRhYmxlJiYhdGhpcy51cGdyYWRpbmcmJnRoaXMud3JpdGVCdWZmZXIubGVuZ3RoKXtkZWJ1ZyhcImZsdXNoaW5nICVkIHBhY2tldHMgaW4gc29ja2V0XCIsdGhpcy53cml0ZUJ1ZmZlci5sZW5ndGgpO3RoaXMudHJhbnNwb3J0LnNlbmQodGhpcy53cml0ZUJ1ZmZlcik7dGhpcy5wcmV2QnVmZmVyTGVuPXRoaXMud3JpdGVCdWZmZXIubGVuZ3RoO3RoaXMuZW1pdChcImZsdXNoXCIpfX07U29ja2V0LnByb3RvdHlwZS53cml0ZT1Tb2NrZXQucHJvdG90eXBlLnNlbmQ9ZnVuY3Rpb24obXNnLGZuKXt0aGlzLnNlbmRQYWNrZXQoXCJtZXNzYWdlXCIsbXNnLGZuKTtyZXR1cm4gdGhpc307U29ja2V0LnByb3RvdHlwZS5zZW5kUGFja2V0PWZ1bmN0aW9uKHR5cGUsZGF0YSxmbil7dmFyIHBhY2tldD17dHlwZTp0eXBlLGRhdGE6ZGF0YX07dGhpcy5lbWl0KFwicGFja2V0Q3JlYXRlXCIscGFja2V0KTt0aGlzLndyaXRlQnVmZmVyLnB1c2gocGFja2V0KTt0aGlzLmNhbGxiYWNrQnVmZmVyLnB1c2goZm4pO3RoaXMuZmx1c2goKX07U29ja2V0LnByb3RvdHlwZS5jbG9zZT1mdW5jdGlvbigpe2lmKFwib3BlbmluZ1wiPT10aGlzLnJlYWR5U3RhdGV8fFwib3BlblwiPT10aGlzLnJlYWR5U3RhdGUpe3RoaXMub25DbG9zZShcImZvcmNlZCBjbG9zZVwiKTtkZWJ1ZyhcInNvY2tldCBjbG9zaW5nIC0gdGVsbGluZyB0cmFuc3BvcnQgdG8gY2xvc2VcIik7dGhpcy50cmFuc3BvcnQuY2xvc2UoKX1yZXR1cm4gdGhpc307U29ja2V0LnByb3RvdHlwZS5vbkVycm9yPWZ1bmN0aW9uKGVycil7ZGVidWcoXCJzb2NrZXQgZXJyb3IgJWpcIixlcnIpO1NvY2tldC5wcmlvcldlYnNvY2tldFN1Y2Nlc3M9ZmFsc2U7dGhpcy5lbWl0KFwiZXJyb3JcIixlcnIpO3RoaXMub25DbG9zZShcInRyYW5zcG9ydCBlcnJvclwiLGVycil9O1NvY2tldC5wcm90b3R5cGUub25DbG9zZT1mdW5jdGlvbihyZWFzb24sZGVzYyl7aWYoXCJvcGVuaW5nXCI9PXRoaXMucmVhZHlTdGF0ZXx8XCJvcGVuXCI9PXRoaXMucmVhZHlTdGF0ZSl7ZGVidWcoJ3NvY2tldCBjbG9zZSB3aXRoIHJlYXNvbjogXCIlc1wiJyxyZWFzb24pO3ZhciBzZWxmPXRoaXM7Y2xlYXJUaW1lb3V0KHRoaXMucGluZ0ludGVydmFsVGltZXIpO2NsZWFyVGltZW91dCh0aGlzLnBpbmdUaW1lb3V0VGltZXIpO3NldFRpbWVvdXQoZnVuY3Rpb24oKXtzZWxmLndyaXRlQnVmZmVyPVtdO3NlbGYuY2FsbGJhY2tCdWZmZXI9W107c2VsZi5wcmV2QnVmZmVyTGVuPTB9LDApO3RoaXMudHJhbnNwb3J0LnJlbW92ZUFsbExpc3RlbmVycyhcImNsb3NlXCIpO3RoaXMudHJhbnNwb3J0LmNsb3NlKCk7dGhpcy50cmFuc3BvcnQucmVtb3ZlQWxsTGlzdGVuZXJzKCk7dGhpcy5yZWFkeVN0YXRlPVwiY2xvc2VkXCI7dGhpcy5pZD1udWxsO3RoaXMuZW1pdChcImNsb3NlXCIscmVhc29uLGRlc2MpfX07U29ja2V0LnByb3RvdHlwZS5maWx0ZXJVcGdyYWRlcz1mdW5jdGlvbih1cGdyYWRlcyl7dmFyIGZpbHRlcmVkVXBncmFkZXM9W107Zm9yKHZhciBpPTAsaj11cGdyYWRlcy5sZW5ndGg7aTxqO2krKyl7aWYofmluZGV4KHRoaXMudHJhbnNwb3J0cyx1cGdyYWRlc1tpXSkpZmlsdGVyZWRVcGdyYWRlcy5wdXNoKHVwZ3JhZGVzW2ldKX1yZXR1cm4gZmlsdGVyZWRVcGdyYWRlc319KS5jYWxsKHRoaXMsdHlwZW9mIHNlbGYhPT1cInVuZGVmaW5lZFwiP3NlbGY6dHlwZW9mIHdpbmRvdyE9PVwidW5kZWZpbmVkXCI/d2luZG93Ont9KX0se1wiLi90cmFuc3BvcnRcIjoxMyxcIi4vdHJhbnNwb3J0c1wiOjE0LFwiY29tcG9uZW50LWVtaXR0ZXJcIjo4LGRlYnVnOjksXCJlbmdpbmUuaW8tcGFyc2VyXCI6MjEsaW5kZXhvZjozNixwYXJzZWpzb246MjgscGFyc2VxczoyOSxwYXJzZXVyaTozMH1dLDEzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXt2YXIgcGFyc2VyPV9kZXJlcV8oXCJlbmdpbmUuaW8tcGFyc2VyXCIpO3ZhciBFbWl0dGVyPV9kZXJlcV8oXCJjb21wb25lbnQtZW1pdHRlclwiKTttb2R1bGUuZXhwb3J0cz1UcmFuc3BvcnQ7ZnVuY3Rpb24gVHJhbnNwb3J0KG9wdHMpe3RoaXMucGF0aD1vcHRzLnBhdGg7dGhpcy5ob3N0bmFtZT1vcHRzLmhvc3RuYW1lO3RoaXMucG9ydD1vcHRzLnBvcnQ7dGhpcy5zZWN1cmU9b3B0cy5zZWN1cmU7dGhpcy5xdWVyeT1vcHRzLnF1ZXJ5O3RoaXMudGltZXN0YW1wUGFyYW09b3B0cy50aW1lc3RhbXBQYXJhbTt0aGlzLnRpbWVzdGFtcFJlcXVlc3RzPW9wdHMudGltZXN0YW1wUmVxdWVzdHM7dGhpcy5yZWFkeVN0YXRlPVwiXCI7dGhpcy5hZ2VudD1vcHRzLmFnZW50fHxmYWxzZTt0aGlzLnNvY2tldD1vcHRzLnNvY2tldDt0aGlzLmVuYWJsZXNYRFI9b3B0cy5lbmFibGVzWERSfUVtaXR0ZXIoVHJhbnNwb3J0LnByb3RvdHlwZSk7VHJhbnNwb3J0LnRpbWVzdGFtcHM9MDtUcmFuc3BvcnQucHJvdG90eXBlLm9uRXJyb3I9ZnVuY3Rpb24obXNnLGRlc2Mpe3ZhciBlcnI9bmV3IEVycm9yKG1zZyk7ZXJyLnR5cGU9XCJUcmFuc3BvcnRFcnJvclwiO2Vyci5kZXNjcmlwdGlvbj1kZXNjO3RoaXMuZW1pdChcImVycm9yXCIsZXJyKTtyZXR1cm4gdGhpc307VHJhbnNwb3J0LnByb3RvdHlwZS5vcGVuPWZ1bmN0aW9uKCl7aWYoXCJjbG9zZWRcIj09dGhpcy5yZWFkeVN0YXRlfHxcIlwiPT10aGlzLnJlYWR5U3RhdGUpe3RoaXMucmVhZHlTdGF0ZT1cIm9wZW5pbmdcIjt0aGlzLmRvT3BlbigpfXJldHVybiB0aGlzfTtUcmFuc3BvcnQucHJvdG90eXBlLmNsb3NlPWZ1bmN0aW9uKCl7aWYoXCJvcGVuaW5nXCI9PXRoaXMucmVhZHlTdGF0ZXx8XCJvcGVuXCI9PXRoaXMucmVhZHlTdGF0ZSl7dGhpcy5kb0Nsb3NlKCk7dGhpcy5vbkNsb3NlKCl9cmV0dXJuIHRoaXN9O1RyYW5zcG9ydC5wcm90b3R5cGUuc2VuZD1mdW5jdGlvbihwYWNrZXRzKXtpZihcIm9wZW5cIj09dGhpcy5yZWFkeVN0YXRlKXt0aGlzLndyaXRlKHBhY2tldHMpfWVsc2V7dGhyb3cgbmV3IEVycm9yKFwiVHJhbnNwb3J0IG5vdCBvcGVuXCIpfX07VHJhbnNwb3J0LnByb3RvdHlwZS5vbk9wZW49ZnVuY3Rpb24oKXt0aGlzLnJlYWR5U3RhdGU9XCJvcGVuXCI7dGhpcy53cml0YWJsZT10cnVlO3RoaXMuZW1pdChcIm9wZW5cIil9O1RyYW5zcG9ydC5wcm90b3R5cGUub25EYXRhPWZ1bmN0aW9uKGRhdGEpe3ZhciBwYWNrZXQ9cGFyc2VyLmRlY29kZVBhY2tldChkYXRhLHRoaXMuc29ja2V0LmJpbmFyeVR5cGUpO3RoaXMub25QYWNrZXQocGFja2V0KX07VHJhbnNwb3J0LnByb3RvdHlwZS5vblBhY2tldD1mdW5jdGlvbihwYWNrZXQpe3RoaXMuZW1pdChcInBhY2tldFwiLHBhY2tldCl9O1RyYW5zcG9ydC5wcm90b3R5cGUub25DbG9zZT1mdW5jdGlvbigpe3RoaXMucmVhZHlTdGF0ZT1cImNsb3NlZFwiO3RoaXMuZW1pdChcImNsb3NlXCIpfX0se1wiY29tcG9uZW50LWVtaXR0ZXJcIjo4LFwiZW5naW5lLmlvLXBhcnNlclwiOjIxfV0sMTQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpeyhmdW5jdGlvbihnbG9iYWwpe3ZhciBYTUxIdHRwUmVxdWVzdD1fZGVyZXFfKFwieG1saHR0cHJlcXVlc3RcIik7dmFyIFhIUj1fZGVyZXFfKFwiLi9wb2xsaW5nLXhoclwiKTt2YXIgSlNPTlA9X2RlcmVxXyhcIi4vcG9sbGluZy1qc29ucFwiKTt2YXIgd2Vic29ja2V0PV9kZXJlcV8oXCIuL3dlYnNvY2tldFwiKTtleHBvcnRzLnBvbGxpbmc9cG9sbGluZztleHBvcnRzLndlYnNvY2tldD13ZWJzb2NrZXQ7ZnVuY3Rpb24gcG9sbGluZyhvcHRzKXt2YXIgeGhyO3ZhciB4ZD1mYWxzZTt2YXIgeHM9ZmFsc2U7dmFyIGpzb25wPWZhbHNlIT09b3B0cy5qc29ucDtpZihnbG9iYWwubG9jYXRpb24pe3ZhciBpc1NTTD1cImh0dHBzOlwiPT1sb2NhdGlvbi5wcm90b2NvbDt2YXIgcG9ydD1sb2NhdGlvbi5wb3J0O2lmKCFwb3J0KXtwb3J0PWlzU1NMPzQ0Mzo4MH14ZD1vcHRzLmhvc3RuYW1lIT1sb2NhdGlvbi5ob3N0bmFtZXx8cG9ydCE9b3B0cy5wb3J0O3hzPW9wdHMuc2VjdXJlIT1pc1NTTH1vcHRzLnhkb21haW49eGQ7b3B0cy54c2NoZW1lPXhzO3hocj1uZXcgWE1MSHR0cFJlcXVlc3Qob3B0cyk7aWYoXCJvcGVuXCJpbiB4aHImJiFvcHRzLmZvcmNlSlNPTlApe3JldHVybiBuZXcgWEhSKG9wdHMpfWVsc2V7aWYoIWpzb25wKXRocm93IG5ldyBFcnJvcihcIkpTT05QIGRpc2FibGVkXCIpO3JldHVybiBuZXcgSlNPTlAob3B0cyl9fX0pLmNhbGwodGhpcyx0eXBlb2Ygc2VsZiE9PVwidW5kZWZpbmVkXCI/c2VsZjp0eXBlb2Ygd2luZG93IT09XCJ1bmRlZmluZWRcIj93aW5kb3c6e30pfSx7XCIuL3BvbGxpbmctanNvbnBcIjoxNSxcIi4vcG9sbGluZy14aHJcIjoxNixcIi4vd2Vic29ja2V0XCI6MTgseG1saHR0cHJlcXVlc3Q6MTl9XSwxNTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7KGZ1bmN0aW9uKGdsb2JhbCl7dmFyIFBvbGxpbmc9X2RlcmVxXyhcIi4vcG9sbGluZ1wiKTt2YXIgaW5oZXJpdD1fZGVyZXFfKFwiY29tcG9uZW50LWluaGVyaXRcIik7bW9kdWxlLmV4cG9ydHM9SlNPTlBQb2xsaW5nO3ZhciByTmV3bGluZT0vXFxuL2c7dmFyIHJFc2NhcGVkTmV3bGluZT0vXFxcXG4vZzt2YXIgY2FsbGJhY2tzO3ZhciBpbmRleD0wO2Z1bmN0aW9uIGVtcHR5KCl7fWZ1bmN0aW9uIEpTT05QUG9sbGluZyhvcHRzKXtQb2xsaW5nLmNhbGwodGhpcyxvcHRzKTt0aGlzLnF1ZXJ5PXRoaXMucXVlcnl8fHt9O2lmKCFjYWxsYmFja3Mpe2lmKCFnbG9iYWwuX19fZWlvKWdsb2JhbC5fX19laW89W107Y2FsbGJhY2tzPWdsb2JhbC5fX19laW99dGhpcy5pbmRleD1jYWxsYmFja3MubGVuZ3RoO3ZhciBzZWxmPXRoaXM7Y2FsbGJhY2tzLnB1c2goZnVuY3Rpb24obXNnKXtzZWxmLm9uRGF0YShtc2cpfSk7dGhpcy5xdWVyeS5qPXRoaXMuaW5kZXg7aWYoZ2xvYmFsLmRvY3VtZW50JiZnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcil7Z2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoXCJiZWZvcmV1bmxvYWRcIixmdW5jdGlvbigpe2lmKHNlbGYuc2NyaXB0KXNlbGYuc2NyaXB0Lm9uZXJyb3I9ZW1wdHl9KX19aW5oZXJpdChKU09OUFBvbGxpbmcsUG9sbGluZyk7SlNPTlBQb2xsaW5nLnByb3RvdHlwZS5zdXBwb3J0c0JpbmFyeT1mYWxzZTtKU09OUFBvbGxpbmcucHJvdG90eXBlLmRvQ2xvc2U9ZnVuY3Rpb24oKXtpZih0aGlzLnNjcmlwdCl7dGhpcy5zY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnNjcmlwdCk7dGhpcy5zY3JpcHQ9bnVsbH1pZih0aGlzLmZvcm0pe3RoaXMuZm9ybS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZm9ybSk7dGhpcy5mb3JtPW51bGx9UG9sbGluZy5wcm90b3R5cGUuZG9DbG9zZS5jYWxsKHRoaXMpfTtKU09OUFBvbGxpbmcucHJvdG90eXBlLmRvUG9sbD1mdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIHNjcmlwdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpO2lmKHRoaXMuc2NyaXB0KXt0aGlzLnNjcmlwdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuc2NyaXB0KTt0aGlzLnNjcmlwdD1udWxsfXNjcmlwdC5hc3luYz10cnVlO3NjcmlwdC5zcmM9dGhpcy51cmkoKTtzY3JpcHQub25lcnJvcj1mdW5jdGlvbihlKXtzZWxmLm9uRXJyb3IoXCJqc29ucCBwb2xsIGVycm9yXCIsZSl9O3ZhciBpbnNlcnRBdD1kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNjcmlwdFwiKVswXTtpbnNlcnRBdC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShzY3JpcHQsaW5zZXJ0QXQpO3RoaXMuc2NyaXB0PXNjcmlwdDt2YXIgaXNVQWdlY2tvPVwidW5kZWZpbmVkXCIhPXR5cGVvZiBuYXZpZ2F0b3ImJi9nZWNrby9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7aWYoaXNVQWdlY2tvKXtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dmFyIGlmcmFtZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaWZyYW1lXCIpO2RvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaWZyYW1lKTtkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGlmcmFtZSl9LDEwMCl9fTtKU09OUFBvbGxpbmcucHJvdG90eXBlLmRvV3JpdGU9ZnVuY3Rpb24oZGF0YSxmbil7dmFyIHNlbGY9dGhpcztpZighdGhpcy5mb3JtKXt2YXIgZm9ybT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZm9ybVwiKTt2YXIgYXJlYT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGV4dGFyZWFcIik7dmFyIGlkPXRoaXMuaWZyYW1lSWQ9XCJlaW9faWZyYW1lX1wiK3RoaXMuaW5kZXg7dmFyIGlmcmFtZTtmb3JtLmNsYXNzTmFtZT1cInNvY2tldGlvXCI7Zm9ybS5zdHlsZS5wb3NpdGlvbj1cImFic29sdXRlXCI7Zm9ybS5zdHlsZS50b3A9XCItMTAwMHB4XCI7Zm9ybS5zdHlsZS5sZWZ0PVwiLTEwMDBweFwiO2Zvcm0udGFyZ2V0PWlkO2Zvcm0ubWV0aG9kPVwiUE9TVFwiO2Zvcm0uc2V0QXR0cmlidXRlKFwiYWNjZXB0LWNoYXJzZXRcIixcInV0Zi04XCIpO2FyZWEubmFtZT1cImRcIjtmb3JtLmFwcGVuZENoaWxkKGFyZWEpO2RvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZm9ybSk7dGhpcy5mb3JtPWZvcm07dGhpcy5hcmVhPWFyZWF9dGhpcy5mb3JtLmFjdGlvbj10aGlzLnVyaSgpO2Z1bmN0aW9uIGNvbXBsZXRlKCl7aW5pdElmcmFtZSgpO2ZuKCl9ZnVuY3Rpb24gaW5pdElmcmFtZSgpe2lmKHNlbGYuaWZyYW1lKXt0cnl7c2VsZi5mb3JtLnJlbW92ZUNoaWxkKHNlbGYuaWZyYW1lKX1jYXRjaChlKXtzZWxmLm9uRXJyb3IoXCJqc29ucCBwb2xsaW5nIGlmcmFtZSByZW1vdmFsIGVycm9yXCIsZSl9fXRyeXt2YXIgaHRtbD0nPGlmcmFtZSBzcmM9XCJqYXZhc2NyaXB0OjBcIiBuYW1lPVwiJytzZWxmLmlmcmFtZUlkKydcIj4nO2lmcmFtZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KGh0bWwpfWNhdGNoKGUpe2lmcmFtZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaWZyYW1lXCIpO2lmcmFtZS5uYW1lPXNlbGYuaWZyYW1lSWQ7aWZyYW1lLnNyYz1cImphdmFzY3JpcHQ6MFwifWlmcmFtZS5pZD1zZWxmLmlmcmFtZUlkO3NlbGYuZm9ybS5hcHBlbmRDaGlsZChpZnJhbWUpO3NlbGYuaWZyYW1lPWlmcmFtZX1pbml0SWZyYW1lKCk7ZGF0YT1kYXRhLnJlcGxhY2UockVzY2FwZWROZXdsaW5lLFwiXFxcXFxcblwiKTt0aGlzLmFyZWEudmFsdWU9ZGF0YS5yZXBsYWNlKHJOZXdsaW5lLFwiXFxcXG5cIik7dHJ5e3RoaXMuZm9ybS5zdWJtaXQoKX1jYXRjaChlKXt9aWYodGhpcy5pZnJhbWUuYXR0YWNoRXZlbnQpe3RoaXMuaWZyYW1lLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpe2lmKHNlbGYuaWZyYW1lLnJlYWR5U3RhdGU9PVwiY29tcGxldGVcIil7Y29tcGxldGUoKX19fWVsc2V7dGhpcy5pZnJhbWUub25sb2FkPWNvbXBsZXRlfX19KS5jYWxsKHRoaXMsdHlwZW9mIHNlbGYhPT1cInVuZGVmaW5lZFwiP3NlbGY6dHlwZW9mIHdpbmRvdyE9PVwidW5kZWZpbmVkXCI/d2luZG93Ont9KX0se1wiLi9wb2xsaW5nXCI6MTcsXCJjb21wb25lbnQtaW5oZXJpdFwiOjIwfV0sMTY6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpeyhmdW5jdGlvbihnbG9iYWwpe3ZhciBYTUxIdHRwUmVxdWVzdD1fZGVyZXFfKFwieG1saHR0cHJlcXVlc3RcIik7dmFyIFBvbGxpbmc9X2RlcmVxXyhcIi4vcG9sbGluZ1wiKTtcbnZhciBFbWl0dGVyPV9kZXJlcV8oXCJjb21wb25lbnQtZW1pdHRlclwiKTt2YXIgaW5oZXJpdD1fZGVyZXFfKFwiY29tcG9uZW50LWluaGVyaXRcIik7dmFyIGRlYnVnPV9kZXJlcV8oXCJkZWJ1Z1wiKShcImVuZ2luZS5pby1jbGllbnQ6cG9sbGluZy14aHJcIik7bW9kdWxlLmV4cG9ydHM9WEhSO21vZHVsZS5leHBvcnRzLlJlcXVlc3Q9UmVxdWVzdDtmdW5jdGlvbiBlbXB0eSgpe31mdW5jdGlvbiBYSFIob3B0cyl7UG9sbGluZy5jYWxsKHRoaXMsb3B0cyk7aWYoZ2xvYmFsLmxvY2F0aW9uKXt2YXIgaXNTU0w9XCJodHRwczpcIj09bG9jYXRpb24ucHJvdG9jb2w7dmFyIHBvcnQ9bG9jYXRpb24ucG9ydDtpZighcG9ydCl7cG9ydD1pc1NTTD80NDM6ODB9dGhpcy54ZD1vcHRzLmhvc3RuYW1lIT1nbG9iYWwubG9jYXRpb24uaG9zdG5hbWV8fHBvcnQhPW9wdHMucG9ydDt0aGlzLnhzPW9wdHMuc2VjdXJlIT1pc1NTTH19aW5oZXJpdChYSFIsUG9sbGluZyk7WEhSLnByb3RvdHlwZS5zdXBwb3J0c0JpbmFyeT10cnVlO1hIUi5wcm90b3R5cGUucmVxdWVzdD1mdW5jdGlvbihvcHRzKXtvcHRzPW9wdHN8fHt9O29wdHMudXJpPXRoaXMudXJpKCk7b3B0cy54ZD10aGlzLnhkO29wdHMueHM9dGhpcy54cztvcHRzLmFnZW50PXRoaXMuYWdlbnR8fGZhbHNlO29wdHMuc3VwcG9ydHNCaW5hcnk9dGhpcy5zdXBwb3J0c0JpbmFyeTtvcHRzLmVuYWJsZXNYRFI9dGhpcy5lbmFibGVzWERSO3JldHVybiBuZXcgUmVxdWVzdChvcHRzKX07WEhSLnByb3RvdHlwZS5kb1dyaXRlPWZ1bmN0aW9uKGRhdGEsZm4pe3ZhciBpc0JpbmFyeT10eXBlb2YgZGF0YSE9PVwic3RyaW5nXCImJmRhdGEhPT11bmRlZmluZWQ7dmFyIHJlcT10aGlzLnJlcXVlc3Qoe21ldGhvZDpcIlBPU1RcIixkYXRhOmRhdGEsaXNCaW5hcnk6aXNCaW5hcnl9KTt2YXIgc2VsZj10aGlzO3JlcS5vbihcInN1Y2Nlc3NcIixmbik7cmVxLm9uKFwiZXJyb3JcIixmdW5jdGlvbihlcnIpe3NlbGYub25FcnJvcihcInhociBwb3N0IGVycm9yXCIsZXJyKX0pO3RoaXMuc2VuZFhocj1yZXF9O1hIUi5wcm90b3R5cGUuZG9Qb2xsPWZ1bmN0aW9uKCl7ZGVidWcoXCJ4aHIgcG9sbFwiKTt2YXIgcmVxPXRoaXMucmVxdWVzdCgpO3ZhciBzZWxmPXRoaXM7cmVxLm9uKFwiZGF0YVwiLGZ1bmN0aW9uKGRhdGEpe3NlbGYub25EYXRhKGRhdGEpfSk7cmVxLm9uKFwiZXJyb3JcIixmdW5jdGlvbihlcnIpe3NlbGYub25FcnJvcihcInhociBwb2xsIGVycm9yXCIsZXJyKX0pO3RoaXMucG9sbFhocj1yZXF9O2Z1bmN0aW9uIFJlcXVlc3Qob3B0cyl7dGhpcy5tZXRob2Q9b3B0cy5tZXRob2R8fFwiR0VUXCI7dGhpcy51cmk9b3B0cy51cmk7dGhpcy54ZD0hIW9wdHMueGQ7dGhpcy54cz0hIW9wdHMueHM7dGhpcy5hc3luYz1mYWxzZSE9PW9wdHMuYXN5bmM7dGhpcy5kYXRhPXVuZGVmaW5lZCE9b3B0cy5kYXRhP29wdHMuZGF0YTpudWxsO3RoaXMuYWdlbnQ9b3B0cy5hZ2VudDt0aGlzLmlzQmluYXJ5PW9wdHMuaXNCaW5hcnk7dGhpcy5zdXBwb3J0c0JpbmFyeT1vcHRzLnN1cHBvcnRzQmluYXJ5O3RoaXMuZW5hYmxlc1hEUj1vcHRzLmVuYWJsZXNYRFI7dGhpcy5jcmVhdGUoKX1FbWl0dGVyKFJlcXVlc3QucHJvdG90eXBlKTtSZXF1ZXN0LnByb3RvdHlwZS5jcmVhdGU9ZnVuY3Rpb24oKXt2YXIgeGhyPXRoaXMueGhyPW5ldyBYTUxIdHRwUmVxdWVzdCh7YWdlbnQ6dGhpcy5hZ2VudCx4ZG9tYWluOnRoaXMueGQseHNjaGVtZTp0aGlzLnhzLGVuYWJsZXNYRFI6dGhpcy5lbmFibGVzWERSfSk7dmFyIHNlbGY9dGhpczt0cnl7ZGVidWcoXCJ4aHIgb3BlbiAlczogJXNcIix0aGlzLm1ldGhvZCx0aGlzLnVyaSk7eGhyLm9wZW4odGhpcy5tZXRob2QsdGhpcy51cmksdGhpcy5hc3luYyk7aWYodGhpcy5zdXBwb3J0c0JpbmFyeSl7eGhyLnJlc3BvbnNlVHlwZT1cImFycmF5YnVmZmVyXCJ9aWYoXCJQT1NUXCI9PXRoaXMubWV0aG9kKXt0cnl7aWYodGhpcy5pc0JpbmFyeSl7eGhyLnNldFJlcXVlc3RIZWFkZXIoXCJDb250ZW50LXR5cGVcIixcImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbVwiKX1lbHNle3hoci5zZXRSZXF1ZXN0SGVhZGVyKFwiQ29udGVudC10eXBlXCIsXCJ0ZXh0L3BsYWluO2NoYXJzZXQ9VVRGLThcIil9fWNhdGNoKGUpe319aWYoXCJ3aXRoQ3JlZGVudGlhbHNcImluIHhocil7eGhyLndpdGhDcmVkZW50aWFscz10cnVlfWlmKHRoaXMuaGFzWERSKCkpe3hoci5vbmxvYWQ9ZnVuY3Rpb24oKXtzZWxmLm9uTG9hZCgpfTt4aHIub25lcnJvcj1mdW5jdGlvbigpe3NlbGYub25FcnJvcih4aHIucmVzcG9uc2VUZXh0KX19ZWxzZXt4aHIub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7aWYoNCE9eGhyLnJlYWR5U3RhdGUpcmV0dXJuO2lmKDIwMD09eGhyLnN0YXR1c3x8MTIyMz09eGhyLnN0YXR1cyl7c2VsZi5vbkxvYWQoKX1lbHNle3NldFRpbWVvdXQoZnVuY3Rpb24oKXtzZWxmLm9uRXJyb3IoeGhyLnN0YXR1cyl9LDApfX19ZGVidWcoXCJ4aHIgZGF0YSAlc1wiLHRoaXMuZGF0YSk7eGhyLnNlbmQodGhpcy5kYXRhKX1jYXRjaChlKXtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7c2VsZi5vbkVycm9yKGUpfSwwKTtyZXR1cm59aWYoZ2xvYmFsLmRvY3VtZW50KXt0aGlzLmluZGV4PVJlcXVlc3QucmVxdWVzdHNDb3VudCsrO1JlcXVlc3QucmVxdWVzdHNbdGhpcy5pbmRleF09dGhpc319O1JlcXVlc3QucHJvdG90eXBlLm9uU3VjY2Vzcz1mdW5jdGlvbigpe3RoaXMuZW1pdChcInN1Y2Nlc3NcIik7dGhpcy5jbGVhbnVwKCl9O1JlcXVlc3QucHJvdG90eXBlLm9uRGF0YT1mdW5jdGlvbihkYXRhKXt0aGlzLmVtaXQoXCJkYXRhXCIsZGF0YSk7dGhpcy5vblN1Y2Nlc3MoKX07UmVxdWVzdC5wcm90b3R5cGUub25FcnJvcj1mdW5jdGlvbihlcnIpe3RoaXMuZW1pdChcImVycm9yXCIsZXJyKTt0aGlzLmNsZWFudXAoKX07UmVxdWVzdC5wcm90b3R5cGUuY2xlYW51cD1mdW5jdGlvbigpe2lmKFwidW5kZWZpbmVkXCI9PXR5cGVvZiB0aGlzLnhocnx8bnVsbD09PXRoaXMueGhyKXtyZXR1cm59aWYodGhpcy5oYXNYRFIoKSl7dGhpcy54aHIub25sb2FkPXRoaXMueGhyLm9uZXJyb3I9ZW1wdHl9ZWxzZXt0aGlzLnhoci5vbnJlYWR5c3RhdGVjaGFuZ2U9ZW1wdHl9dHJ5e3RoaXMueGhyLmFib3J0KCl9Y2F0Y2goZSl7fWlmKGdsb2JhbC5kb2N1bWVudCl7ZGVsZXRlIFJlcXVlc3QucmVxdWVzdHNbdGhpcy5pbmRleF19dGhpcy54aHI9bnVsbH07UmVxdWVzdC5wcm90b3R5cGUub25Mb2FkPWZ1bmN0aW9uKCl7dmFyIGRhdGE7dHJ5e3ZhciBjb250ZW50VHlwZTt0cnl7Y29udGVudFR5cGU9dGhpcy54aHIuZ2V0UmVzcG9uc2VIZWFkZXIoXCJDb250ZW50LVR5cGVcIil9Y2F0Y2goZSl7fWlmKGNvbnRlbnRUeXBlPT09XCJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW1cIil7ZGF0YT10aGlzLnhoci5yZXNwb25zZX1lbHNle2lmKCF0aGlzLnN1cHBvcnRzQmluYXJ5KXtkYXRhPXRoaXMueGhyLnJlc3BvbnNlVGV4dH1lbHNle2RhdGE9XCJva1wifX19Y2F0Y2goZSl7dGhpcy5vbkVycm9yKGUpfWlmKG51bGwhPWRhdGEpe3RoaXMub25EYXRhKGRhdGEpfX07UmVxdWVzdC5wcm90b3R5cGUuaGFzWERSPWZ1bmN0aW9uKCl7cmV0dXJuXCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBnbG9iYWwuWERvbWFpblJlcXVlc3QmJiF0aGlzLnhzJiZ0aGlzLmVuYWJsZXNYRFJ9O1JlcXVlc3QucHJvdG90eXBlLmFib3J0PWZ1bmN0aW9uKCl7dGhpcy5jbGVhbnVwKCl9O2lmKGdsb2JhbC5kb2N1bWVudCl7UmVxdWVzdC5yZXF1ZXN0c0NvdW50PTA7UmVxdWVzdC5yZXF1ZXN0cz17fTtpZihnbG9iYWwuYXR0YWNoRXZlbnQpe2dsb2JhbC5hdHRhY2hFdmVudChcIm9udW5sb2FkXCIsdW5sb2FkSGFuZGxlcil9ZWxzZSBpZihnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcil7Z2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoXCJiZWZvcmV1bmxvYWRcIix1bmxvYWRIYW5kbGVyKX19ZnVuY3Rpb24gdW5sb2FkSGFuZGxlcigpe2Zvcih2YXIgaSBpbiBSZXF1ZXN0LnJlcXVlc3RzKXtpZihSZXF1ZXN0LnJlcXVlc3RzLmhhc093blByb3BlcnR5KGkpKXtSZXF1ZXN0LnJlcXVlc3RzW2ldLmFib3J0KCl9fX19KS5jYWxsKHRoaXMsdHlwZW9mIHNlbGYhPT1cInVuZGVmaW5lZFwiP3NlbGY6dHlwZW9mIHdpbmRvdyE9PVwidW5kZWZpbmVkXCI/d2luZG93Ont9KX0se1wiLi9wb2xsaW5nXCI6MTcsXCJjb21wb25lbnQtZW1pdHRlclwiOjgsXCJjb21wb25lbnQtaW5oZXJpdFwiOjIwLGRlYnVnOjkseG1saHR0cHJlcXVlc3Q6MTl9XSwxNzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7dmFyIFRyYW5zcG9ydD1fZGVyZXFfKFwiLi4vdHJhbnNwb3J0XCIpO3ZhciBwYXJzZXFzPV9kZXJlcV8oXCJwYXJzZXFzXCIpO3ZhciBwYXJzZXI9X2RlcmVxXyhcImVuZ2luZS5pby1wYXJzZXJcIik7dmFyIGluaGVyaXQ9X2RlcmVxXyhcImNvbXBvbmVudC1pbmhlcml0XCIpO3ZhciBkZWJ1Zz1fZGVyZXFfKFwiZGVidWdcIikoXCJlbmdpbmUuaW8tY2xpZW50OnBvbGxpbmdcIik7bW9kdWxlLmV4cG9ydHM9UG9sbGluZzt2YXIgaGFzWEhSMj1mdW5jdGlvbigpe3ZhciBYTUxIdHRwUmVxdWVzdD1fZGVyZXFfKFwieG1saHR0cHJlcXVlc3RcIik7dmFyIHhocj1uZXcgWE1MSHR0cFJlcXVlc3Qoe2FnZW50OnRoaXMuYWdlbnQseGRvbWFpbjpmYWxzZX0pO3JldHVybiBudWxsIT14aHIucmVzcG9uc2VUeXBlfSgpO2Z1bmN0aW9uIFBvbGxpbmcob3B0cyl7dmFyIGZvcmNlQmFzZTY0PW9wdHMmJm9wdHMuZm9yY2VCYXNlNjQ7aWYoIWhhc1hIUjJ8fGZvcmNlQmFzZTY0KXt0aGlzLnN1cHBvcnRzQmluYXJ5PWZhbHNlfVRyYW5zcG9ydC5jYWxsKHRoaXMsb3B0cyl9aW5oZXJpdChQb2xsaW5nLFRyYW5zcG9ydCk7UG9sbGluZy5wcm90b3R5cGUubmFtZT1cInBvbGxpbmdcIjtQb2xsaW5nLnByb3RvdHlwZS5kb09wZW49ZnVuY3Rpb24oKXt0aGlzLnBvbGwoKX07UG9sbGluZy5wcm90b3R5cGUucGF1c2U9ZnVuY3Rpb24ob25QYXVzZSl7dmFyIHBlbmRpbmc9MDt2YXIgc2VsZj10aGlzO3RoaXMucmVhZHlTdGF0ZT1cInBhdXNpbmdcIjtmdW5jdGlvbiBwYXVzZSgpe2RlYnVnKFwicGF1c2VkXCIpO3NlbGYucmVhZHlTdGF0ZT1cInBhdXNlZFwiO29uUGF1c2UoKX1pZih0aGlzLnBvbGxpbmd8fCF0aGlzLndyaXRhYmxlKXt2YXIgdG90YWw9MDtpZih0aGlzLnBvbGxpbmcpe2RlYnVnKFwid2UgYXJlIGN1cnJlbnRseSBwb2xsaW5nIC0gd2FpdGluZyB0byBwYXVzZVwiKTt0b3RhbCsrO3RoaXMub25jZShcInBvbGxDb21wbGV0ZVwiLGZ1bmN0aW9uKCl7ZGVidWcoXCJwcmUtcGF1c2UgcG9sbGluZyBjb21wbGV0ZVwiKTstLXRvdGFsfHxwYXVzZSgpfSl9aWYoIXRoaXMud3JpdGFibGUpe2RlYnVnKFwid2UgYXJlIGN1cnJlbnRseSB3cml0aW5nIC0gd2FpdGluZyB0byBwYXVzZVwiKTt0b3RhbCsrO3RoaXMub25jZShcImRyYWluXCIsZnVuY3Rpb24oKXtkZWJ1ZyhcInByZS1wYXVzZSB3cml0aW5nIGNvbXBsZXRlXCIpOy0tdG90YWx8fHBhdXNlKCl9KX19ZWxzZXtwYXVzZSgpfX07UG9sbGluZy5wcm90b3R5cGUucG9sbD1mdW5jdGlvbigpe2RlYnVnKFwicG9sbGluZ1wiKTt0aGlzLnBvbGxpbmc9dHJ1ZTt0aGlzLmRvUG9sbCgpO3RoaXMuZW1pdChcInBvbGxcIil9O1BvbGxpbmcucHJvdG90eXBlLm9uRGF0YT1mdW5jdGlvbihkYXRhKXt2YXIgc2VsZj10aGlzO2RlYnVnKFwicG9sbGluZyBnb3QgZGF0YSAlc1wiLGRhdGEpO3ZhciBjYWxsYmFjaz1mdW5jdGlvbihwYWNrZXQsaW5kZXgsdG90YWwpe2lmKFwib3BlbmluZ1wiPT1zZWxmLnJlYWR5U3RhdGUpe3NlbGYub25PcGVuKCl9aWYoXCJjbG9zZVwiPT1wYWNrZXQudHlwZSl7c2VsZi5vbkNsb3NlKCk7cmV0dXJuIGZhbHNlfXNlbGYub25QYWNrZXQocGFja2V0KX07cGFyc2VyLmRlY29kZVBheWxvYWQoZGF0YSx0aGlzLnNvY2tldC5iaW5hcnlUeXBlLGNhbGxiYWNrKTtpZihcImNsb3NlZFwiIT10aGlzLnJlYWR5U3RhdGUpe3RoaXMucG9sbGluZz1mYWxzZTt0aGlzLmVtaXQoXCJwb2xsQ29tcGxldGVcIik7aWYoXCJvcGVuXCI9PXRoaXMucmVhZHlTdGF0ZSl7dGhpcy5wb2xsKCl9ZWxzZXtkZWJ1ZygnaWdub3JpbmcgcG9sbCAtIHRyYW5zcG9ydCBzdGF0ZSBcIiVzXCInLHRoaXMucmVhZHlTdGF0ZSl9fX07UG9sbGluZy5wcm90b3R5cGUuZG9DbG9zZT1mdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7ZnVuY3Rpb24gY2xvc2UoKXtkZWJ1ZyhcIndyaXRpbmcgY2xvc2UgcGFja2V0XCIpO3NlbGYud3JpdGUoW3t0eXBlOlwiY2xvc2VcIn1dKX1pZihcIm9wZW5cIj09dGhpcy5yZWFkeVN0YXRlKXtkZWJ1ZyhcInRyYW5zcG9ydCBvcGVuIC0gY2xvc2luZ1wiKTtjbG9zZSgpfWVsc2V7ZGVidWcoXCJ0cmFuc3BvcnQgbm90IG9wZW4gLSBkZWZlcnJpbmcgY2xvc2VcIik7dGhpcy5vbmNlKFwib3BlblwiLGNsb3NlKX19O1BvbGxpbmcucHJvdG90eXBlLndyaXRlPWZ1bmN0aW9uKHBhY2tldHMpe3ZhciBzZWxmPXRoaXM7dGhpcy53cml0YWJsZT1mYWxzZTt2YXIgY2FsbGJhY2tmbj1mdW5jdGlvbigpe3NlbGYud3JpdGFibGU9dHJ1ZTtzZWxmLmVtaXQoXCJkcmFpblwiKX07dmFyIHNlbGY9dGhpcztwYXJzZXIuZW5jb2RlUGF5bG9hZChwYWNrZXRzLHRoaXMuc3VwcG9ydHNCaW5hcnksZnVuY3Rpb24oZGF0YSl7c2VsZi5kb1dyaXRlKGRhdGEsY2FsbGJhY2tmbil9KX07UG9sbGluZy5wcm90b3R5cGUudXJpPWZ1bmN0aW9uKCl7dmFyIHF1ZXJ5PXRoaXMucXVlcnl8fHt9O3ZhciBzY2hlbWE9dGhpcy5zZWN1cmU/XCJodHRwc1wiOlwiaHR0cFwiO3ZhciBwb3J0PVwiXCI7aWYoZmFsc2UhPT10aGlzLnRpbWVzdGFtcFJlcXVlc3RzKXtxdWVyeVt0aGlzLnRpbWVzdGFtcFBhcmFtXT0rbmV3IERhdGUrXCItXCIrVHJhbnNwb3J0LnRpbWVzdGFtcHMrK31pZighdGhpcy5zdXBwb3J0c0JpbmFyeSYmIXF1ZXJ5LnNpZCl7cXVlcnkuYjY0PTF9cXVlcnk9cGFyc2Vxcy5lbmNvZGUocXVlcnkpO2lmKHRoaXMucG9ydCYmKFwiaHR0cHNcIj09c2NoZW1hJiZ0aGlzLnBvcnQhPTQ0M3x8XCJodHRwXCI9PXNjaGVtYSYmdGhpcy5wb3J0IT04MCkpe3BvcnQ9XCI6XCIrdGhpcy5wb3J0fWlmKHF1ZXJ5Lmxlbmd0aCl7cXVlcnk9XCI/XCIrcXVlcnl9cmV0dXJuIHNjaGVtYStcIjovL1wiK3RoaXMuaG9zdG5hbWUrcG9ydCt0aGlzLnBhdGgrcXVlcnl9fSx7XCIuLi90cmFuc3BvcnRcIjoxMyxcImNvbXBvbmVudC1pbmhlcml0XCI6MjAsZGVidWc6OSxcImVuZ2luZS5pby1wYXJzZXJcIjoyMSxwYXJzZXFzOjI5LHhtbGh0dHByZXF1ZXN0OjE5fV0sMTg6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe3ZhciBUcmFuc3BvcnQ9X2RlcmVxXyhcIi4uL3RyYW5zcG9ydFwiKTt2YXIgcGFyc2VyPV9kZXJlcV8oXCJlbmdpbmUuaW8tcGFyc2VyXCIpO3ZhciBwYXJzZXFzPV9kZXJlcV8oXCJwYXJzZXFzXCIpO3ZhciBpbmhlcml0PV9kZXJlcV8oXCJjb21wb25lbnQtaW5oZXJpdFwiKTt2YXIgZGVidWc9X2RlcmVxXyhcImRlYnVnXCIpKFwiZW5naW5lLmlvLWNsaWVudDp3ZWJzb2NrZXRcIik7dmFyIFdlYlNvY2tldD1fZGVyZXFfKFwid3NcIik7bW9kdWxlLmV4cG9ydHM9V1M7ZnVuY3Rpb24gV1Mob3B0cyl7dmFyIGZvcmNlQmFzZTY0PW9wdHMmJm9wdHMuZm9yY2VCYXNlNjQ7aWYoZm9yY2VCYXNlNjQpe3RoaXMuc3VwcG9ydHNCaW5hcnk9ZmFsc2V9VHJhbnNwb3J0LmNhbGwodGhpcyxvcHRzKX1pbmhlcml0KFdTLFRyYW5zcG9ydCk7V1MucHJvdG90eXBlLm5hbWU9XCJ3ZWJzb2NrZXRcIjtXUy5wcm90b3R5cGUuc3VwcG9ydHNCaW5hcnk9dHJ1ZTtXUy5wcm90b3R5cGUuZG9PcGVuPWZ1bmN0aW9uKCl7aWYoIXRoaXMuY2hlY2soKSl7cmV0dXJufXZhciBzZWxmPXRoaXM7dmFyIHVyaT10aGlzLnVyaSgpO3ZhciBwcm90b2NvbHM9dm9pZCAwO3ZhciBvcHRzPXthZ2VudDp0aGlzLmFnZW50fTt0aGlzLndzPW5ldyBXZWJTb2NrZXQodXJpLHByb3RvY29scyxvcHRzKTtpZih0aGlzLndzLmJpbmFyeVR5cGU9PT11bmRlZmluZWQpe3RoaXMuc3VwcG9ydHNCaW5hcnk9ZmFsc2V9dGhpcy53cy5iaW5hcnlUeXBlPVwiYXJyYXlidWZmZXJcIjt0aGlzLmFkZEV2ZW50TGlzdGVuZXJzKCl9O1dTLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVycz1mdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dGhpcy53cy5vbm9wZW49ZnVuY3Rpb24oKXtzZWxmLm9uT3BlbigpfTt0aGlzLndzLm9uY2xvc2U9ZnVuY3Rpb24oKXtzZWxmLm9uQ2xvc2UoKX07dGhpcy53cy5vbm1lc3NhZ2U9ZnVuY3Rpb24oZXYpe3NlbGYub25EYXRhKGV2LmRhdGEpfTt0aGlzLndzLm9uZXJyb3I9ZnVuY3Rpb24oZSl7c2VsZi5vbkVycm9yKFwid2Vic29ja2V0IGVycm9yXCIsZSl9fTtpZihcInVuZGVmaW5lZFwiIT10eXBlb2YgbmF2aWdhdG9yJiYvaVBhZHxpUGhvbmV8aVBvZC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpe1dTLnByb3RvdHlwZS5vbkRhdGE9ZnVuY3Rpb24oZGF0YSl7dmFyIHNlbGY9dGhpcztzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7VHJhbnNwb3J0LnByb3RvdHlwZS5vbkRhdGEuY2FsbChzZWxmLGRhdGEpfSwwKX19V1MucHJvdG90eXBlLndyaXRlPWZ1bmN0aW9uKHBhY2tldHMpe3ZhciBzZWxmPXRoaXM7dGhpcy53cml0YWJsZT1mYWxzZTtmb3IodmFyIGk9MCxsPXBhY2tldHMubGVuZ3RoO2k8bDtpKyspe3BhcnNlci5lbmNvZGVQYWNrZXQocGFja2V0c1tpXSx0aGlzLnN1cHBvcnRzQmluYXJ5LGZ1bmN0aW9uKGRhdGEpe3RyeXtzZWxmLndzLnNlbmQoZGF0YSl9Y2F0Y2goZSl7ZGVidWcoXCJ3ZWJzb2NrZXQgY2xvc2VkIGJlZm9yZSBvbmNsb3NlIGV2ZW50XCIpfX0pfWZ1bmN0aW9uIG9uZHJhaW4oKXtzZWxmLndyaXRhYmxlPXRydWU7c2VsZi5lbWl0KFwiZHJhaW5cIil9c2V0VGltZW91dChvbmRyYWluLDApfTtXUy5wcm90b3R5cGUub25DbG9zZT1mdW5jdGlvbigpe1RyYW5zcG9ydC5wcm90b3R5cGUub25DbG9zZS5jYWxsKHRoaXMpfTtXUy5wcm90b3R5cGUuZG9DbG9zZT1mdW5jdGlvbigpe2lmKHR5cGVvZiB0aGlzLndzIT09XCJ1bmRlZmluZWRcIil7dGhpcy53cy5jbG9zZSgpfX07V1MucHJvdG90eXBlLnVyaT1mdW5jdGlvbigpe3ZhciBxdWVyeT10aGlzLnF1ZXJ5fHx7fTt2YXIgc2NoZW1hPXRoaXMuc2VjdXJlP1wid3NzXCI6XCJ3c1wiO3ZhciBwb3J0PVwiXCI7aWYodGhpcy5wb3J0JiYoXCJ3c3NcIj09c2NoZW1hJiZ0aGlzLnBvcnQhPTQ0M3x8XCJ3c1wiPT1zY2hlbWEmJnRoaXMucG9ydCE9ODApKXtwb3J0PVwiOlwiK3RoaXMucG9ydH1pZih0aGlzLnRpbWVzdGFtcFJlcXVlc3RzKXtxdWVyeVt0aGlzLnRpbWVzdGFtcFBhcmFtXT0rbmV3IERhdGV9aWYoIXRoaXMuc3VwcG9ydHNCaW5hcnkpe3F1ZXJ5LmI2ND0xfXF1ZXJ5PXBhcnNlcXMuZW5jb2RlKHF1ZXJ5KTtpZihxdWVyeS5sZW5ndGgpe3F1ZXJ5PVwiP1wiK3F1ZXJ5fXJldHVybiBzY2hlbWErXCI6Ly9cIit0aGlzLmhvc3RuYW1lK3BvcnQrdGhpcy5wYXRoK3F1ZXJ5fTtXUy5wcm90b3R5cGUuY2hlY2s9ZnVuY3Rpb24oKXtyZXR1cm4hIVdlYlNvY2tldCYmIShcIl9faW5pdGlhbGl6ZVwiaW4gV2ViU29ja2V0JiZ0aGlzLm5hbWU9PT1XUy5wcm90b3R5cGUubmFtZSl9fSx7XCIuLi90cmFuc3BvcnRcIjoxMyxcImNvbXBvbmVudC1pbmhlcml0XCI6MjAsZGVidWc6OSxcImVuZ2luZS5pby1wYXJzZXJcIjoyMSxwYXJzZXFzOjI5LHdzOjMxfV0sMTk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe3ZhciBoYXNDT1JTPV9kZXJlcV8oXCJoYXMtY29yc1wiKTttb2R1bGUuZXhwb3J0cz1mdW5jdGlvbihvcHRzKXt2YXIgeGRvbWFpbj1vcHRzLnhkb21haW47dmFyIHhzY2hlbWU9b3B0cy54c2NoZW1lO3ZhciBlbmFibGVzWERSPW9wdHMuZW5hYmxlc1hEUjt0cnl7aWYoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIFhEb21haW5SZXF1ZXN0JiYheHNjaGVtZSYmZW5hYmxlc1hEUil7cmV0dXJuIG5ldyBYRG9tYWluUmVxdWVzdH19Y2F0Y2goZSl7fXRyeXtpZihcInVuZGVmaW5lZFwiIT10eXBlb2YgWE1MSHR0cFJlcXVlc3QmJigheGRvbWFpbnx8aGFzQ09SUykpe3JldHVybiBuZXcgWE1MSHR0cFJlcXVlc3R9fWNhdGNoKGUpe31pZigheGRvbWFpbil7dHJ5e3JldHVybiBuZXcgQWN0aXZlWE9iamVjdChcIk1pY3Jvc29mdC5YTUxIVFRQXCIpfWNhdGNoKGUpe319fX0se1wiaGFzLWNvcnNcIjozNH1dLDIwOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXttb2R1bGUuZXhwb3J0cz1mdW5jdGlvbihhLGIpe3ZhciBmbj1mdW5jdGlvbigpe307Zm4ucHJvdG90eXBlPWIucHJvdG90eXBlO2EucHJvdG90eXBlPW5ldyBmbjthLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1hfX0se31dLDIxOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsoZnVuY3Rpb24oZ2xvYmFsKXt2YXIga2V5cz1fZGVyZXFfKFwiLi9rZXlzXCIpO3ZhciBzbGljZUJ1ZmZlcj1fZGVyZXFfKFwiYXJyYXlidWZmZXIuc2xpY2VcIik7dmFyIGJhc2U2NGVuY29kZXI9X2RlcmVxXyhcImJhc2U2NC1hcnJheWJ1ZmZlclwiKTt2YXIgYWZ0ZXI9X2RlcmVxXyhcImFmdGVyXCIpO3ZhciB1dGY4PV9kZXJlcV8oXCJ1dGY4XCIpO3ZhciBpc0FuZHJvaWQ9bmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvQW5kcm9pZC9pKTtleHBvcnRzLnByb3RvY29sPTM7dmFyIHBhY2tldHM9ZXhwb3J0cy5wYWNrZXRzPXtvcGVuOjAsY2xvc2U6MSxwaW5nOjIscG9uZzozLG1lc3NhZ2U6NCx1cGdyYWRlOjUsbm9vcDo2fTt2YXIgcGFja2V0c2xpc3Q9a2V5cyhwYWNrZXRzKTt2YXIgZXJyPXt0eXBlOlwiZXJyb3JcIixkYXRhOlwicGFyc2VyIGVycm9yXCJ9O3ZhciBCbG9iPV9kZXJlcV8oXCJibG9iXCIpO2V4cG9ydHMuZW5jb2RlUGFja2V0PWZ1bmN0aW9uKHBhY2tldCxzdXBwb3J0c0JpbmFyeSx1dGY4ZW5jb2RlLGNhbGxiYWNrKXtpZihcImZ1bmN0aW9uXCI9PXR5cGVvZiBzdXBwb3J0c0JpbmFyeSl7Y2FsbGJhY2s9c3VwcG9ydHNCaW5hcnk7c3VwcG9ydHNCaW5hcnk9ZmFsc2V9aWYoXCJmdW5jdGlvblwiPT10eXBlb2YgdXRmOGVuY29kZSl7Y2FsbGJhY2s9dXRmOGVuY29kZTt1dGY4ZW5jb2RlPW51bGx9dmFyIGRhdGE9cGFja2V0LmRhdGE9PT11bmRlZmluZWQ/dW5kZWZpbmVkOnBhY2tldC5kYXRhLmJ1ZmZlcnx8cGFja2V0LmRhdGE7aWYoZ2xvYmFsLkFycmF5QnVmZmVyJiZkYXRhIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpe3JldHVybiBlbmNvZGVBcnJheUJ1ZmZlcihwYWNrZXQsc3VwcG9ydHNCaW5hcnksY2FsbGJhY2spfWVsc2UgaWYoQmxvYiYmZGF0YSBpbnN0YW5jZW9mIGdsb2JhbC5CbG9iKXtyZXR1cm4gZW5jb2RlQmxvYihwYWNrZXQsc3VwcG9ydHNCaW5hcnksY2FsbGJhY2spfXZhciBlbmNvZGVkPXBhY2tldHNbcGFja2V0LnR5cGVdO2lmKHVuZGVmaW5lZCE9PXBhY2tldC5kYXRhKXtlbmNvZGVkKz11dGY4ZW5jb2RlP3V0ZjguZW5jb2RlKFN0cmluZyhwYWNrZXQuZGF0YSkpOlN0cmluZyhwYWNrZXQuZGF0YSl9cmV0dXJuIGNhbGxiYWNrKFwiXCIrZW5jb2RlZCl9O2Z1bmN0aW9uIGVuY29kZUFycmF5QnVmZmVyKHBhY2tldCxzdXBwb3J0c0JpbmFyeSxjYWxsYmFjayl7aWYoIXN1cHBvcnRzQmluYXJ5KXtyZXR1cm4gZXhwb3J0cy5lbmNvZGVCYXNlNjRQYWNrZXQocGFja2V0LGNhbGxiYWNrKX12YXIgZGF0YT1wYWNrZXQuZGF0YTt2YXIgY29udGVudEFycmF5PW5ldyBVaW50OEFycmF5KGRhdGEpO3ZhciByZXN1bHRCdWZmZXI9bmV3IFVpbnQ4QXJyYXkoMStkYXRhLmJ5dGVMZW5ndGgpO3Jlc3VsdEJ1ZmZlclswXT1wYWNrZXRzW3BhY2tldC50eXBlXTtmb3IodmFyIGk9MDtpPGNvbnRlbnRBcnJheS5sZW5ndGg7aSsrKXtyZXN1bHRCdWZmZXJbaSsxXT1jb250ZW50QXJyYXlbaV19cmV0dXJuIGNhbGxiYWNrKHJlc3VsdEJ1ZmZlci5idWZmZXIpfWZ1bmN0aW9uIGVuY29kZUJsb2JBc0FycmF5QnVmZmVyKHBhY2tldCxzdXBwb3J0c0JpbmFyeSxjYWxsYmFjayl7aWYoIXN1cHBvcnRzQmluYXJ5KXtyZXR1cm4gZXhwb3J0cy5lbmNvZGVCYXNlNjRQYWNrZXQocGFja2V0LGNhbGxiYWNrKX12YXIgZnI9bmV3IEZpbGVSZWFkZXI7ZnIub25sb2FkPWZ1bmN0aW9uKCl7cGFja2V0LmRhdGE9ZnIucmVzdWx0O2V4cG9ydHMuZW5jb2RlUGFja2V0KHBhY2tldCxzdXBwb3J0c0JpbmFyeSx0cnVlLGNhbGxiYWNrKX07cmV0dXJuIGZyLnJlYWRBc0FycmF5QnVmZmVyKHBhY2tldC5kYXRhKX1mdW5jdGlvbiBlbmNvZGVCbG9iKHBhY2tldCxzdXBwb3J0c0JpbmFyeSxjYWxsYmFjayl7aWYoIXN1cHBvcnRzQmluYXJ5KXtyZXR1cm4gZXhwb3J0cy5lbmNvZGVCYXNlNjRQYWNrZXQocGFja2V0LGNhbGxiYWNrKX1pZihpc0FuZHJvaWQpe3JldHVybiBlbmNvZGVCbG9iQXNBcnJheUJ1ZmZlcihwYWNrZXQsc3VwcG9ydHNCaW5hcnksY2FsbGJhY2spfXZhciBsZW5ndGg9bmV3IFVpbnQ4QXJyYXkoMSk7bGVuZ3RoWzBdPXBhY2tldHNbcGFja2V0LnR5cGVdO3ZhciBibG9iPW5ldyBCbG9iKFtsZW5ndGguYnVmZmVyLHBhY2tldC5kYXRhXSk7cmV0dXJuIGNhbGxiYWNrKGJsb2IpfWV4cG9ydHMuZW5jb2RlQmFzZTY0UGFja2V0PWZ1bmN0aW9uKHBhY2tldCxjYWxsYmFjayl7dmFyIG1lc3NhZ2U9XCJiXCIrZXhwb3J0cy5wYWNrZXRzW3BhY2tldC50eXBlXTtpZihCbG9iJiZwYWNrZXQuZGF0YSBpbnN0YW5jZW9mIEJsb2Ipe3ZhciBmcj1uZXcgRmlsZVJlYWRlcjtmci5vbmxvYWQ9ZnVuY3Rpb24oKXt2YXIgYjY0PWZyLnJlc3VsdC5zcGxpdChcIixcIilbMV07Y2FsbGJhY2sobWVzc2FnZStiNjQpfTtyZXR1cm4gZnIucmVhZEFzRGF0YVVSTChwYWNrZXQuZGF0YSl9dmFyIGI2NGRhdGE7dHJ5e2I2NGRhdGE9U3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLG5ldyBVaW50OEFycmF5KHBhY2tldC5kYXRhKSl9Y2F0Y2goZSl7dmFyIHR5cGVkPW5ldyBVaW50OEFycmF5KHBhY2tldC5kYXRhKTt2YXIgYmFzaWM9bmV3IEFycmF5KHR5cGVkLmxlbmd0aCk7Zm9yKHZhciBpPTA7aTx0eXBlZC5sZW5ndGg7aSsrKXtiYXNpY1tpXT10eXBlZFtpXX1iNjRkYXRhPVN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCxiYXNpYyl9bWVzc2FnZSs9Z2xvYmFsLmJ0b2EoYjY0ZGF0YSk7cmV0dXJuIGNhbGxiYWNrKG1lc3NhZ2UpfTtleHBvcnRzLmRlY29kZVBhY2tldD1mdW5jdGlvbihkYXRhLGJpbmFyeVR5cGUsdXRmOGRlY29kZSl7aWYodHlwZW9mIGRhdGE9PVwic3RyaW5nXCJ8fGRhdGE9PT11bmRlZmluZWQpe2lmKGRhdGEuY2hhckF0KDApPT1cImJcIil7cmV0dXJuIGV4cG9ydHMuZGVjb2RlQmFzZTY0UGFja2V0KGRhdGEuc3Vic3RyKDEpLGJpbmFyeVR5cGUpfWlmKHV0ZjhkZWNvZGUpe3RyeXtkYXRhPXV0ZjguZGVjb2RlKGRhdGEpfWNhdGNoKGUpe3JldHVybiBlcnJ9fXZhciB0eXBlPWRhdGEuY2hhckF0KDApO2lmKE51bWJlcih0eXBlKSE9dHlwZXx8IXBhY2tldHNsaXN0W3R5cGVdKXtyZXR1cm4gZXJyfWlmKGRhdGEubGVuZ3RoPjEpe3JldHVybnt0eXBlOnBhY2tldHNsaXN0W3R5cGVdLGRhdGE6ZGF0YS5zdWJzdHJpbmcoMSl9fWVsc2V7cmV0dXJue3R5cGU6cGFja2V0c2xpc3RbdHlwZV19fX12YXIgYXNBcnJheT1uZXcgVWludDhBcnJheShkYXRhKTt2YXIgdHlwZT1hc0FycmF5WzBdO3ZhciByZXN0PXNsaWNlQnVmZmVyKGRhdGEsMSk7aWYoQmxvYiYmYmluYXJ5VHlwZT09PVwiYmxvYlwiKXtyZXN0PW5ldyBCbG9iKFtyZXN0XSl9cmV0dXJue3R5cGU6cGFja2V0c2xpc3RbdHlwZV0sZGF0YTpyZXN0fX07ZXhwb3J0cy5kZWNvZGVCYXNlNjRQYWNrZXQ9ZnVuY3Rpb24obXNnLGJpbmFyeVR5cGUpe3ZhciB0eXBlPXBhY2tldHNsaXN0W21zZy5jaGFyQXQoMCldO2lmKCFnbG9iYWwuQXJyYXlCdWZmZXIpe3JldHVybnt0eXBlOnR5cGUsZGF0YTp7YmFzZTY0OnRydWUsZGF0YTptc2cuc3Vic3RyKDEpfX19dmFyIGRhdGE9YmFzZTY0ZW5jb2Rlci5kZWNvZGUobXNnLnN1YnN0cigxKSk7aWYoYmluYXJ5VHlwZT09PVwiYmxvYlwiJiZCbG9iKXtkYXRhPW5ldyBCbG9iKFtkYXRhXSl9cmV0dXJue3R5cGU6dHlwZSxkYXRhOmRhdGF9fTtleHBvcnRzLmVuY29kZVBheWxvYWQ9ZnVuY3Rpb24ocGFja2V0cyxzdXBwb3J0c0JpbmFyeSxjYWxsYmFjayl7aWYodHlwZW9mIHN1cHBvcnRzQmluYXJ5PT1cImZ1bmN0aW9uXCIpe2NhbGxiYWNrPXN1cHBvcnRzQmluYXJ5O3N1cHBvcnRzQmluYXJ5PW51bGx9aWYoc3VwcG9ydHNCaW5hcnkpe2lmKEJsb2ImJiFpc0FuZHJvaWQpe3JldHVybiBleHBvcnRzLmVuY29kZVBheWxvYWRBc0Jsb2IocGFja2V0cyxjYWxsYmFjayl9cmV0dXJuIGV4cG9ydHMuZW5jb2RlUGF5bG9hZEFzQXJyYXlCdWZmZXIocGFja2V0cyxjYWxsYmFjayl9aWYoIXBhY2tldHMubGVuZ3RoKXtyZXR1cm4gY2FsbGJhY2soXCIwOlwiKX1mdW5jdGlvbiBzZXRMZW5ndGhIZWFkZXIobWVzc2FnZSl7cmV0dXJuIG1lc3NhZ2UubGVuZ3RoK1wiOlwiK21lc3NhZ2V9ZnVuY3Rpb24gZW5jb2RlT25lKHBhY2tldCxkb25lQ2FsbGJhY2spe2V4cG9ydHMuZW5jb2RlUGFja2V0KHBhY2tldCxzdXBwb3J0c0JpbmFyeSx0cnVlLGZ1bmN0aW9uKG1lc3NhZ2Upe2RvbmVDYWxsYmFjayhudWxsLHNldExlbmd0aEhlYWRlcihtZXNzYWdlKSl9KX1tYXAocGFja2V0cyxlbmNvZGVPbmUsZnVuY3Rpb24oZXJyLHJlc3VsdHMpe3JldHVybiBjYWxsYmFjayhyZXN1bHRzLmpvaW4oXCJcIikpfSl9O2Z1bmN0aW9uIG1hcChhcnksZWFjaCxkb25lKXt2YXIgcmVzdWx0PW5ldyBBcnJheShhcnkubGVuZ3RoKTt2YXIgbmV4dD1hZnRlcihhcnkubGVuZ3RoLGRvbmUpO3ZhciBlYWNoV2l0aEluZGV4PWZ1bmN0aW9uKGksZWwsY2Ipe2VhY2goZWwsZnVuY3Rpb24oZXJyb3IsbXNnKXtyZXN1bHRbaV09bXNnO2NiKGVycm9yLHJlc3VsdCl9KX07Zm9yKHZhciBpPTA7aTxhcnkubGVuZ3RoO2krKyl7ZWFjaFdpdGhJbmRleChpLGFyeVtpXSxuZXh0KX19ZXhwb3J0cy5kZWNvZGVQYXlsb2FkPWZ1bmN0aW9uKGRhdGEsYmluYXJ5VHlwZSxjYWxsYmFjayl7aWYodHlwZW9mIGRhdGEhPVwic3RyaW5nXCIpe3JldHVybiBleHBvcnRzLmRlY29kZVBheWxvYWRBc0JpbmFyeShkYXRhLGJpbmFyeVR5cGUsY2FsbGJhY2spfWlmKHR5cGVvZiBiaW5hcnlUeXBlPT09XCJmdW5jdGlvblwiKXtjYWxsYmFjaz1iaW5hcnlUeXBlO2JpbmFyeVR5cGU9bnVsbH12YXIgcGFja2V0O2lmKGRhdGE9PVwiXCIpe3JldHVybiBjYWxsYmFjayhlcnIsMCwxKX12YXIgbGVuZ3RoPVwiXCIsbixtc2c7Zm9yKHZhciBpPTAsbD1kYXRhLmxlbmd0aDtpPGw7aSsrKXt2YXIgY2hyPWRhdGEuY2hhckF0KGkpO2lmKFwiOlwiIT1jaHIpe2xlbmd0aCs9Y2hyfWVsc2V7aWYoXCJcIj09bGVuZ3RofHxsZW5ndGghPShuPU51bWJlcihsZW5ndGgpKSl7cmV0dXJuIGNhbGxiYWNrKGVyciwwLDEpfW1zZz1kYXRhLnN1YnN0cihpKzEsbik7aWYobGVuZ3RoIT1tc2cubGVuZ3RoKXtyZXR1cm4gY2FsbGJhY2soZXJyLDAsMSl9aWYobXNnLmxlbmd0aCl7cGFja2V0PWV4cG9ydHMuZGVjb2RlUGFja2V0KG1zZyxiaW5hcnlUeXBlLHRydWUpO2lmKGVyci50eXBlPT1wYWNrZXQudHlwZSYmZXJyLmRhdGE9PXBhY2tldC5kYXRhKXtyZXR1cm4gY2FsbGJhY2soZXJyLDAsMSl9dmFyIHJldD1jYWxsYmFjayhwYWNrZXQsaStuLGwpO2lmKGZhbHNlPT09cmV0KXJldHVybn1pKz1uO2xlbmd0aD1cIlwifX1pZihsZW5ndGghPVwiXCIpe3JldHVybiBjYWxsYmFjayhlcnIsMCwxKX19O2V4cG9ydHMuZW5jb2RlUGF5bG9hZEFzQXJyYXlCdWZmZXI9ZnVuY3Rpb24ocGFja2V0cyxjYWxsYmFjayl7aWYoIXBhY2tldHMubGVuZ3RoKXtyZXR1cm4gY2FsbGJhY2sobmV3IEFycmF5QnVmZmVyKDApKX1mdW5jdGlvbiBlbmNvZGVPbmUocGFja2V0LGRvbmVDYWxsYmFjayl7ZXhwb3J0cy5lbmNvZGVQYWNrZXQocGFja2V0LHRydWUsdHJ1ZSxmdW5jdGlvbihkYXRhKXtyZXR1cm4gZG9uZUNhbGxiYWNrKG51bGwsZGF0YSl9KX1tYXAocGFja2V0cyxlbmNvZGVPbmUsZnVuY3Rpb24oZXJyLGVuY29kZWRQYWNrZXRzKXt2YXIgdG90YWxMZW5ndGg9ZW5jb2RlZFBhY2tldHMucmVkdWNlKGZ1bmN0aW9uKGFjYyxwKXt2YXIgbGVuO2lmKHR5cGVvZiBwPT09XCJzdHJpbmdcIil7bGVuPXAubGVuZ3RofWVsc2V7bGVuPXAuYnl0ZUxlbmd0aH1yZXR1cm4gYWNjK2xlbi50b1N0cmluZygpLmxlbmd0aCtsZW4rMn0sMCk7dmFyIHJlc3VsdEFycmF5PW5ldyBVaW50OEFycmF5KHRvdGFsTGVuZ3RoKTt2YXIgYnVmZmVySW5kZXg9MDtlbmNvZGVkUGFja2V0cy5mb3JFYWNoKGZ1bmN0aW9uKHApe3ZhciBpc1N0cmluZz10eXBlb2YgcD09PVwic3RyaW5nXCI7dmFyIGFiPXA7aWYoaXNTdHJpbmcpe3ZhciB2aWV3PW5ldyBVaW50OEFycmF5KHAubGVuZ3RoKTtmb3IodmFyIGk9MDtpPHAubGVuZ3RoO2krKyl7dmlld1tpXT1wLmNoYXJDb2RlQXQoaSl9YWI9dmlldy5idWZmZXJ9aWYoaXNTdHJpbmcpe3Jlc3VsdEFycmF5W2J1ZmZlckluZGV4KytdPTB9ZWxzZXtyZXN1bHRBcnJheVtidWZmZXJJbmRleCsrXT0xfXZhciBsZW5TdHI9YWIuYnl0ZUxlbmd0aC50b1N0cmluZygpO2Zvcih2YXIgaT0wO2k8bGVuU3RyLmxlbmd0aDtpKyspe3Jlc3VsdEFycmF5W2J1ZmZlckluZGV4KytdPXBhcnNlSW50KGxlblN0cltpXSl9cmVzdWx0QXJyYXlbYnVmZmVySW5kZXgrK109MjU1O3ZhciB2aWV3PW5ldyBVaW50OEFycmF5KGFiKTtmb3IodmFyIGk9MDtpPHZpZXcubGVuZ3RoO2krKyl7cmVzdWx0QXJyYXlbYnVmZmVySW5kZXgrK109dmlld1tpXX19KTtyZXR1cm4gY2FsbGJhY2socmVzdWx0QXJyYXkuYnVmZmVyKX0pfTtleHBvcnRzLmVuY29kZVBheWxvYWRBc0Jsb2I9ZnVuY3Rpb24ocGFja2V0cyxjYWxsYmFjayl7ZnVuY3Rpb24gZW5jb2RlT25lKHBhY2tldCxkb25lQ2FsbGJhY2spe2V4cG9ydHMuZW5jb2RlUGFja2V0KHBhY2tldCx0cnVlLHRydWUsZnVuY3Rpb24oZW5jb2RlZCl7dmFyIGJpbmFyeUlkZW50aWZpZXI9bmV3IFVpbnQ4QXJyYXkoMSk7YmluYXJ5SWRlbnRpZmllclswXT0xO2lmKHR5cGVvZiBlbmNvZGVkPT09XCJzdHJpbmdcIil7dmFyIHZpZXc9bmV3IFVpbnQ4QXJyYXkoZW5jb2RlZC5sZW5ndGgpO2Zvcih2YXIgaT0wO2k8ZW5jb2RlZC5sZW5ndGg7aSsrKXt2aWV3W2ldPWVuY29kZWQuY2hhckNvZGVBdChpKX1lbmNvZGVkPXZpZXcuYnVmZmVyO2JpbmFyeUlkZW50aWZpZXJbMF09MH12YXIgbGVuPWVuY29kZWQgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj9lbmNvZGVkLmJ5dGVMZW5ndGg6ZW5jb2RlZC5zaXplO3ZhciBsZW5TdHI9bGVuLnRvU3RyaW5nKCk7dmFyIGxlbmd0aEFyeT1uZXcgVWludDhBcnJheShsZW5TdHIubGVuZ3RoKzEpO2Zvcih2YXIgaT0wO2k8bGVuU3RyLmxlbmd0aDtpKyspe2xlbmd0aEFyeVtpXT1wYXJzZUludChsZW5TdHJbaV0pfWxlbmd0aEFyeVtsZW5TdHIubGVuZ3RoXT0yNTU7aWYoQmxvYil7dmFyIGJsb2I9bmV3IEJsb2IoW2JpbmFyeUlkZW50aWZpZXIuYnVmZmVyLGxlbmd0aEFyeS5idWZmZXIsZW5jb2RlZF0pO2RvbmVDYWxsYmFjayhudWxsLGJsb2IpfX0pfW1hcChwYWNrZXRzLGVuY29kZU9uZSxmdW5jdGlvbihlcnIscmVzdWx0cyl7cmV0dXJuIGNhbGxiYWNrKG5ldyBCbG9iKHJlc3VsdHMpKX0pfTtleHBvcnRzLmRlY29kZVBheWxvYWRBc0JpbmFyeT1mdW5jdGlvbihkYXRhLGJpbmFyeVR5cGUsY2FsbGJhY2spe2lmKHR5cGVvZiBiaW5hcnlUeXBlPT09XCJmdW5jdGlvblwiKXtjYWxsYmFjaz1iaW5hcnlUeXBlO2JpbmFyeVR5cGU9bnVsbH12YXIgYnVmZmVyVGFpbD1kYXRhO3ZhciBidWZmZXJzPVtdO3ZhciBudW1iZXJUb29Mb25nPWZhbHNlO3doaWxlKGJ1ZmZlclRhaWwuYnl0ZUxlbmd0aD4wKXt2YXIgdGFpbEFycmF5PW5ldyBVaW50OEFycmF5KGJ1ZmZlclRhaWwpO3ZhciBpc1N0cmluZz10YWlsQXJyYXlbMF09PT0wO3ZhciBtc2dMZW5ndGg9XCJcIjtmb3IodmFyIGk9MTs7aSsrKXtpZih0YWlsQXJyYXlbaV09PTI1NSlicmVhaztpZihtc2dMZW5ndGgubGVuZ3RoPjMxMCl7bnVtYmVyVG9vTG9uZz10cnVlO2JyZWFrfW1zZ0xlbmd0aCs9dGFpbEFycmF5W2ldfWlmKG51bWJlclRvb0xvbmcpcmV0dXJuIGNhbGxiYWNrKGVyciwwLDEpO2J1ZmZlclRhaWw9c2xpY2VCdWZmZXIoYnVmZmVyVGFpbCwyK21zZ0xlbmd0aC5sZW5ndGgpO21zZ0xlbmd0aD1wYXJzZUludChtc2dMZW5ndGgpO3ZhciBtc2c9c2xpY2VCdWZmZXIoYnVmZmVyVGFpbCwwLG1zZ0xlbmd0aCk7aWYoaXNTdHJpbmcpe3RyeXttc2c9U3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLG5ldyBVaW50OEFycmF5KG1zZykpfWNhdGNoKGUpe3ZhciB0eXBlZD1uZXcgVWludDhBcnJheShtc2cpO21zZz1cIlwiO2Zvcih2YXIgaT0wO2k8dHlwZWQubGVuZ3RoO2krKyl7bXNnKz1TdHJpbmcuZnJvbUNoYXJDb2RlKHR5cGVkW2ldKX19fWJ1ZmZlcnMucHVzaChtc2cpO2J1ZmZlclRhaWw9c2xpY2VCdWZmZXIoYnVmZmVyVGFpbCxtc2dMZW5ndGgpfXZhciB0b3RhbD1idWZmZXJzLmxlbmd0aDtidWZmZXJzLmZvckVhY2goZnVuY3Rpb24oYnVmZmVyLGkpe2NhbGxiYWNrKGV4cG9ydHMuZGVjb2RlUGFja2V0KGJ1ZmZlcixiaW5hcnlUeXBlLHRydWUpLGksdG90YWwpfSl9fSkuY2FsbCh0aGlzLHR5cGVvZiBzZWxmIT09XCJ1bmRlZmluZWRcIj9zZWxmOnR5cGVvZiB3aW5kb3chPT1cInVuZGVmaW5lZFwiP3dpbmRvdzp7fSl9LHtcIi4va2V5c1wiOjIyLGFmdGVyOjIzLFwiYXJyYXlidWZmZXIuc2xpY2VcIjoyNCxcImJhc2U2NC1hcnJheWJ1ZmZlclwiOjI1LGJsb2I6MjYsdXRmODoyN31dLDIyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXttb2R1bGUuZXhwb3J0cz1PYmplY3Qua2V5c3x8ZnVuY3Rpb24ga2V5cyhvYmope3ZhciBhcnI9W107dmFyIGhhcz1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O2Zvcih2YXIgaSBpbiBvYmope2lmKGhhcy5jYWxsKG9iaixpKSl7YXJyLnB1c2goaSl9fXJldHVybiBhcnJ9fSx7fV0sMjM6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe21vZHVsZS5leHBvcnRzPWFmdGVyO2Z1bmN0aW9uIGFmdGVyKGNvdW50LGNhbGxiYWNrLGVycl9jYil7dmFyIGJhaWw9ZmFsc2U7ZXJyX2NiPWVycl9jYnx8bm9vcDtwcm94eS5jb3VudD1jb3VudDtyZXR1cm4gY291bnQ9PT0wP2NhbGxiYWNrKCk6cHJveHk7ZnVuY3Rpb24gcHJveHkoZXJyLHJlc3VsdCl7aWYocHJveHkuY291bnQ8PTApe3Rocm93IG5ldyBFcnJvcihcImFmdGVyIGNhbGxlZCB0b28gbWFueSB0aW1lc1wiKX0tLXByb3h5LmNvdW50O2lmKGVycil7YmFpbD10cnVlO2NhbGxiYWNrKGVycik7Y2FsbGJhY2s9ZXJyX2NifWVsc2UgaWYocHJveHkuY291bnQ9PT0wJiYhYmFpbCl7Y2FsbGJhY2sobnVsbCxyZXN1bHQpfX19ZnVuY3Rpb24gbm9vcCgpe319LHt9XSwyNDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7bW9kdWxlLmV4cG9ydHM9ZnVuY3Rpb24oYXJyYXlidWZmZXIsc3RhcnQsZW5kKXt2YXIgYnl0ZXM9YXJyYXlidWZmZXIuYnl0ZUxlbmd0aDtzdGFydD1zdGFydHx8MDtlbmQ9ZW5kfHxieXRlcztpZihhcnJheWJ1ZmZlci5zbGljZSl7cmV0dXJuIGFycmF5YnVmZmVyLnNsaWNlKHN0YXJ0LGVuZCl9aWYoc3RhcnQ8MCl7c3RhcnQrPWJ5dGVzfWlmKGVuZDwwKXtlbmQrPWJ5dGVzfWlmKGVuZD5ieXRlcyl7ZW5kPWJ5dGVzfWlmKHN0YXJ0Pj1ieXRlc3x8c3RhcnQ+PWVuZHx8Ynl0ZXM9PT0wKXtyZXR1cm4gbmV3IEFycmF5QnVmZmVyKDApfXZhciBhYnY9bmV3IFVpbnQ4QXJyYXkoYXJyYXlidWZmZXIpO3ZhciByZXN1bHQ9bmV3IFVpbnQ4QXJyYXkoZW5kLXN0YXJ0KTtmb3IodmFyIGk9c3RhcnQsaWk9MDtpPGVuZDtpKyssaWkrKyl7cmVzdWx0W2lpXT1hYnZbaV19cmV0dXJuIHJlc3VsdC5idWZmZXJ9fSx7fV0sMjU6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpeyhmdW5jdGlvbihjaGFycyl7XCJ1c2Ugc3RyaWN0XCI7ZXhwb3J0cy5lbmNvZGU9ZnVuY3Rpb24oYXJyYXlidWZmZXIpe3ZhciBieXRlcz1uZXcgVWludDhBcnJheShhcnJheWJ1ZmZlciksaSxsZW49Ynl0ZXMubGVuZ3RoLGJhc2U2ND1cIlwiO2ZvcihpPTA7aTxsZW47aSs9Myl7YmFzZTY0Kz1jaGFyc1tieXRlc1tpXT4+Ml07YmFzZTY0Kz1jaGFyc1soYnl0ZXNbaV0mMyk8PDR8Ynl0ZXNbaSsxXT4+NF07YmFzZTY0Kz1jaGFyc1soYnl0ZXNbaSsxXSYxNSk8PDJ8Ynl0ZXNbaSsyXT4+Nl07YmFzZTY0Kz1jaGFyc1tieXRlc1tpKzJdJjYzXX1pZihsZW4lMz09PTIpe2Jhc2U2ND1iYXNlNjQuc3Vic3RyaW5nKDAsYmFzZTY0Lmxlbmd0aC0xKStcIj1cIn1lbHNlIGlmKGxlbiUzPT09MSl7YmFzZTY0PWJhc2U2NC5zdWJzdHJpbmcoMCxiYXNlNjQubGVuZ3RoLTIpK1wiPT1cIn1yZXR1cm4gYmFzZTY0fTtleHBvcnRzLmRlY29kZT1mdW5jdGlvbihiYXNlNjQpe3ZhciBidWZmZXJMZW5ndGg9YmFzZTY0Lmxlbmd0aCouNzUsbGVuPWJhc2U2NC5sZW5ndGgsaSxwPTAsZW5jb2RlZDEsZW5jb2RlZDIsZW5jb2RlZDMsZW5jb2RlZDQ7aWYoYmFzZTY0W2Jhc2U2NC5sZW5ndGgtMV09PT1cIj1cIil7YnVmZmVyTGVuZ3RoLS07aWYoYmFzZTY0W2Jhc2U2NC5sZW5ndGgtMl09PT1cIj1cIil7YnVmZmVyTGVuZ3RoLS19fXZhciBhcnJheWJ1ZmZlcj1uZXcgQXJyYXlCdWZmZXIoYnVmZmVyTGVuZ3RoKSxieXRlcz1uZXcgVWludDhBcnJheShhcnJheWJ1ZmZlcik7Zm9yKGk9MDtpPGxlbjtpKz00KXtlbmNvZGVkMT1jaGFycy5pbmRleE9mKGJhc2U2NFtpXSk7ZW5jb2RlZDI9Y2hhcnMuaW5kZXhPZihiYXNlNjRbaSsxXSk7ZW5jb2RlZDM9Y2hhcnMuaW5kZXhPZihiYXNlNjRbaSsyXSk7ZW5jb2RlZDQ9Y2hhcnMuaW5kZXhPZihiYXNlNjRbaSszXSk7Ynl0ZXNbcCsrXT1lbmNvZGVkMTw8MnxlbmNvZGVkMj4+NDtieXRlc1twKytdPShlbmNvZGVkMiYxNSk8PDR8ZW5jb2RlZDM+PjI7Ynl0ZXNbcCsrXT0oZW5jb2RlZDMmMyk8PDZ8ZW5jb2RlZDQmNjN9cmV0dXJuIGFycmF5YnVmZmVyfX0pKFwiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrL1wiKX0se31dLDI2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsoZnVuY3Rpb24oZ2xvYmFsKXt2YXIgQmxvYkJ1aWxkZXI9Z2xvYmFsLkJsb2JCdWlsZGVyfHxnbG9iYWwuV2ViS2l0QmxvYkJ1aWxkZXJ8fGdsb2JhbC5NU0Jsb2JCdWlsZGVyfHxnbG9iYWwuTW96QmxvYkJ1aWxkZXI7dmFyIGJsb2JTdXBwb3J0ZWQ9ZnVuY3Rpb24oKXt0cnl7dmFyIGI9bmV3IEJsb2IoW1wiaGlcIl0pO3JldHVybiBiLnNpemU9PTJ9Y2F0Y2goZSl7cmV0dXJuIGZhbHNlfX0oKTt2YXIgYmxvYkJ1aWxkZXJTdXBwb3J0ZWQ9QmxvYkJ1aWxkZXImJkJsb2JCdWlsZGVyLnByb3RvdHlwZS5hcHBlbmQmJkJsb2JCdWlsZGVyLnByb3RvdHlwZS5nZXRCbG9iO2Z1bmN0aW9uIEJsb2JCdWlsZGVyQ29uc3RydWN0b3IoYXJ5LG9wdGlvbnMpe29wdGlvbnM9b3B0aW9uc3x8e307dmFyIGJiPW5ldyBCbG9iQnVpbGRlcjtmb3IodmFyIGk9MDtpPGFyeS5sZW5ndGg7aSsrKXtiYi5hcHBlbmQoYXJ5W2ldKX1yZXR1cm4gb3B0aW9ucy50eXBlP2JiLmdldEJsb2Iob3B0aW9ucy50eXBlKTpiYi5nZXRCbG9iKCl9bW9kdWxlLmV4cG9ydHM9ZnVuY3Rpb24oKXtpZihibG9iU3VwcG9ydGVkKXtyZXR1cm4gZ2xvYmFsLkJsb2J9ZWxzZSBpZihibG9iQnVpbGRlclN1cHBvcnRlZCl7cmV0dXJuIEJsb2JCdWlsZGVyQ29uc3RydWN0b3J9ZWxzZXtyZXR1cm4gdW5kZWZpbmVkfX0oKX0pLmNhbGwodGhpcyx0eXBlb2Ygc2VsZiE9PVwidW5kZWZpbmVkXCI/c2VsZjp0eXBlb2Ygd2luZG93IT09XCJ1bmRlZmluZWRcIj93aW5kb3c6e30pfSx7fV0sMjc6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpeyhmdW5jdGlvbihnbG9iYWwpeyhmdW5jdGlvbihyb290KXt2YXIgZnJlZUV4cG9ydHM9dHlwZW9mIGV4cG9ydHM9PVwib2JqZWN0XCImJmV4cG9ydHM7dmFyIGZyZWVNb2R1bGU9dHlwZW9mIG1vZHVsZT09XCJvYmplY3RcIiYmbW9kdWxlJiZtb2R1bGUuZXhwb3J0cz09ZnJlZUV4cG9ydHMmJm1vZHVsZTt2YXIgZnJlZUdsb2JhbD10eXBlb2YgZ2xvYmFsPT1cIm9iamVjdFwiJiZnbG9iYWw7aWYoZnJlZUdsb2JhbC5nbG9iYWw9PT1mcmVlR2xvYmFsfHxmcmVlR2xvYmFsLndpbmRvdz09PWZyZWVHbG9iYWwpe3Jvb3Q9ZnJlZUdsb2JhbH12YXIgc3RyaW5nRnJvbUNoYXJDb2RlPVN0cmluZy5mcm9tQ2hhckNvZGU7ZnVuY3Rpb24gdWNzMmRlY29kZShzdHJpbmcpe3ZhciBvdXRwdXQ9W107dmFyIGNvdW50ZXI9MDt2YXIgbGVuZ3RoPXN0cmluZy5sZW5ndGg7dmFyIHZhbHVlO3ZhciBleHRyYTt3aGlsZShjb3VudGVyPGxlbmd0aCl7dmFsdWU9c3RyaW5nLmNoYXJDb2RlQXQoY291bnRlcisrKTtpZih2YWx1ZT49NTUyOTYmJnZhbHVlPD01NjMxOSYmY291bnRlcjxsZW5ndGgpe2V4dHJhPXN0cmluZy5jaGFyQ29kZUF0KGNvdW50ZXIrKyk7aWYoKGV4dHJhJjY0NTEyKT09NTYzMjApe291dHB1dC5wdXNoKCgodmFsdWUmMTAyMyk8PDEwKSsoZXh0cmEmMTAyMykrNjU1MzYpfWVsc2V7b3V0cHV0LnB1c2godmFsdWUpO2NvdW50ZXItLX19ZWxzZXtvdXRwdXQucHVzaCh2YWx1ZSl9fXJldHVybiBvdXRwdXR9ZnVuY3Rpb24gdWNzMmVuY29kZShhcnJheSl7dmFyIGxlbmd0aD1hcnJheS5sZW5ndGg7dmFyIGluZGV4PS0xO3ZhciB2YWx1ZTt2YXIgb3V0cHV0PVwiXCI7d2hpbGUoKytpbmRleDxsZW5ndGgpe3ZhbHVlPWFycmF5W2luZGV4XTtpZih2YWx1ZT42NTUzNSl7dmFsdWUtPTY1NTM2O291dHB1dCs9c3RyaW5nRnJvbUNoYXJDb2RlKHZhbHVlPj4+MTAmMTAyM3w1NTI5Nik7dmFsdWU9NTYzMjB8dmFsdWUmMTAyM31vdXRwdXQrPXN0cmluZ0Zyb21DaGFyQ29kZSh2YWx1ZSl9cmV0dXJuIG91dHB1dH1mdW5jdGlvbiBjcmVhdGVCeXRlKGNvZGVQb2ludCxzaGlmdCl7cmV0dXJuIHN0cmluZ0Zyb21DaGFyQ29kZShjb2RlUG9pbnQ+PnNoaWZ0JjYzfDEyOCl9ZnVuY3Rpb24gZW5jb2RlQ29kZVBvaW50KGNvZGVQb2ludCl7aWYoKGNvZGVQb2ludCY0Mjk0OTY3MTY4KT09MCl7cmV0dXJuIHN0cmluZ0Zyb21DaGFyQ29kZShjb2RlUG9pbnQpfXZhciBzeW1ib2w9XCJcIjtpZigoY29kZVBvaW50JjQyOTQ5NjUyNDgpPT0wKXtzeW1ib2w9c3RyaW5nRnJvbUNoYXJDb2RlKGNvZGVQb2ludD4+NiYzMXwxOTIpfWVsc2UgaWYoKGNvZGVQb2ludCY0Mjk0OTAxNzYwKT09MCl7c3ltYm9sPXN0cmluZ0Zyb21DaGFyQ29kZShjb2RlUG9pbnQ+PjEyJjE1fDIyNCk7c3ltYm9sKz1jcmVhdGVCeXRlKGNvZGVQb2ludCw2KX1lbHNlIGlmKChjb2RlUG9pbnQmNDI5Mjg3MDE0NCk9PTApe3N5bWJvbD1zdHJpbmdGcm9tQ2hhckNvZGUoY29kZVBvaW50Pj4xOCY3fDI0MCk7c3ltYm9sKz1jcmVhdGVCeXRlKGNvZGVQb2ludCwxMik7c3ltYm9sKz1jcmVhdGVCeXRlKGNvZGVQb2ludCw2KX1zeW1ib2wrPXN0cmluZ0Zyb21DaGFyQ29kZShjb2RlUG9pbnQmNjN8MTI4KTtyZXR1cm4gc3ltYm9sfWZ1bmN0aW9uIHV0ZjhlbmNvZGUoc3RyaW5nKXt2YXIgY29kZVBvaW50cz11Y3MyZGVjb2RlKHN0cmluZyk7dmFyIGxlbmd0aD1jb2RlUG9pbnRzLmxlbmd0aDt2YXIgaW5kZXg9LTE7dmFyIGNvZGVQb2ludDt2YXIgYnl0ZVN0cmluZz1cIlwiO3doaWxlKCsraW5kZXg8bGVuZ3RoKXtjb2RlUG9pbnQ9Y29kZVBvaW50c1tpbmRleF07Ynl0ZVN0cmluZys9ZW5jb2RlQ29kZVBvaW50KGNvZGVQb2ludCl9cmV0dXJuIGJ5dGVTdHJpbmd9ZnVuY3Rpb24gcmVhZENvbnRpbnVhdGlvbkJ5dGUoKXtpZihieXRlSW5kZXg+PWJ5dGVDb3VudCl7dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGJ5dGUgaW5kZXhcIil9dmFyIGNvbnRpbnVhdGlvbkJ5dGU9Ynl0ZUFycmF5W2J5dGVJbmRleF0mMjU1O2J5dGVJbmRleCsrO2lmKChjb250aW51YXRpb25CeXRlJjE5Mik9PTEyOCl7cmV0dXJuIGNvbnRpbnVhdGlvbkJ5dGUmNjN9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGNvbnRpbnVhdGlvbiBieXRlXCIpfWZ1bmN0aW9uIGRlY29kZVN5bWJvbCgpe3ZhciBieXRlMTt2YXIgYnl0ZTI7dmFyIGJ5dGUzO3ZhciBieXRlNDt2YXIgY29kZVBvaW50O2lmKGJ5dGVJbmRleD5ieXRlQ291bnQpe3Rocm93IEVycm9yKFwiSW52YWxpZCBieXRlIGluZGV4XCIpfWlmKGJ5dGVJbmRleD09Ynl0ZUNvdW50KXtyZXR1cm4gZmFsc2V9Ynl0ZTE9Ynl0ZUFycmF5W2J5dGVJbmRleF0mMjU1O2J5dGVJbmRleCsrO2lmKChieXRlMSYxMjgpPT0wKXtyZXR1cm4gYnl0ZTF9aWYoKGJ5dGUxJjIyNCk9PTE5Mil7dmFyIGJ5dGUyPXJlYWRDb250aW51YXRpb25CeXRlKCk7Y29kZVBvaW50PShieXRlMSYzMSk8PDZ8Ynl0ZTI7aWYoY29kZVBvaW50Pj0xMjgpe3JldHVybiBjb2RlUG9pbnR9ZWxzZXt0aHJvdyBFcnJvcihcIkludmFsaWQgY29udGludWF0aW9uIGJ5dGVcIil9fWlmKChieXRlMSYyNDApPT0yMjQpe2J5dGUyPXJlYWRDb250aW51YXRpb25CeXRlKCk7Ynl0ZTM9cmVhZENvbnRpbnVhdGlvbkJ5dGUoKTtjb2RlUG9pbnQ9KGJ5dGUxJjE1KTw8MTJ8Ynl0ZTI8PDZ8Ynl0ZTM7aWYoY29kZVBvaW50Pj0yMDQ4KXtyZXR1cm4gY29kZVBvaW50fWVsc2V7dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGNvbnRpbnVhdGlvbiBieXRlXCIpfX1pZigoYnl0ZTEmMjQ4KT09MjQwKXtieXRlMj1yZWFkQ29udGludWF0aW9uQnl0ZSgpO2J5dGUzPXJlYWRDb250aW51YXRpb25CeXRlKCk7Ynl0ZTQ9cmVhZENvbnRpbnVhdGlvbkJ5dGUoKTtjb2RlUG9pbnQ9KGJ5dGUxJjE1KTw8MTh8Ynl0ZTI8PDEyfGJ5dGUzPDw2fGJ5dGU0O2lmKGNvZGVQb2ludD49NjU1MzYmJmNvZGVQb2ludDw9MTExNDExMSl7cmV0dXJuIGNvZGVQb2ludH19dGhyb3cgRXJyb3IoXCJJbnZhbGlkIFVURi04IGRldGVjdGVkXCIpfXZhciBieXRlQXJyYXk7dmFyIGJ5dGVDb3VudDt2YXIgYnl0ZUluZGV4O2Z1bmN0aW9uIHV0ZjhkZWNvZGUoYnl0ZVN0cmluZyl7Ynl0ZUFycmF5PXVjczJkZWNvZGUoYnl0ZVN0cmluZyk7Ynl0ZUNvdW50PWJ5dGVBcnJheS5sZW5ndGg7Ynl0ZUluZGV4PTA7dmFyIGNvZGVQb2ludHM9W107dmFyIHRtcDt3aGlsZSgodG1wPWRlY29kZVN5bWJvbCgpKSE9PWZhbHNlKXtjb2RlUG9pbnRzLnB1c2godG1wKX1yZXR1cm4gdWNzMmVuY29kZShjb2RlUG9pbnRzKX12YXIgdXRmOD17dmVyc2lvbjpcIjIuMC4wXCIsZW5jb2RlOnV0ZjhlbmNvZGUsZGVjb2RlOnV0ZjhkZWNvZGV9O2lmKHR5cGVvZiBkZWZpbmU9PVwiZnVuY3Rpb25cIiYmdHlwZW9mIGRlZmluZS5hbWQ9PVwib2JqZWN0XCImJmRlZmluZS5hbWQpe2RlZmluZShmdW5jdGlvbigpe3JldHVybiB1dGY4fSl9ZWxzZSBpZihmcmVlRXhwb3J0cyYmIWZyZWVFeHBvcnRzLm5vZGVUeXBlKXtpZihmcmVlTW9kdWxlKXtmcmVlTW9kdWxlLmV4cG9ydHM9dXRmOH1lbHNle3ZhciBvYmplY3Q9e307dmFyIGhhc093blByb3BlcnR5PW9iamVjdC5oYXNPd25Qcm9wZXJ0eTtmb3IodmFyIGtleSBpbiB1dGY4KXtoYXNPd25Qcm9wZXJ0eS5jYWxsKHV0Zjgsa2V5KSYmKGZyZWVFeHBvcnRzW2tleV09dXRmOFtrZXldKX19fWVsc2V7cm9vdC51dGY4PXV0Zjh9fSkodGhpcyl9KS5jYWxsKHRoaXMsdHlwZW9mIHNlbGYhPT1cInVuZGVmaW5lZFwiP3NlbGY6dHlwZW9mIHdpbmRvdyE9PVwidW5kZWZpbmVkXCI/d2luZG93Ont9KX0se31dLDI4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsoZnVuY3Rpb24oZ2xvYmFsKXt2YXIgcnZhbGlkY2hhcnM9L15bXFxdLDp7fVxcc10qJC87dmFyIHJ2YWxpZGVzY2FwZT0vXFxcXCg/OltcIlxcXFxcXC9iZm5ydF18dVswLTlhLWZBLUZdezR9KS9nO3ZhciBydmFsaWR0b2tlbnM9L1wiW15cIlxcXFxcXG5cXHJdKlwifHRydWV8ZmFsc2V8bnVsbHwtP1xcZCsoPzpcXC5cXGQqKT8oPzpbZUVdWytcXC1dP1xcZCspPy9nO3ZhciBydmFsaWRicmFjZXM9Lyg/Ol58OnwsKSg/OlxccypcXFspKy9nO3ZhciBydHJpbUxlZnQ9L15cXHMrLzt2YXIgcnRyaW1SaWdodD0vXFxzKyQvO21vZHVsZS5leHBvcnRzPWZ1bmN0aW9uIHBhcnNlanNvbihkYXRhKXtpZihcInN0cmluZ1wiIT10eXBlb2YgZGF0YXx8IWRhdGEpe3JldHVybiBudWxsfWRhdGE9ZGF0YS5yZXBsYWNlKHJ0cmltTGVmdCxcIlwiKS5yZXBsYWNlKHJ0cmltUmlnaHQsXCJcIik7aWYoZ2xvYmFsLkpTT04mJkpTT04ucGFyc2Upe3JldHVybiBKU09OLnBhcnNlKGRhdGEpfWlmKHJ2YWxpZGNoYXJzLnRlc3QoZGF0YS5yZXBsYWNlKHJ2YWxpZGVzY2FwZSxcIkBcIikucmVwbGFjZShydmFsaWR0b2tlbnMsXCJdXCIpLnJlcGxhY2UocnZhbGlkYnJhY2VzLFwiXCIpKSl7cmV0dXJuIG5ldyBGdW5jdGlvbihcInJldHVybiBcIitkYXRhKSgpfX19KS5jYWxsKHRoaXMsdHlwZW9mIHNlbGYhPT1cInVuZGVmaW5lZFwiP3NlbGY6dHlwZW9mIHdpbmRvdyE9PVwidW5kZWZpbmVkXCI/d2luZG93Ont9KX0se31dLDI5OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtleHBvcnRzLmVuY29kZT1mdW5jdGlvbihvYmope3ZhciBzdHI9XCJcIjtmb3IodmFyIGkgaW4gb2JqKXtpZihvYmouaGFzT3duUHJvcGVydHkoaSkpe2lmKHN0ci5sZW5ndGgpc3RyKz1cIiZcIjtzdHIrPWVuY29kZVVSSUNvbXBvbmVudChpKStcIj1cIitlbmNvZGVVUklDb21wb25lbnQob2JqW2ldKX19cmV0dXJuIHN0cn07ZXhwb3J0cy5kZWNvZGU9ZnVuY3Rpb24ocXMpe3ZhciBxcnk9e307dmFyIHBhaXJzPXFzLnNwbGl0KFwiJlwiKTtmb3IodmFyIGk9MCxsPXBhaXJzLmxlbmd0aDtpPGw7aSsrKXt2YXIgcGFpcj1wYWlyc1tpXS5zcGxpdChcIj1cIik7cXJ5W2RlY29kZVVSSUNvbXBvbmVudChwYWlyWzBdKV09ZGVjb2RlVVJJQ29tcG9uZW50KHBhaXJbMV0pfXJldHVybiBxcnl9fSx7fV0sMzA6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe3ZhciByZT0vXig/Oig/IVteOkBdKzpbXjpAXFwvXSpAKShodHRwfGh0dHBzfHdzfHdzcyk6XFwvXFwvKT8oKD86KChbXjpAXSopKD86OihbXjpAXSopKT8pP0ApPygoPzpbYS1mMC05XXswLDR9Oil7Miw3fVthLWYwLTldezAsNH18W146XFwvPyNdKikoPzo6KFxcZCopKT8pKCgoXFwvKD86W14/I10oPyFbXj8jXFwvXSpcXC5bXj8jXFwvLl0rKD86Wz8jXXwkKSkpKlxcLz8pPyhbXj8jXFwvXSopKSg/OlxcPyhbXiNdKikpPyg/OiMoLiopKT8pLzt2YXIgcGFydHM9W1wic291cmNlXCIsXCJwcm90b2NvbFwiLFwiYXV0aG9yaXR5XCIsXCJ1c2VySW5mb1wiLFwidXNlclwiLFwicGFzc3dvcmRcIixcImhvc3RcIixcInBvcnRcIixcInJlbGF0aXZlXCIsXCJwYXRoXCIsXCJkaXJlY3RvcnlcIixcImZpbGVcIixcInF1ZXJ5XCIsXCJhbmNob3JcIl07bW9kdWxlLmV4cG9ydHM9ZnVuY3Rpb24gcGFyc2V1cmkoc3RyKXt2YXIgc3JjPXN0cixiPXN0ci5pbmRleE9mKFwiW1wiKSxlPXN0ci5pbmRleE9mKFwiXVwiKTtpZihiIT0tMSYmZSE9LTEpe3N0cj1zdHIuc3Vic3RyaW5nKDAsYikrc3RyLnN1YnN0cmluZyhiLGUpLnJlcGxhY2UoLzovZyxcIjtcIikrc3RyLnN1YnN0cmluZyhlLHN0ci5sZW5ndGgpfXZhciBtPXJlLmV4ZWMoc3RyfHxcIlwiKSx1cmk9e30saT0xNDt3aGlsZShpLS0pe3VyaVtwYXJ0c1tpXV09bVtpXXx8XCJcIn1pZihiIT0tMSYmZSE9LTEpe3VyaS5zb3VyY2U9c3JjO3VyaS5ob3N0PXVyaS5ob3N0LnN1YnN0cmluZygxLHVyaS5ob3N0Lmxlbmd0aC0xKS5yZXBsYWNlKC87L2csXCI6XCIpO3VyaS5hdXRob3JpdHk9dXJpLmF1dGhvcml0eS5yZXBsYWNlKFwiW1wiLFwiXCIpLnJlcGxhY2UoXCJdXCIsXCJcIikucmVwbGFjZSgvOy9nLFwiOlwiKTt1cmkuaXB2NnVyaT10cnVlfXJldHVybiB1cml9fSx7fV0sMzE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe3ZhciBnbG9iYWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30oKTt2YXIgV2ViU29ja2V0PWdsb2JhbC5XZWJTb2NrZXR8fGdsb2JhbC5Nb3pXZWJTb2NrZXQ7bW9kdWxlLmV4cG9ydHM9V2ViU29ja2V0P3dzOm51bGw7ZnVuY3Rpb24gd3ModXJpLHByb3RvY29scyxvcHRzKXt2YXIgaW5zdGFuY2U7aWYocHJvdG9jb2xzKXtpbnN0YW5jZT1uZXcgV2ViU29ja2V0KHVyaSxwcm90b2NvbHMpfWVsc2V7aW5zdGFuY2U9bmV3IFdlYlNvY2tldCh1cmkpfXJldHVybiBpbnN0YW5jZX1pZihXZWJTb2NrZXQpd3MucHJvdG90eXBlPVdlYlNvY2tldC5wcm90b3R5cGV9LHt9XSwzMjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7KGZ1bmN0aW9uKGdsb2JhbCl7dmFyIGlzQXJyYXk9X2RlcmVxXyhcImlzYXJyYXlcIik7bW9kdWxlLmV4cG9ydHM9aGFzQmluYXJ5O2Z1bmN0aW9uIGhhc0JpbmFyeShkYXRhKXtmdW5jdGlvbiBfaGFzQmluYXJ5KG9iail7aWYoIW9iailyZXR1cm4gZmFsc2U7aWYoZ2xvYmFsLkJ1ZmZlciYmZ2xvYmFsLkJ1ZmZlci5pc0J1ZmZlcihvYmopfHxnbG9iYWwuQXJyYXlCdWZmZXImJm9iaiBpbnN0YW5jZW9mIEFycmF5QnVmZmVyfHxnbG9iYWwuQmxvYiYmb2JqIGluc3RhbmNlb2YgQmxvYnx8Z2xvYmFsLkZpbGUmJm9iaiBpbnN0YW5jZW9mIEZpbGUpe3JldHVybiB0cnVlfWlmKGlzQXJyYXkob2JqKSl7Zm9yKHZhciBpPTA7aTxvYmoubGVuZ3RoO2krKyl7aWYoX2hhc0JpbmFyeShvYmpbaV0pKXtyZXR1cm4gdHJ1ZX19fWVsc2UgaWYob2JqJiZcIm9iamVjdFwiPT10eXBlb2Ygb2JqKXtpZihvYmoudG9KU09OKXtvYmo9b2JqLnRvSlNPTigpfWZvcih2YXIga2V5IGluIG9iail7aWYob2JqLmhhc093blByb3BlcnR5KGtleSkmJl9oYXNCaW5hcnkob2JqW2tleV0pKXtyZXR1cm4gdHJ1ZX19fXJldHVybiBmYWxzZX1yZXR1cm4gX2hhc0JpbmFyeShkYXRhKX19KS5jYWxsKHRoaXMsdHlwZW9mIHNlbGYhPT1cInVuZGVmaW5lZFwiP3NlbGY6dHlwZW9mIHdpbmRvdyE9PVwidW5kZWZpbmVkXCI/d2luZG93Ont9KX0se2lzYXJyYXk6MzN9XSwzMzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7bW9kdWxlLmV4cG9ydHM9QXJyYXkuaXNBcnJheXx8ZnVuY3Rpb24oYXJyKXtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGFycik9PVwiW29iamVjdCBBcnJheV1cIn19LHt9XSwzNDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7dmFyIGdsb2JhbD1fZGVyZXFfKFwiZ2xvYmFsXCIpO3RyeXttb2R1bGUuZXhwb3J0cz1cIlhNTEh0dHBSZXF1ZXN0XCJpbiBnbG9iYWwmJlwid2l0aENyZWRlbnRpYWxzXCJpbiBuZXcgZ2xvYmFsLlhNTEh0dHBSZXF1ZXN0fWNhdGNoKGVycil7bW9kdWxlLmV4cG9ydHM9ZmFsc2V9fSx7Z2xvYmFsOjM1fV0sMzU6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe21vZHVsZS5leHBvcnRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KCl9LHt9XSwzNjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7dmFyIGluZGV4T2Y9W10uaW5kZXhPZjttb2R1bGUuZXhwb3J0cz1mdW5jdGlvbihhcnIsb2JqKXtpZihpbmRleE9mKXJldHVybiBhcnIuaW5kZXhPZihvYmopO2Zvcih2YXIgaT0wO2k8YXJyLmxlbmd0aDsrK2kpe2lmKGFycltpXT09PW9iailyZXR1cm4gaX1yZXR1cm4tMX19LHt9XSwzNzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7dmFyIGhhcz1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O2V4cG9ydHMua2V5cz1PYmplY3Qua2V5c3x8ZnVuY3Rpb24ob2JqKXt2YXIga2V5cz1bXTtmb3IodmFyIGtleSBpbiBvYmope2lmKGhhcy5jYWxsKG9iaixrZXkpKXtrZXlzLnB1c2goa2V5KX19cmV0dXJuIGtleXN9O2V4cG9ydHMudmFsdWVzPWZ1bmN0aW9uKG9iail7dmFyIHZhbHM9W107Zm9yKHZhciBrZXkgaW4gb2JqKXtpZihoYXMuY2FsbChvYmosa2V5KSl7dmFscy5wdXNoKG9ialtrZXldKX19cmV0dXJuIHZhbHN9O2V4cG9ydHMubWVyZ2U9ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGtleSBpbiBiKXtpZihoYXMuY2FsbChiLGtleSkpe2Fba2V5XT1iW2tleV19fXJldHVybiBhfTtleHBvcnRzLmxlbmd0aD1mdW5jdGlvbihvYmope3JldHVybiBleHBvcnRzLmtleXMob2JqKS5sZW5ndGh9O2V4cG9ydHMuaXNFbXB0eT1mdW5jdGlvbihvYmope3JldHVybiAwPT1leHBvcnRzLmxlbmd0aChvYmopfX0se31dLDM4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXt2YXIgcmU9L14oPzooPyFbXjpAXSs6W146QFxcL10qQCkoaHR0cHxodHRwc3x3c3x3c3MpOlxcL1xcLyk/KCg/OigoW146QF0qKSg/OjooW146QF0qKSk/KT9AKT8oKD86W2EtZjAtOV17MCw0fTopezIsN31bYS1mMC05XXswLDR9fFteOlxcLz8jXSopKD86OihcXGQqKSk/KSgoKFxcLyg/OltePyNdKD8hW14/I1xcL10qXFwuW14/I1xcLy5dKyg/Ols/I118JCkpKSpcXC8/KT8oW14/I1xcL10qKSkoPzpcXD8oW14jXSopKT8oPzojKC4qKSk/KS87dmFyIHBhcnRzPVtcInNvdXJjZVwiLFwicHJvdG9jb2xcIixcImF1dGhvcml0eVwiLFwidXNlckluZm9cIixcInVzZXJcIixcInBhc3N3b3JkXCIsXCJob3N0XCIsXCJwb3J0XCIsXCJyZWxhdGl2ZVwiLFwicGF0aFwiLFwiZGlyZWN0b3J5XCIsXCJmaWxlXCIsXCJxdWVyeVwiLFwiYW5jaG9yXCJdO21vZHVsZS5leHBvcnRzPWZ1bmN0aW9uIHBhcnNldXJpKHN0cil7dmFyIG09cmUuZXhlYyhzdHJ8fFwiXCIpLHVyaT17fSxpPTE0O3doaWxlKGktLSl7dXJpW3BhcnRzW2ldXT1tW2ldfHxcIlwifXJldHVybiB1cml9fSx7fV0sMzk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpeyhmdW5jdGlvbihnbG9iYWwpe3ZhciBpc0FycmF5PV9kZXJlcV8oXCJpc2FycmF5XCIpO3ZhciBpc0J1Zj1fZGVyZXFfKFwiLi9pcy1idWZmZXJcIik7ZXhwb3J0cy5kZWNvbnN0cnVjdFBhY2tldD1mdW5jdGlvbihwYWNrZXQpe3ZhciBidWZmZXJzPVtdO3ZhciBwYWNrZXREYXRhPXBhY2tldC5kYXRhO2Z1bmN0aW9uIF9kZWNvbnN0cnVjdFBhY2tldChkYXRhKXtpZighZGF0YSlyZXR1cm4gZGF0YTtpZihpc0J1ZihkYXRhKSl7dmFyIHBsYWNlaG9sZGVyPXtfcGxhY2Vob2xkZXI6dHJ1ZSxudW06YnVmZmVycy5sZW5ndGh9O2J1ZmZlcnMucHVzaChkYXRhKTtyZXR1cm4gcGxhY2Vob2xkZXJ9ZWxzZSBpZihpc0FycmF5KGRhdGEpKXt2YXIgbmV3RGF0YT1uZXcgQXJyYXkoZGF0YS5sZW5ndGgpO2Zvcih2YXIgaT0wO2k8ZGF0YS5sZW5ndGg7aSsrKXtuZXdEYXRhW2ldPV9kZWNvbnN0cnVjdFBhY2tldChkYXRhW2ldKX1yZXR1cm4gbmV3RGF0YX1lbHNlIGlmKFwib2JqZWN0XCI9PXR5cGVvZiBkYXRhJiYhKGRhdGEgaW5zdGFuY2VvZiBEYXRlKSl7dmFyIG5ld0RhdGE9e307Zm9yKHZhciBrZXkgaW4gZGF0YSl7bmV3RGF0YVtrZXldPV9kZWNvbnN0cnVjdFBhY2tldChkYXRhW2tleV0pfXJldHVybiBuZXdEYXRhfXJldHVybiBkYXRhfXZhciBwYWNrPXBhY2tldDtwYWNrLmRhdGE9X2RlY29uc3RydWN0UGFja2V0KHBhY2tldERhdGEpO3BhY2suYXR0YWNobWVudHM9YnVmZmVycy5sZW5ndGg7cmV0dXJue3BhY2tldDpwYWNrLGJ1ZmZlcnM6YnVmZmVyc319O2V4cG9ydHMucmVjb25zdHJ1Y3RQYWNrZXQ9ZnVuY3Rpb24ocGFja2V0LGJ1ZmZlcnMpe3ZhciBjdXJQbGFjZUhvbGRlcj0wO2Z1bmN0aW9uIF9yZWNvbnN0cnVjdFBhY2tldChkYXRhKXtpZihkYXRhJiZkYXRhLl9wbGFjZWhvbGRlcil7dmFyIGJ1Zj1idWZmZXJzW2RhdGEubnVtXTtyZXR1cm4gYnVmfWVsc2UgaWYoaXNBcnJheShkYXRhKSl7Zm9yKHZhciBpPTA7aTxkYXRhLmxlbmd0aDtpKyspe2RhdGFbaV09X3JlY29uc3RydWN0UGFja2V0KGRhdGFbaV0pfXJldHVybiBkYXRhfWVsc2UgaWYoZGF0YSYmXCJvYmplY3RcIj09dHlwZW9mIGRhdGEpe2Zvcih2YXIga2V5IGluIGRhdGEpe2RhdGFba2V5XT1fcmVjb25zdHJ1Y3RQYWNrZXQoZGF0YVtrZXldKX1yZXR1cm4gZGF0YX1yZXR1cm4gZGF0YX1wYWNrZXQuZGF0YT1fcmVjb25zdHJ1Y3RQYWNrZXQocGFja2V0LmRhdGEpO3BhY2tldC5hdHRhY2htZW50cz11bmRlZmluZWQ7cmV0dXJuIHBhY2tldH07ZXhwb3J0cy5yZW1vdmVCbG9icz1mdW5jdGlvbihkYXRhLGNhbGxiYWNrKXtmdW5jdGlvbiBfcmVtb3ZlQmxvYnMob2JqLGN1cktleSxjb250YWluaW5nT2JqZWN0KXtpZighb2JqKXJldHVybiBvYmo7aWYoZ2xvYmFsLkJsb2ImJm9iaiBpbnN0YW5jZW9mIEJsb2J8fGdsb2JhbC5GaWxlJiZvYmogaW5zdGFuY2VvZiBGaWxlKXtwZW5kaW5nQmxvYnMrKzt2YXIgZmlsZVJlYWRlcj1uZXcgRmlsZVJlYWRlcjtmaWxlUmVhZGVyLm9ubG9hZD1mdW5jdGlvbigpe2lmKGNvbnRhaW5pbmdPYmplY3Qpe2NvbnRhaW5pbmdPYmplY3RbY3VyS2V5XT10aGlzLnJlc3VsdH1lbHNle2Jsb2JsZXNzRGF0YT10aGlzLnJlc3VsdH1pZighLS1wZW5kaW5nQmxvYnMpe2NhbGxiYWNrKGJsb2JsZXNzRGF0YSl9fTtmaWxlUmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKG9iail9ZWxzZSBpZihpc0FycmF5KG9iaikpe2Zvcih2YXIgaT0wO2k8b2JqLmxlbmd0aDtpKyspe19yZW1vdmVCbG9icyhvYmpbaV0saSxvYmopfX1lbHNlIGlmKG9iaiYmXCJvYmplY3RcIj09dHlwZW9mIG9iaiYmIWlzQnVmKG9iaikpe2Zvcih2YXIga2V5IGluIG9iail7X3JlbW92ZUJsb2JzKG9ialtrZXldLGtleSxvYmopXG59fX12YXIgcGVuZGluZ0Jsb2JzPTA7dmFyIGJsb2JsZXNzRGF0YT1kYXRhO19yZW1vdmVCbG9icyhibG9ibGVzc0RhdGEpO2lmKCFwZW5kaW5nQmxvYnMpe2NhbGxiYWNrKGJsb2JsZXNzRGF0YSl9fX0pLmNhbGwodGhpcyx0eXBlb2Ygc2VsZiE9PVwidW5kZWZpbmVkXCI/c2VsZjp0eXBlb2Ygd2luZG93IT09XCJ1bmRlZmluZWRcIj93aW5kb3c6e30pfSx7XCIuL2lzLWJ1ZmZlclwiOjQxLGlzYXJyYXk6NDJ9XSw0MDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7dmFyIGRlYnVnPV9kZXJlcV8oXCJkZWJ1Z1wiKShcInNvY2tldC5pby1wYXJzZXJcIik7dmFyIGpzb249X2RlcmVxXyhcImpzb24zXCIpO3ZhciBpc0FycmF5PV9kZXJlcV8oXCJpc2FycmF5XCIpO3ZhciBFbWl0dGVyPV9kZXJlcV8oXCJjb21wb25lbnQtZW1pdHRlclwiKTt2YXIgYmluYXJ5PV9kZXJlcV8oXCIuL2JpbmFyeVwiKTt2YXIgaXNCdWY9X2RlcmVxXyhcIi4vaXMtYnVmZmVyXCIpO2V4cG9ydHMucHJvdG9jb2w9NDtleHBvcnRzLnR5cGVzPVtcIkNPTk5FQ1RcIixcIkRJU0NPTk5FQ1RcIixcIkVWRU5UXCIsXCJCSU5BUllfRVZFTlRcIixcIkFDS1wiLFwiQklOQVJZX0FDS1wiLFwiRVJST1JcIl07ZXhwb3J0cy5DT05ORUNUPTA7ZXhwb3J0cy5ESVNDT05ORUNUPTE7ZXhwb3J0cy5FVkVOVD0yO2V4cG9ydHMuQUNLPTM7ZXhwb3J0cy5FUlJPUj00O2V4cG9ydHMuQklOQVJZX0VWRU5UPTU7ZXhwb3J0cy5CSU5BUllfQUNLPTY7ZXhwb3J0cy5FbmNvZGVyPUVuY29kZXI7ZXhwb3J0cy5EZWNvZGVyPURlY29kZXI7ZnVuY3Rpb24gRW5jb2Rlcigpe31FbmNvZGVyLnByb3RvdHlwZS5lbmNvZGU9ZnVuY3Rpb24ob2JqLGNhbGxiYWNrKXtkZWJ1ZyhcImVuY29kaW5nIHBhY2tldCAlalwiLG9iaik7aWYoZXhwb3J0cy5CSU5BUllfRVZFTlQ9PW9iai50eXBlfHxleHBvcnRzLkJJTkFSWV9BQ0s9PW9iai50eXBlKXtlbmNvZGVBc0JpbmFyeShvYmosY2FsbGJhY2spfWVsc2V7dmFyIGVuY29kaW5nPWVuY29kZUFzU3RyaW5nKG9iaik7Y2FsbGJhY2soW2VuY29kaW5nXSl9fTtmdW5jdGlvbiBlbmNvZGVBc1N0cmluZyhvYmope3ZhciBzdHI9XCJcIjt2YXIgbnNwPWZhbHNlO3N0cis9b2JqLnR5cGU7aWYoZXhwb3J0cy5CSU5BUllfRVZFTlQ9PW9iai50eXBlfHxleHBvcnRzLkJJTkFSWV9BQ0s9PW9iai50eXBlKXtzdHIrPW9iai5hdHRhY2htZW50cztzdHIrPVwiLVwifWlmKG9iai5uc3AmJlwiL1wiIT1vYmoubnNwKXtuc3A9dHJ1ZTtzdHIrPW9iai5uc3B9aWYobnVsbCE9b2JqLmlkKXtpZihuc3Ape3N0cis9XCIsXCI7bnNwPWZhbHNlfXN0cis9b2JqLmlkfWlmKG51bGwhPW9iai5kYXRhKXtpZihuc3Apc3RyKz1cIixcIjtzdHIrPWpzb24uc3RyaW5naWZ5KG9iai5kYXRhKX1kZWJ1ZyhcImVuY29kZWQgJWogYXMgJXNcIixvYmosc3RyKTtyZXR1cm4gc3RyfWZ1bmN0aW9uIGVuY29kZUFzQmluYXJ5KG9iaixjYWxsYmFjayl7ZnVuY3Rpb24gd3JpdGVFbmNvZGluZyhibG9ibGVzc0RhdGEpe3ZhciBkZWNvbnN0cnVjdGlvbj1iaW5hcnkuZGVjb25zdHJ1Y3RQYWNrZXQoYmxvYmxlc3NEYXRhKTt2YXIgcGFjaz1lbmNvZGVBc1N0cmluZyhkZWNvbnN0cnVjdGlvbi5wYWNrZXQpO3ZhciBidWZmZXJzPWRlY29uc3RydWN0aW9uLmJ1ZmZlcnM7YnVmZmVycy51bnNoaWZ0KHBhY2spO2NhbGxiYWNrKGJ1ZmZlcnMpfWJpbmFyeS5yZW1vdmVCbG9icyhvYmosd3JpdGVFbmNvZGluZyl9ZnVuY3Rpb24gRGVjb2Rlcigpe3RoaXMucmVjb25zdHJ1Y3Rvcj1udWxsfUVtaXR0ZXIoRGVjb2Rlci5wcm90b3R5cGUpO0RlY29kZXIucHJvdG90eXBlLmFkZD1mdW5jdGlvbihvYmope3ZhciBwYWNrZXQ7aWYoXCJzdHJpbmdcIj09dHlwZW9mIG9iail7cGFja2V0PWRlY29kZVN0cmluZyhvYmopO2lmKGV4cG9ydHMuQklOQVJZX0VWRU5UPT1wYWNrZXQudHlwZXx8ZXhwb3J0cy5CSU5BUllfQUNLPT1wYWNrZXQudHlwZSl7dGhpcy5yZWNvbnN0cnVjdG9yPW5ldyBCaW5hcnlSZWNvbnN0cnVjdG9yKHBhY2tldCk7aWYodGhpcy5yZWNvbnN0cnVjdG9yLnJlY29uUGFjay5hdHRhY2htZW50cz09MCl7dGhpcy5lbWl0KFwiZGVjb2RlZFwiLHBhY2tldCl9fWVsc2V7dGhpcy5lbWl0KFwiZGVjb2RlZFwiLHBhY2tldCl9fWVsc2UgaWYoaXNCdWYob2JqKXx8b2JqLmJhc2U2NCl7aWYoIXRoaXMucmVjb25zdHJ1Y3Rvcil7dGhyb3cgbmV3IEVycm9yKFwiZ290IGJpbmFyeSBkYXRhIHdoZW4gbm90IHJlY29uc3RydWN0aW5nIGEgcGFja2V0XCIpfWVsc2V7cGFja2V0PXRoaXMucmVjb25zdHJ1Y3Rvci50YWtlQmluYXJ5RGF0YShvYmopO2lmKHBhY2tldCl7dGhpcy5yZWNvbnN0cnVjdG9yPW51bGw7dGhpcy5lbWl0KFwiZGVjb2RlZFwiLHBhY2tldCl9fX1lbHNle3Rocm93IG5ldyBFcnJvcihcIlVua25vd24gdHlwZTogXCIrb2JqKX19O2Z1bmN0aW9uIGRlY29kZVN0cmluZyhzdHIpe3ZhciBwPXt9O3ZhciBpPTA7cC50eXBlPU51bWJlcihzdHIuY2hhckF0KDApKTtpZihudWxsPT1leHBvcnRzLnR5cGVzW3AudHlwZV0pcmV0dXJuIGVycm9yKCk7aWYoZXhwb3J0cy5CSU5BUllfRVZFTlQ9PXAudHlwZXx8ZXhwb3J0cy5CSU5BUllfQUNLPT1wLnR5cGUpe3AuYXR0YWNobWVudHM9XCJcIjt3aGlsZShzdHIuY2hhckF0KCsraSkhPVwiLVwiKXtwLmF0dGFjaG1lbnRzKz1zdHIuY2hhckF0KGkpfXAuYXR0YWNobWVudHM9TnVtYmVyKHAuYXR0YWNobWVudHMpfWlmKFwiL1wiPT1zdHIuY2hhckF0KGkrMSkpe3AubnNwPVwiXCI7d2hpbGUoKytpKXt2YXIgYz1zdHIuY2hhckF0KGkpO2lmKFwiLFwiPT1jKWJyZWFrO3AubnNwKz1jO2lmKGkrMT09c3RyLmxlbmd0aClicmVha319ZWxzZXtwLm5zcD1cIi9cIn12YXIgbmV4dD1zdHIuY2hhckF0KGkrMSk7aWYoXCJcIiE9bmV4dCYmTnVtYmVyKG5leHQpPT1uZXh0KXtwLmlkPVwiXCI7d2hpbGUoKytpKXt2YXIgYz1zdHIuY2hhckF0KGkpO2lmKG51bGw9PWN8fE51bWJlcihjKSE9Yyl7LS1pO2JyZWFrfXAuaWQrPXN0ci5jaGFyQXQoaSk7aWYoaSsxPT1zdHIubGVuZ3RoKWJyZWFrfXAuaWQ9TnVtYmVyKHAuaWQpfWlmKHN0ci5jaGFyQXQoKytpKSl7dHJ5e3AuZGF0YT1qc29uLnBhcnNlKHN0ci5zdWJzdHIoaSkpfWNhdGNoKGUpe3JldHVybiBlcnJvcigpfX1kZWJ1ZyhcImRlY29kZWQgJXMgYXMgJWpcIixzdHIscCk7cmV0dXJuIHB9RGVjb2Rlci5wcm90b3R5cGUuZGVzdHJveT1mdW5jdGlvbigpe2lmKHRoaXMucmVjb25zdHJ1Y3Rvcil7dGhpcy5yZWNvbnN0cnVjdG9yLmZpbmlzaGVkUmVjb25zdHJ1Y3Rpb24oKX19O2Z1bmN0aW9uIEJpbmFyeVJlY29uc3RydWN0b3IocGFja2V0KXt0aGlzLnJlY29uUGFjaz1wYWNrZXQ7dGhpcy5idWZmZXJzPVtdfUJpbmFyeVJlY29uc3RydWN0b3IucHJvdG90eXBlLnRha2VCaW5hcnlEYXRhPWZ1bmN0aW9uKGJpbkRhdGEpe3RoaXMuYnVmZmVycy5wdXNoKGJpbkRhdGEpO2lmKHRoaXMuYnVmZmVycy5sZW5ndGg9PXRoaXMucmVjb25QYWNrLmF0dGFjaG1lbnRzKXt2YXIgcGFja2V0PWJpbmFyeS5yZWNvbnN0cnVjdFBhY2tldCh0aGlzLnJlY29uUGFjayx0aGlzLmJ1ZmZlcnMpO3RoaXMuZmluaXNoZWRSZWNvbnN0cnVjdGlvbigpO3JldHVybiBwYWNrZXR9cmV0dXJuIG51bGx9O0JpbmFyeVJlY29uc3RydWN0b3IucHJvdG90eXBlLmZpbmlzaGVkUmVjb25zdHJ1Y3Rpb249ZnVuY3Rpb24oKXt0aGlzLnJlY29uUGFjaz1udWxsO3RoaXMuYnVmZmVycz1bXX07ZnVuY3Rpb24gZXJyb3IoZGF0YSl7cmV0dXJue3R5cGU6ZXhwb3J0cy5FUlJPUixkYXRhOlwicGFyc2VyIGVycm9yXCJ9fX0se1wiLi9iaW5hcnlcIjozOSxcIi4vaXMtYnVmZmVyXCI6NDEsXCJjb21wb25lbnQtZW1pdHRlclwiOjgsZGVidWc6OSxpc2FycmF5OjQyLGpzb24zOjQzfV0sNDE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpeyhmdW5jdGlvbihnbG9iYWwpe21vZHVsZS5leHBvcnRzPWlzQnVmO2Z1bmN0aW9uIGlzQnVmKG9iail7cmV0dXJuIGdsb2JhbC5CdWZmZXImJmdsb2JhbC5CdWZmZXIuaXNCdWZmZXIob2JqKXx8Z2xvYmFsLkFycmF5QnVmZmVyJiZvYmogaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcn19KS5jYWxsKHRoaXMsdHlwZW9mIHNlbGYhPT1cInVuZGVmaW5lZFwiP3NlbGY6dHlwZW9mIHdpbmRvdyE9PVwidW5kZWZpbmVkXCI/d2luZG93Ont9KX0se31dLDQyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXttb2R1bGUuZXhwb3J0cz1fZGVyZXFfKDMzKX0se31dLDQzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXsoZnVuY3Rpb24od2luZG93KXt2YXIgZ2V0Q2xhc3M9e30udG9TdHJpbmcsaXNQcm9wZXJ0eSxmb3JFYWNoLHVuZGVmO3ZhciBpc0xvYWRlcj10eXBlb2YgZGVmaW5lPT09XCJmdW5jdGlvblwiJiZkZWZpbmUuYW1kO3ZhciBuYXRpdmVKU09OPXR5cGVvZiBKU09OPT1cIm9iamVjdFwiJiZKU09OO3ZhciBKU09OMz10eXBlb2YgZXhwb3J0cz09XCJvYmplY3RcIiYmZXhwb3J0cyYmIWV4cG9ydHMubm9kZVR5cGUmJmV4cG9ydHM7aWYoSlNPTjMmJm5hdGl2ZUpTT04pe0pTT04zLnN0cmluZ2lmeT1uYXRpdmVKU09OLnN0cmluZ2lmeTtKU09OMy5wYXJzZT1uYXRpdmVKU09OLnBhcnNlfWVsc2V7SlNPTjM9d2luZG93LkpTT049bmF0aXZlSlNPTnx8e319dmFyIGlzRXh0ZW5kZWQ9bmV3IERhdGUoLTB4Yzc4MmI1YjgwMGNlYyk7dHJ5e2lzRXh0ZW5kZWQ9aXNFeHRlbmRlZC5nZXRVVENGdWxsWWVhcigpPT0tMTA5MjUyJiZpc0V4dGVuZGVkLmdldFVUQ01vbnRoKCk9PT0wJiZpc0V4dGVuZGVkLmdldFVUQ0RhdGUoKT09PTEmJmlzRXh0ZW5kZWQuZ2V0VVRDSG91cnMoKT09MTAmJmlzRXh0ZW5kZWQuZ2V0VVRDTWludXRlcygpPT0zNyYmaXNFeHRlbmRlZC5nZXRVVENTZWNvbmRzKCk9PTYmJmlzRXh0ZW5kZWQuZ2V0VVRDTWlsbGlzZWNvbmRzKCk9PTcwOH1jYXRjaChleGNlcHRpb24pe31mdW5jdGlvbiBoYXMobmFtZSl7aWYoaGFzW25hbWVdIT09dW5kZWYpe3JldHVybiBoYXNbbmFtZV19dmFyIGlzU3VwcG9ydGVkO2lmKG5hbWU9PVwiYnVnLXN0cmluZy1jaGFyLWluZGV4XCIpe2lzU3VwcG9ydGVkPVwiYVwiWzBdIT1cImFcIn1lbHNlIGlmKG5hbWU9PVwianNvblwiKXtpc1N1cHBvcnRlZD1oYXMoXCJqc29uLXN0cmluZ2lmeVwiKSYmaGFzKFwianNvbi1wYXJzZVwiKX1lbHNle3ZhciB2YWx1ZSxzZXJpYWxpemVkPSd7XCJhXCI6WzEsdHJ1ZSxmYWxzZSxudWxsLFwiXFxcXHUwMDAwXFxcXGJcXFxcblxcXFxmXFxcXHJcXFxcdFwiXX0nO2lmKG5hbWU9PVwianNvbi1zdHJpbmdpZnlcIil7dmFyIHN0cmluZ2lmeT1KU09OMy5zdHJpbmdpZnksc3RyaW5naWZ5U3VwcG9ydGVkPXR5cGVvZiBzdHJpbmdpZnk9PVwiZnVuY3Rpb25cIiYmaXNFeHRlbmRlZDtpZihzdHJpbmdpZnlTdXBwb3J0ZWQpeyh2YWx1ZT1mdW5jdGlvbigpe3JldHVybiAxfSkudG9KU09OPXZhbHVlO3RyeXtzdHJpbmdpZnlTdXBwb3J0ZWQ9c3RyaW5naWZ5KDApPT09XCIwXCImJnN0cmluZ2lmeShuZXcgTnVtYmVyKT09PVwiMFwiJiZzdHJpbmdpZnkobmV3IFN0cmluZyk9PSdcIlwiJyYmc3RyaW5naWZ5KGdldENsYXNzKT09PXVuZGVmJiZzdHJpbmdpZnkodW5kZWYpPT09dW5kZWYmJnN0cmluZ2lmeSgpPT09dW5kZWYmJnN0cmluZ2lmeSh2YWx1ZSk9PT1cIjFcIiYmc3RyaW5naWZ5KFt2YWx1ZV0pPT1cIlsxXVwiJiZzdHJpbmdpZnkoW3VuZGVmXSk9PVwiW251bGxdXCImJnN0cmluZ2lmeShudWxsKT09XCJudWxsXCImJnN0cmluZ2lmeShbdW5kZWYsZ2V0Q2xhc3MsbnVsbF0pPT1cIltudWxsLG51bGwsbnVsbF1cIiYmc3RyaW5naWZ5KHthOlt2YWx1ZSx0cnVlLGZhbHNlLG51bGwsXCJcXHgwMFxcYlxcblxcZlxcclx0XCJdfSk9PXNlcmlhbGl6ZWQmJnN0cmluZ2lmeShudWxsLHZhbHVlKT09PVwiMVwiJiZzdHJpbmdpZnkoWzEsMl0sbnVsbCwxKT09XCJbXFxuIDEsXFxuIDJcXG5dXCImJnN0cmluZ2lmeShuZXcgRGF0ZSgtODY0ZTEzKSk9PSdcIi0yNzE4MjEtMDQtMjBUMDA6MDA6MDAuMDAwWlwiJyYmc3RyaW5naWZ5KG5ldyBEYXRlKDg2NGUxMykpPT0nXCIrMjc1NzYwLTA5LTEzVDAwOjAwOjAwLjAwMFpcIicmJnN0cmluZ2lmeShuZXcgRGF0ZSgtNjIxOTg3NTUyZTUpKT09J1wiLTAwMDAwMS0wMS0wMVQwMDowMDowMC4wMDBaXCInJiZzdHJpbmdpZnkobmV3IERhdGUoLTEpKT09J1wiMTk2OS0xMi0zMVQyMzo1OTo1OS45OTlaXCInfWNhdGNoKGV4Y2VwdGlvbil7c3RyaW5naWZ5U3VwcG9ydGVkPWZhbHNlfX1pc1N1cHBvcnRlZD1zdHJpbmdpZnlTdXBwb3J0ZWR9aWYobmFtZT09XCJqc29uLXBhcnNlXCIpe3ZhciBwYXJzZT1KU09OMy5wYXJzZTtpZih0eXBlb2YgcGFyc2U9PVwiZnVuY3Rpb25cIil7dHJ5e2lmKHBhcnNlKFwiMFwiKT09PTAmJiFwYXJzZShmYWxzZSkpe3ZhbHVlPXBhcnNlKHNlcmlhbGl6ZWQpO3ZhciBwYXJzZVN1cHBvcnRlZD12YWx1ZVtcImFcIl0ubGVuZ3RoPT01JiZ2YWx1ZVtcImFcIl1bMF09PT0xO2lmKHBhcnNlU3VwcG9ydGVkKXt0cnl7cGFyc2VTdXBwb3J0ZWQ9IXBhcnNlKCdcIlx0XCInKX1jYXRjaChleGNlcHRpb24pe31pZihwYXJzZVN1cHBvcnRlZCl7dHJ5e3BhcnNlU3VwcG9ydGVkPXBhcnNlKFwiMDFcIikhPT0xfWNhdGNoKGV4Y2VwdGlvbil7fX1pZihwYXJzZVN1cHBvcnRlZCl7dHJ5e3BhcnNlU3VwcG9ydGVkPXBhcnNlKFwiMS5cIikhPT0xfWNhdGNoKGV4Y2VwdGlvbil7fX19fX1jYXRjaChleGNlcHRpb24pe3BhcnNlU3VwcG9ydGVkPWZhbHNlfX1pc1N1cHBvcnRlZD1wYXJzZVN1cHBvcnRlZH19cmV0dXJuIGhhc1tuYW1lXT0hIWlzU3VwcG9ydGVkfWlmKCFoYXMoXCJqc29uXCIpKXt2YXIgZnVuY3Rpb25DbGFzcz1cIltvYmplY3QgRnVuY3Rpb25dXCI7dmFyIGRhdGVDbGFzcz1cIltvYmplY3QgRGF0ZV1cIjt2YXIgbnVtYmVyQ2xhc3M9XCJbb2JqZWN0IE51bWJlcl1cIjt2YXIgc3RyaW5nQ2xhc3M9XCJbb2JqZWN0IFN0cmluZ11cIjt2YXIgYXJyYXlDbGFzcz1cIltvYmplY3QgQXJyYXldXCI7dmFyIGJvb2xlYW5DbGFzcz1cIltvYmplY3QgQm9vbGVhbl1cIjt2YXIgY2hhckluZGV4QnVnZ3k9aGFzKFwiYnVnLXN0cmluZy1jaGFyLWluZGV4XCIpO2lmKCFpc0V4dGVuZGVkKXt2YXIgZmxvb3I9TWF0aC5mbG9vcjt2YXIgTW9udGhzPVswLDMxLDU5LDkwLDEyMCwxNTEsMTgxLDIxMiwyNDMsMjczLDMwNCwzMzRdO3ZhciBnZXREYXk9ZnVuY3Rpb24oeWVhcixtb250aCl7cmV0dXJuIE1vbnRoc1ttb250aF0rMzY1Kih5ZWFyLTE5NzApK2Zsb29yKCh5ZWFyLTE5NjkrKG1vbnRoPSsobW9udGg+MSkpKS80KS1mbG9vcigoeWVhci0xOTAxK21vbnRoKS8xMDApK2Zsb29yKCh5ZWFyLTE2MDErbW9udGgpLzQwMCl9fWlmKCEoaXNQcm9wZXJ0eT17fS5oYXNPd25Qcm9wZXJ0eSkpe2lzUHJvcGVydHk9ZnVuY3Rpb24ocHJvcGVydHkpe3ZhciBtZW1iZXJzPXt9LGNvbnN0cnVjdG9yO2lmKChtZW1iZXJzLl9fcHJvdG9fXz1udWxsLG1lbWJlcnMuX19wcm90b19fPXt0b1N0cmluZzoxfSxtZW1iZXJzKS50b1N0cmluZyE9Z2V0Q2xhc3Mpe2lzUHJvcGVydHk9ZnVuY3Rpb24ocHJvcGVydHkpe3ZhciBvcmlnaW5hbD10aGlzLl9fcHJvdG9fXyxyZXN1bHQ9cHJvcGVydHkgaW4odGhpcy5fX3Byb3RvX189bnVsbCx0aGlzKTt0aGlzLl9fcHJvdG9fXz1vcmlnaW5hbDtyZXR1cm4gcmVzdWx0fX1lbHNle2NvbnN0cnVjdG9yPW1lbWJlcnMuY29uc3RydWN0b3I7aXNQcm9wZXJ0eT1mdW5jdGlvbihwcm9wZXJ0eSl7dmFyIHBhcmVudD0odGhpcy5jb25zdHJ1Y3Rvcnx8Y29uc3RydWN0b3IpLnByb3RvdHlwZTtyZXR1cm4gcHJvcGVydHkgaW4gdGhpcyYmIShwcm9wZXJ0eSBpbiBwYXJlbnQmJnRoaXNbcHJvcGVydHldPT09cGFyZW50W3Byb3BlcnR5XSl9fW1lbWJlcnM9bnVsbDtyZXR1cm4gaXNQcm9wZXJ0eS5jYWxsKHRoaXMscHJvcGVydHkpfX12YXIgUHJpbWl0aXZlVHlwZXM9e1wiYm9vbGVhblwiOjEsbnVtYmVyOjEsc3RyaW5nOjEsdW5kZWZpbmVkOjF9O3ZhciBpc0hvc3RUeXBlPWZ1bmN0aW9uKG9iamVjdCxwcm9wZXJ0eSl7dmFyIHR5cGU9dHlwZW9mIG9iamVjdFtwcm9wZXJ0eV07cmV0dXJuIHR5cGU9PVwib2JqZWN0XCI/ISFvYmplY3RbcHJvcGVydHldOiFQcmltaXRpdmVUeXBlc1t0eXBlXX07Zm9yRWFjaD1mdW5jdGlvbihvYmplY3QsY2FsbGJhY2spe3ZhciBzaXplPTAsUHJvcGVydGllcyxtZW1iZXJzLHByb3BlcnR5OyhQcm9wZXJ0aWVzPWZ1bmN0aW9uKCl7dGhpcy52YWx1ZU9mPTB9KS5wcm90b3R5cGUudmFsdWVPZj0wO21lbWJlcnM9bmV3IFByb3BlcnRpZXM7Zm9yKHByb3BlcnR5IGluIG1lbWJlcnMpe2lmKGlzUHJvcGVydHkuY2FsbChtZW1iZXJzLHByb3BlcnR5KSl7c2l6ZSsrfX1Qcm9wZXJ0aWVzPW1lbWJlcnM9bnVsbDtpZighc2l6ZSl7bWVtYmVycz1bXCJ2YWx1ZU9mXCIsXCJ0b1N0cmluZ1wiLFwidG9Mb2NhbGVTdHJpbmdcIixcInByb3BlcnR5SXNFbnVtZXJhYmxlXCIsXCJpc1Byb3RvdHlwZU9mXCIsXCJoYXNPd25Qcm9wZXJ0eVwiLFwiY29uc3RydWN0b3JcIl07Zm9yRWFjaD1mdW5jdGlvbihvYmplY3QsY2FsbGJhY2spe3ZhciBpc0Z1bmN0aW9uPWdldENsYXNzLmNhbGwob2JqZWN0KT09ZnVuY3Rpb25DbGFzcyxwcm9wZXJ0eSxsZW5ndGg7dmFyIGhhc1Byb3BlcnR5PSFpc0Z1bmN0aW9uJiZ0eXBlb2Ygb2JqZWN0LmNvbnN0cnVjdG9yIT1cImZ1bmN0aW9uXCImJmlzSG9zdFR5cGUob2JqZWN0LFwiaGFzT3duUHJvcGVydHlcIik/b2JqZWN0Lmhhc093blByb3BlcnR5OmlzUHJvcGVydHk7Zm9yKHByb3BlcnR5IGluIG9iamVjdCl7aWYoIShpc0Z1bmN0aW9uJiZwcm9wZXJ0eT09XCJwcm90b3R5cGVcIikmJmhhc1Byb3BlcnR5LmNhbGwob2JqZWN0LHByb3BlcnR5KSl7Y2FsbGJhY2socHJvcGVydHkpfX1mb3IobGVuZ3RoPW1lbWJlcnMubGVuZ3RoO3Byb3BlcnR5PW1lbWJlcnNbLS1sZW5ndGhdO2hhc1Byb3BlcnR5LmNhbGwob2JqZWN0LHByb3BlcnR5KSYmY2FsbGJhY2socHJvcGVydHkpKTt9fWVsc2UgaWYoc2l6ZT09Mil7Zm9yRWFjaD1mdW5jdGlvbihvYmplY3QsY2FsbGJhY2spe3ZhciBtZW1iZXJzPXt9LGlzRnVuY3Rpb249Z2V0Q2xhc3MuY2FsbChvYmplY3QpPT1mdW5jdGlvbkNsYXNzLHByb3BlcnR5O2Zvcihwcm9wZXJ0eSBpbiBvYmplY3Qpe2lmKCEoaXNGdW5jdGlvbiYmcHJvcGVydHk9PVwicHJvdG90eXBlXCIpJiYhaXNQcm9wZXJ0eS5jYWxsKG1lbWJlcnMscHJvcGVydHkpJiYobWVtYmVyc1twcm9wZXJ0eV09MSkmJmlzUHJvcGVydHkuY2FsbChvYmplY3QscHJvcGVydHkpKXtjYWxsYmFjayhwcm9wZXJ0eSl9fX19ZWxzZXtmb3JFYWNoPWZ1bmN0aW9uKG9iamVjdCxjYWxsYmFjayl7dmFyIGlzRnVuY3Rpb249Z2V0Q2xhc3MuY2FsbChvYmplY3QpPT1mdW5jdGlvbkNsYXNzLHByb3BlcnR5LGlzQ29uc3RydWN0b3I7Zm9yKHByb3BlcnR5IGluIG9iamVjdCl7aWYoIShpc0Z1bmN0aW9uJiZwcm9wZXJ0eT09XCJwcm90b3R5cGVcIikmJmlzUHJvcGVydHkuY2FsbChvYmplY3QscHJvcGVydHkpJiYhKGlzQ29uc3RydWN0b3I9cHJvcGVydHk9PT1cImNvbnN0cnVjdG9yXCIpKXtjYWxsYmFjayhwcm9wZXJ0eSl9fWlmKGlzQ29uc3RydWN0b3J8fGlzUHJvcGVydHkuY2FsbChvYmplY3QscHJvcGVydHk9XCJjb25zdHJ1Y3RvclwiKSl7Y2FsbGJhY2socHJvcGVydHkpfX19cmV0dXJuIGZvckVhY2gob2JqZWN0LGNhbGxiYWNrKX07aWYoIWhhcyhcImpzb24tc3RyaW5naWZ5XCIpKXt2YXIgRXNjYXBlcz17OTI6XCJcXFxcXFxcXFwiLDM0OidcXFxcXCInLDg6XCJcXFxcYlwiLDEyOlwiXFxcXGZcIiwxMDpcIlxcXFxuXCIsMTM6XCJcXFxcclwiLDk6XCJcXFxcdFwifTt2YXIgbGVhZGluZ1plcm9lcz1cIjAwMDAwMFwiO3ZhciB0b1BhZGRlZFN0cmluZz1mdW5jdGlvbih3aWR0aCx2YWx1ZSl7cmV0dXJuKGxlYWRpbmdaZXJvZXMrKHZhbHVlfHwwKSkuc2xpY2UoLXdpZHRoKX07dmFyIHVuaWNvZGVQcmVmaXg9XCJcXFxcdTAwXCI7dmFyIHF1b3RlPWZ1bmN0aW9uKHZhbHVlKXt2YXIgcmVzdWx0PSdcIicsaW5kZXg9MCxsZW5ndGg9dmFsdWUubGVuZ3RoLGlzTGFyZ2U9bGVuZ3RoPjEwJiZjaGFySW5kZXhCdWdneSxzeW1ib2xzO2lmKGlzTGFyZ2Upe3N5bWJvbHM9dmFsdWUuc3BsaXQoXCJcIil9Zm9yKDtpbmRleDxsZW5ndGg7aW5kZXgrKyl7dmFyIGNoYXJDb2RlPXZhbHVlLmNoYXJDb2RlQXQoaW5kZXgpO3N3aXRjaChjaGFyQ29kZSl7Y2FzZSA4OmNhc2UgOTpjYXNlIDEwOmNhc2UgMTI6Y2FzZSAxMzpjYXNlIDM0OmNhc2UgOTI6cmVzdWx0Kz1Fc2NhcGVzW2NoYXJDb2RlXTticmVhaztkZWZhdWx0OmlmKGNoYXJDb2RlPDMyKXtyZXN1bHQrPXVuaWNvZGVQcmVmaXgrdG9QYWRkZWRTdHJpbmcoMixjaGFyQ29kZS50b1N0cmluZygxNikpO2JyZWFrfXJlc3VsdCs9aXNMYXJnZT9zeW1ib2xzW2luZGV4XTpjaGFySW5kZXhCdWdneT92YWx1ZS5jaGFyQXQoaW5kZXgpOnZhbHVlW2luZGV4XX19cmV0dXJuIHJlc3VsdCsnXCInfTt2YXIgc2VyaWFsaXplPWZ1bmN0aW9uKHByb3BlcnR5LG9iamVjdCxjYWxsYmFjayxwcm9wZXJ0aWVzLHdoaXRlc3BhY2UsaW5kZW50YXRpb24sc3RhY2spe3ZhciB2YWx1ZSxjbGFzc05hbWUseWVhcixtb250aCxkYXRlLHRpbWUsaG91cnMsbWludXRlcyxzZWNvbmRzLG1pbGxpc2Vjb25kcyxyZXN1bHRzLGVsZW1lbnQsaW5kZXgsbGVuZ3RoLHByZWZpeCxyZXN1bHQ7dHJ5e3ZhbHVlPW9iamVjdFtwcm9wZXJ0eV19Y2F0Y2goZXhjZXB0aW9uKXt9aWYodHlwZW9mIHZhbHVlPT1cIm9iamVjdFwiJiZ2YWx1ZSl7Y2xhc3NOYW1lPWdldENsYXNzLmNhbGwodmFsdWUpO2lmKGNsYXNzTmFtZT09ZGF0ZUNsYXNzJiYhaXNQcm9wZXJ0eS5jYWxsKHZhbHVlLFwidG9KU09OXCIpKXtpZih2YWx1ZT4tMS8wJiZ2YWx1ZTwxLzApe2lmKGdldERheSl7ZGF0ZT1mbG9vcih2YWx1ZS84NjRlNSk7Zm9yKHllYXI9Zmxvb3IoZGF0ZS8zNjUuMjQyNSkrMTk3MC0xO2dldERheSh5ZWFyKzEsMCk8PWRhdGU7eWVhcisrKTtmb3IobW9udGg9Zmxvb3IoKGRhdGUtZ2V0RGF5KHllYXIsMCkpLzMwLjQyKTtnZXREYXkoeWVhcixtb250aCsxKTw9ZGF0ZTttb250aCsrKTtkYXRlPTErZGF0ZS1nZXREYXkoeWVhcixtb250aCk7dGltZT0odmFsdWUlODY0ZTUrODY0ZTUpJTg2NGU1O2hvdXJzPWZsb29yKHRpbWUvMzZlNSklMjQ7bWludXRlcz1mbG9vcih0aW1lLzZlNCklNjA7c2Vjb25kcz1mbG9vcih0aW1lLzFlMyklNjA7bWlsbGlzZWNvbmRzPXRpbWUlMWUzfWVsc2V7eWVhcj12YWx1ZS5nZXRVVENGdWxsWWVhcigpO21vbnRoPXZhbHVlLmdldFVUQ01vbnRoKCk7ZGF0ZT12YWx1ZS5nZXRVVENEYXRlKCk7aG91cnM9dmFsdWUuZ2V0VVRDSG91cnMoKTttaW51dGVzPXZhbHVlLmdldFVUQ01pbnV0ZXMoKTtzZWNvbmRzPXZhbHVlLmdldFVUQ1NlY29uZHMoKTttaWxsaXNlY29uZHM9dmFsdWUuZ2V0VVRDTWlsbGlzZWNvbmRzKCl9dmFsdWU9KHllYXI8PTB8fHllYXI+PTFlND8oeWVhcjwwP1wiLVwiOlwiK1wiKSt0b1BhZGRlZFN0cmluZyg2LHllYXI8MD8teWVhcjp5ZWFyKTp0b1BhZGRlZFN0cmluZyg0LHllYXIpKStcIi1cIit0b1BhZGRlZFN0cmluZygyLG1vbnRoKzEpK1wiLVwiK3RvUGFkZGVkU3RyaW5nKDIsZGF0ZSkrXCJUXCIrdG9QYWRkZWRTdHJpbmcoMixob3VycykrXCI6XCIrdG9QYWRkZWRTdHJpbmcoMixtaW51dGVzKStcIjpcIit0b1BhZGRlZFN0cmluZygyLHNlY29uZHMpK1wiLlwiK3RvUGFkZGVkU3RyaW5nKDMsbWlsbGlzZWNvbmRzKStcIlpcIn1lbHNle3ZhbHVlPW51bGx9fWVsc2UgaWYodHlwZW9mIHZhbHVlLnRvSlNPTj09XCJmdW5jdGlvblwiJiYoY2xhc3NOYW1lIT1udW1iZXJDbGFzcyYmY2xhc3NOYW1lIT1zdHJpbmdDbGFzcyYmY2xhc3NOYW1lIT1hcnJheUNsYXNzfHxpc1Byb3BlcnR5LmNhbGwodmFsdWUsXCJ0b0pTT05cIikpKXt2YWx1ZT12YWx1ZS50b0pTT04ocHJvcGVydHkpfX1pZihjYWxsYmFjayl7dmFsdWU9Y2FsbGJhY2suY2FsbChvYmplY3QscHJvcGVydHksdmFsdWUpfWlmKHZhbHVlPT09bnVsbCl7cmV0dXJuXCJudWxsXCJ9Y2xhc3NOYW1lPWdldENsYXNzLmNhbGwodmFsdWUpO2lmKGNsYXNzTmFtZT09Ym9vbGVhbkNsYXNzKXtyZXR1cm5cIlwiK3ZhbHVlfWVsc2UgaWYoY2xhc3NOYW1lPT1udW1iZXJDbGFzcyl7cmV0dXJuIHZhbHVlPi0xLzAmJnZhbHVlPDEvMD9cIlwiK3ZhbHVlOlwibnVsbFwifWVsc2UgaWYoY2xhc3NOYW1lPT1zdHJpbmdDbGFzcyl7cmV0dXJuIHF1b3RlKFwiXCIrdmFsdWUpfWlmKHR5cGVvZiB2YWx1ZT09XCJvYmplY3RcIil7Zm9yKGxlbmd0aD1zdGFjay5sZW5ndGg7bGVuZ3RoLS07KXtpZihzdGFja1tsZW5ndGhdPT09dmFsdWUpe3Rocm93IFR5cGVFcnJvcigpfX1zdGFjay5wdXNoKHZhbHVlKTtyZXN1bHRzPVtdO3ByZWZpeD1pbmRlbnRhdGlvbjtpbmRlbnRhdGlvbis9d2hpdGVzcGFjZTtpZihjbGFzc05hbWU9PWFycmF5Q2xhc3Mpe2ZvcihpbmRleD0wLGxlbmd0aD12YWx1ZS5sZW5ndGg7aW5kZXg8bGVuZ3RoO2luZGV4Kyspe2VsZW1lbnQ9c2VyaWFsaXplKGluZGV4LHZhbHVlLGNhbGxiYWNrLHByb3BlcnRpZXMsd2hpdGVzcGFjZSxpbmRlbnRhdGlvbixzdGFjayk7cmVzdWx0cy5wdXNoKGVsZW1lbnQ9PT11bmRlZj9cIm51bGxcIjplbGVtZW50KX1yZXN1bHQ9cmVzdWx0cy5sZW5ndGg/d2hpdGVzcGFjZT9cIltcXG5cIitpbmRlbnRhdGlvbityZXN1bHRzLmpvaW4oXCIsXFxuXCIraW5kZW50YXRpb24pK1wiXFxuXCIrcHJlZml4K1wiXVwiOlwiW1wiK3Jlc3VsdHMuam9pbihcIixcIikrXCJdXCI6XCJbXVwifWVsc2V7Zm9yRWFjaChwcm9wZXJ0aWVzfHx2YWx1ZSxmdW5jdGlvbihwcm9wZXJ0eSl7dmFyIGVsZW1lbnQ9c2VyaWFsaXplKHByb3BlcnR5LHZhbHVlLGNhbGxiYWNrLHByb3BlcnRpZXMsd2hpdGVzcGFjZSxpbmRlbnRhdGlvbixzdGFjayk7aWYoZWxlbWVudCE9PXVuZGVmKXtyZXN1bHRzLnB1c2gocXVvdGUocHJvcGVydHkpK1wiOlwiKyh3aGl0ZXNwYWNlP1wiIFwiOlwiXCIpK2VsZW1lbnQpfX0pO3Jlc3VsdD1yZXN1bHRzLmxlbmd0aD93aGl0ZXNwYWNlP1wie1xcblwiK2luZGVudGF0aW9uK3Jlc3VsdHMuam9pbihcIixcXG5cIitpbmRlbnRhdGlvbikrXCJcXG5cIitwcmVmaXgrXCJ9XCI6XCJ7XCIrcmVzdWx0cy5qb2luKFwiLFwiKStcIn1cIjpcInt9XCJ9c3RhY2sucG9wKCk7cmV0dXJuIHJlc3VsdH19O0pTT04zLnN0cmluZ2lmeT1mdW5jdGlvbihzb3VyY2UsZmlsdGVyLHdpZHRoKXt2YXIgd2hpdGVzcGFjZSxjYWxsYmFjayxwcm9wZXJ0aWVzLGNsYXNzTmFtZTtpZih0eXBlb2YgZmlsdGVyPT1cImZ1bmN0aW9uXCJ8fHR5cGVvZiBmaWx0ZXI9PVwib2JqZWN0XCImJmZpbHRlcil7aWYoKGNsYXNzTmFtZT1nZXRDbGFzcy5jYWxsKGZpbHRlcikpPT1mdW5jdGlvbkNsYXNzKXtjYWxsYmFjaz1maWx0ZXJ9ZWxzZSBpZihjbGFzc05hbWU9PWFycmF5Q2xhc3Mpe3Byb3BlcnRpZXM9e307Zm9yKHZhciBpbmRleD0wLGxlbmd0aD1maWx0ZXIubGVuZ3RoLHZhbHVlO2luZGV4PGxlbmd0aDt2YWx1ZT1maWx0ZXJbaW5kZXgrK10sKGNsYXNzTmFtZT1nZXRDbGFzcy5jYWxsKHZhbHVlKSxjbGFzc05hbWU9PXN0cmluZ0NsYXNzfHxjbGFzc05hbWU9PW51bWJlckNsYXNzKSYmKHByb3BlcnRpZXNbdmFsdWVdPTEpKTt9fWlmKHdpZHRoKXtpZigoY2xhc3NOYW1lPWdldENsYXNzLmNhbGwod2lkdGgpKT09bnVtYmVyQ2xhc3Mpe2lmKCh3aWR0aC09d2lkdGglMSk+MCl7Zm9yKHdoaXRlc3BhY2U9XCJcIix3aWR0aD4xMCYmKHdpZHRoPTEwKTt3aGl0ZXNwYWNlLmxlbmd0aDx3aWR0aDt3aGl0ZXNwYWNlKz1cIiBcIik7fX1lbHNlIGlmKGNsYXNzTmFtZT09c3RyaW5nQ2xhc3Mpe3doaXRlc3BhY2U9d2lkdGgubGVuZ3RoPD0xMD93aWR0aDp3aWR0aC5zbGljZSgwLDEwKX19cmV0dXJuIHNlcmlhbGl6ZShcIlwiLCh2YWx1ZT17fSx2YWx1ZVtcIlwiXT1zb3VyY2UsdmFsdWUpLGNhbGxiYWNrLHByb3BlcnRpZXMsd2hpdGVzcGFjZSxcIlwiLFtdKX19aWYoIWhhcyhcImpzb24tcGFyc2VcIikpe3ZhciBmcm9tQ2hhckNvZGU9U3RyaW5nLmZyb21DaGFyQ29kZTt2YXIgVW5lc2NhcGVzPXs5MjpcIlxcXFxcIiwzNDonXCInLDQ3OlwiL1wiLDk4OlwiXFxiXCIsMTE2OlwiXHRcIiwxMTA6XCJcXG5cIiwxMDI6XCJcXGZcIiwxMTQ6XCJcXHJcIn07dmFyIEluZGV4LFNvdXJjZTt2YXIgYWJvcnQ9ZnVuY3Rpb24oKXtJbmRleD1Tb3VyY2U9bnVsbDt0aHJvdyBTeW50YXhFcnJvcigpfTt2YXIgbGV4PWZ1bmN0aW9uKCl7dmFyIHNvdXJjZT1Tb3VyY2UsbGVuZ3RoPXNvdXJjZS5sZW5ndGgsdmFsdWUsYmVnaW4scG9zaXRpb24saXNTaWduZWQsY2hhckNvZGU7d2hpbGUoSW5kZXg8bGVuZ3RoKXtjaGFyQ29kZT1zb3VyY2UuY2hhckNvZGVBdChJbmRleCk7c3dpdGNoKGNoYXJDb2RlKXtjYXNlIDk6Y2FzZSAxMDpjYXNlIDEzOmNhc2UgMzI6SW5kZXgrKzticmVhaztjYXNlIDEyMzpjYXNlIDEyNTpjYXNlIDkxOmNhc2UgOTM6Y2FzZSA1ODpjYXNlIDQ0OnZhbHVlPWNoYXJJbmRleEJ1Z2d5P3NvdXJjZS5jaGFyQXQoSW5kZXgpOnNvdXJjZVtJbmRleF07SW5kZXgrKztyZXR1cm4gdmFsdWU7Y2FzZSAzNDpmb3IodmFsdWU9XCJAXCIsSW5kZXgrKztJbmRleDxsZW5ndGg7KXtjaGFyQ29kZT1zb3VyY2UuY2hhckNvZGVBdChJbmRleCk7aWYoY2hhckNvZGU8MzIpe2Fib3J0KCl9ZWxzZSBpZihjaGFyQ29kZT09OTIpe2NoYXJDb2RlPXNvdXJjZS5jaGFyQ29kZUF0KCsrSW5kZXgpO3N3aXRjaChjaGFyQ29kZSl7Y2FzZSA5MjpjYXNlIDM0OmNhc2UgNDc6Y2FzZSA5ODpjYXNlIDExNjpjYXNlIDExMDpjYXNlIDEwMjpjYXNlIDExNDp2YWx1ZSs9VW5lc2NhcGVzW2NoYXJDb2RlXTtJbmRleCsrO2JyZWFrO2Nhc2UgMTE3OmJlZ2luPSsrSW5kZXg7Zm9yKHBvc2l0aW9uPUluZGV4KzQ7SW5kZXg8cG9zaXRpb247SW5kZXgrKyl7Y2hhckNvZGU9c291cmNlLmNoYXJDb2RlQXQoSW5kZXgpO2lmKCEoY2hhckNvZGU+PTQ4JiZjaGFyQ29kZTw9NTd8fGNoYXJDb2RlPj05NyYmY2hhckNvZGU8PTEwMnx8Y2hhckNvZGU+PTY1JiZjaGFyQ29kZTw9NzApKXthYm9ydCgpfX12YWx1ZSs9ZnJvbUNoYXJDb2RlKFwiMHhcIitzb3VyY2Uuc2xpY2UoYmVnaW4sSW5kZXgpKTticmVhaztkZWZhdWx0OmFib3J0KCl9fWVsc2V7aWYoY2hhckNvZGU9PTM0KXticmVha31jaGFyQ29kZT1zb3VyY2UuY2hhckNvZGVBdChJbmRleCk7YmVnaW49SW5kZXg7d2hpbGUoY2hhckNvZGU+PTMyJiZjaGFyQ29kZSE9OTImJmNoYXJDb2RlIT0zNCl7Y2hhckNvZGU9c291cmNlLmNoYXJDb2RlQXQoKytJbmRleCl9dmFsdWUrPXNvdXJjZS5zbGljZShiZWdpbixJbmRleCl9fWlmKHNvdXJjZS5jaGFyQ29kZUF0KEluZGV4KT09MzQpe0luZGV4Kys7cmV0dXJuIHZhbHVlfWFib3J0KCk7ZGVmYXVsdDpiZWdpbj1JbmRleDtpZihjaGFyQ29kZT09NDUpe2lzU2lnbmVkPXRydWU7Y2hhckNvZGU9c291cmNlLmNoYXJDb2RlQXQoKytJbmRleCl9aWYoY2hhckNvZGU+PTQ4JiZjaGFyQ29kZTw9NTcpe2lmKGNoYXJDb2RlPT00OCYmKGNoYXJDb2RlPXNvdXJjZS5jaGFyQ29kZUF0KEluZGV4KzEpLGNoYXJDb2RlPj00OCYmY2hhckNvZGU8PTU3KSl7YWJvcnQoKX1pc1NpZ25lZD1mYWxzZTtmb3IoO0luZGV4PGxlbmd0aCYmKGNoYXJDb2RlPXNvdXJjZS5jaGFyQ29kZUF0KEluZGV4KSxjaGFyQ29kZT49NDgmJmNoYXJDb2RlPD01Nyk7SW5kZXgrKyk7aWYoc291cmNlLmNoYXJDb2RlQXQoSW5kZXgpPT00Nil7cG9zaXRpb249KytJbmRleDtmb3IoO3Bvc2l0aW9uPGxlbmd0aCYmKGNoYXJDb2RlPXNvdXJjZS5jaGFyQ29kZUF0KHBvc2l0aW9uKSxjaGFyQ29kZT49NDgmJmNoYXJDb2RlPD01Nyk7cG9zaXRpb24rKyk7aWYocG9zaXRpb249PUluZGV4KXthYm9ydCgpfUluZGV4PXBvc2l0aW9ufWNoYXJDb2RlPXNvdXJjZS5jaGFyQ29kZUF0KEluZGV4KTtpZihjaGFyQ29kZT09MTAxfHxjaGFyQ29kZT09Njkpe2NoYXJDb2RlPXNvdXJjZS5jaGFyQ29kZUF0KCsrSW5kZXgpO2lmKGNoYXJDb2RlPT00M3x8Y2hhckNvZGU9PTQ1KXtJbmRleCsrfWZvcihwb3NpdGlvbj1JbmRleDtwb3NpdGlvbjxsZW5ndGgmJihjaGFyQ29kZT1zb3VyY2UuY2hhckNvZGVBdChwb3NpdGlvbiksY2hhckNvZGU+PTQ4JiZjaGFyQ29kZTw9NTcpO3Bvc2l0aW9uKyspO2lmKHBvc2l0aW9uPT1JbmRleCl7YWJvcnQoKX1JbmRleD1wb3NpdGlvbn1yZXR1cm4rc291cmNlLnNsaWNlKGJlZ2luLEluZGV4KX1pZihpc1NpZ25lZCl7YWJvcnQoKX1pZihzb3VyY2Uuc2xpY2UoSW5kZXgsSW5kZXgrNCk9PVwidHJ1ZVwiKXtJbmRleCs9NDtyZXR1cm4gdHJ1ZX1lbHNlIGlmKHNvdXJjZS5zbGljZShJbmRleCxJbmRleCs1KT09XCJmYWxzZVwiKXtJbmRleCs9NTtyZXR1cm4gZmFsc2V9ZWxzZSBpZihzb3VyY2Uuc2xpY2UoSW5kZXgsSW5kZXgrNCk9PVwibnVsbFwiKXtJbmRleCs9NDtyZXR1cm4gbnVsbH1hYm9ydCgpfX1yZXR1cm5cIiRcIn07dmFyIGdldD1mdW5jdGlvbih2YWx1ZSl7dmFyIHJlc3VsdHMsaGFzTWVtYmVycztpZih2YWx1ZT09XCIkXCIpe2Fib3J0KCl9aWYodHlwZW9mIHZhbHVlPT1cInN0cmluZ1wiKXtpZigoY2hhckluZGV4QnVnZ3k/dmFsdWUuY2hhckF0KDApOnZhbHVlWzBdKT09XCJAXCIpe3JldHVybiB2YWx1ZS5zbGljZSgxKX1pZih2YWx1ZT09XCJbXCIpe3Jlc3VsdHM9W107Zm9yKDs7aGFzTWVtYmVyc3x8KGhhc01lbWJlcnM9dHJ1ZSkpe3ZhbHVlPWxleCgpO2lmKHZhbHVlPT1cIl1cIil7YnJlYWt9aWYoaGFzTWVtYmVycyl7aWYodmFsdWU9PVwiLFwiKXt2YWx1ZT1sZXgoKTtpZih2YWx1ZT09XCJdXCIpe2Fib3J0KCl9fWVsc2V7YWJvcnQoKX19aWYodmFsdWU9PVwiLFwiKXthYm9ydCgpfXJlc3VsdHMucHVzaChnZXQodmFsdWUpKX1yZXR1cm4gcmVzdWx0c31lbHNlIGlmKHZhbHVlPT1cIntcIil7cmVzdWx0cz17fTtmb3IoOztoYXNNZW1iZXJzfHwoaGFzTWVtYmVycz10cnVlKSl7dmFsdWU9bGV4KCk7aWYodmFsdWU9PVwifVwiKXticmVha31pZihoYXNNZW1iZXJzKXtpZih2YWx1ZT09XCIsXCIpe3ZhbHVlPWxleCgpO2lmKHZhbHVlPT1cIn1cIil7YWJvcnQoKX19ZWxzZXthYm9ydCgpfX1pZih2YWx1ZT09XCIsXCJ8fHR5cGVvZiB2YWx1ZSE9XCJzdHJpbmdcInx8KGNoYXJJbmRleEJ1Z2d5P3ZhbHVlLmNoYXJBdCgwKTp2YWx1ZVswXSkhPVwiQFwifHxsZXgoKSE9XCI6XCIpe2Fib3J0KCl9cmVzdWx0c1t2YWx1ZS5zbGljZSgxKV09Z2V0KGxleCgpKX1yZXR1cm4gcmVzdWx0c31hYm9ydCgpfXJldHVybiB2YWx1ZX07dmFyIHVwZGF0ZT1mdW5jdGlvbihzb3VyY2UscHJvcGVydHksY2FsbGJhY2spe3ZhciBlbGVtZW50PXdhbGsoc291cmNlLHByb3BlcnR5LGNhbGxiYWNrKTtpZihlbGVtZW50PT09dW5kZWYpe2RlbGV0ZSBzb3VyY2VbcHJvcGVydHldfWVsc2V7c291cmNlW3Byb3BlcnR5XT1lbGVtZW50fX07dmFyIHdhbGs9ZnVuY3Rpb24oc291cmNlLHByb3BlcnR5LGNhbGxiYWNrKXt2YXIgdmFsdWU9c291cmNlW3Byb3BlcnR5XSxsZW5ndGg7aWYodHlwZW9mIHZhbHVlPT1cIm9iamVjdFwiJiZ2YWx1ZSl7aWYoZ2V0Q2xhc3MuY2FsbCh2YWx1ZSk9PWFycmF5Q2xhc3Mpe2ZvcihsZW5ndGg9dmFsdWUubGVuZ3RoO2xlbmd0aC0tOyl7dXBkYXRlKHZhbHVlLGxlbmd0aCxjYWxsYmFjayl9fWVsc2V7Zm9yRWFjaCh2YWx1ZSxmdW5jdGlvbihwcm9wZXJ0eSl7dXBkYXRlKHZhbHVlLHByb3BlcnR5LGNhbGxiYWNrKX0pfX1yZXR1cm4gY2FsbGJhY2suY2FsbChzb3VyY2UscHJvcGVydHksdmFsdWUpfTtKU09OMy5wYXJzZT1mdW5jdGlvbihzb3VyY2UsY2FsbGJhY2spe3ZhciByZXN1bHQsdmFsdWU7SW5kZXg9MDtTb3VyY2U9XCJcIitzb3VyY2U7cmVzdWx0PWdldChsZXgoKSk7aWYobGV4KCkhPVwiJFwiKXthYm9ydCgpfUluZGV4PVNvdXJjZT1udWxsO3JldHVybiBjYWxsYmFjayYmZ2V0Q2xhc3MuY2FsbChjYWxsYmFjayk9PWZ1bmN0aW9uQ2xhc3M/d2FsaygodmFsdWU9e30sdmFsdWVbXCJcIl09cmVzdWx0LHZhbHVlKSxcIlwiLGNhbGxiYWNrKTpyZXN1bHR9fX1pZihpc0xvYWRlcil7ZGVmaW5lKGZ1bmN0aW9uKCl7cmV0dXJuIEpTT04zfSl9fSkodGhpcyl9LHt9XSw0NDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7bW9kdWxlLmV4cG9ydHM9dG9BcnJheTtmdW5jdGlvbiB0b0FycmF5KGxpc3QsaW5kZXgpe3ZhciBhcnJheT1bXTtpbmRleD1pbmRleHx8MDtmb3IodmFyIGk9aW5kZXh8fDA7aTxsaXN0Lmxlbmd0aDtpKyspe2FycmF5W2ktaW5kZXhdPWxpc3RbaV19cmV0dXJuIGFycmF5fX0se31dfSx7fSxbMV0pKDEpfSk7XG59KS5jYWxsKHRoaXMsdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB7fSkiLCIvKlxuXHRzb2NrZXRzLmpzXG4qL1xuXG4vLyBkZXBlbmRlbmNpZXMgZm9yIHRoaXMgbW9kdWxlIGdvIGhlcmVcbnZhciBVSSA9IHJlcXVpcmUoJy4vdWknKTtcblxudmFyIFNvY2tldHMgPSB7XG5cdHNvY2tldCA6IG51bGwsXG5cblx0aW5pdCA6IGZ1bmN0aW9uICgpIHtcblx0XHR0aGlzLm1ha2VTb2NrZXRDb25uZWN0aW9uKCk7XG5cblx0XHR0aGlzLkxpc3RlbmVycy5zZXR1cCgpO1xuXHR9LFxuXG5cdG1ha2VTb2NrZXRDb25uZWN0aW9uIDogZnVuY3Rpb24gKCkge1xuXG5cdFx0dmFyIGNvbm5lY3Rpb25VUkwgPSB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWU7XG5cblx0XHR0aGlzLnNvY2tldCA9IGlvLmNvbm5lY3QoY29ubmVjdGlvblVSTCwge3RyYW5zcG9ydHM6IFsnd2Vic29ja2V0J119KTtcblxuXHR9LFxuXG5cdExpc3RlbmVycyA6IHtcblxuXHRcdHNldHVwIDogZnVuY3Rpb24gKCkge1xuXG5cdFx0XHRTb2NrZXRzLnNvY2tldC5vbigndHdlZXQnLCB0aGlzLm9uVHdlZXRSZWNlaXZlZCk7XG5cdFx0XHRTb2NrZXRzLnNvY2tldC5vbignc3RhdGUnLCB0aGlzLm9uU3RhdGVSZWNlaXZlZCk7XG5cblx0XHR9LFxuXG5cdFx0b25Ud2VldFJlY2VpdmVkIDogZnVuY3Rpb24gKHN5bWJvbE9iaikge1xuXG5cdFx0XHQvLyBsb2coJ29uIHR3ZWV0IHJlY2VpdmVkJyk7XG5cdFx0XHRVSS51cGRhdGVTeW1ib2woc3ltYm9sT2JqLmtleSwgc3ltYm9sT2JqLnN5bWJvbCk7XG5cblx0XHR9LFxuXG5cdFx0b25TdGF0ZVJlY2VpdmVkIDogZnVuY3Rpb24gKHN0YXRlT2JqKSB7XG5cblx0XHRcdGZvciAodmFyIGtleSBpbiBzdGF0ZU9iaikge1xuXHRcdFx0XHRVSS51cGRhdGVTeW1ib2woa2V5LCBzdGF0ZU9ialtrZXldKTtcblx0XHRcdH1cblxuXHRcdFx0VUkudXBkYXRlUmFua2luZ3Moc3RhdGVPYmopO1xuXG5cdFx0fVxuXG5cdH1cblxuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFNvY2tldHM7IiwiLypcblx0VUkuanNcblx0RXhhbXBsZSBtb2R1bGUgdG8gc2hvdyBob3cgdG8gaW5jbHVkZSBvdGhlciBKUyBmaWxlcyBpbnRvIHlvdSBicm93c2VyaWZ5IGJ1aWxkXG4qL1xuXG4vLyBkZXBlbmRlbmNpZXMgZm9yIHRoaXMgbW9kdWxlIGdvIGhlcmVcbnZhciAkID0gcmVxdWlyZSgndHJhdmVyc3R5JyksXG5cdHF3ZXJ5ID0gcmVxdWlyZSgncXdlcnknKTtcblxuXHR0cmFrID0gcmVxdWlyZSgndHJhay5qcycpO1xuXG5cdC8vIGQzID0gcmVxdWlyZSgnZDMnKTtcblxuXG4vL2dpdmUgdXMgb2xkIElFIHNlbGVjdG9yIHN1cHBvcnQgKDw4KVxuJC5zZXRTZWxlY3RvckVuZ2luZShxd2VyeSk7XG5cbnZhciBVSSA9IHtcblx0aHRtbDogJCgnaHRtbCcpWzBdLFxuXHRib2R5OiAkKCdib2R5JylbMF0sXG5cblx0b3ZlcmxheTogJCgnLm92ZXJsYXknKSxcblx0b3ZlcmxheUJ0bjogJCgnLm92ZXJsYXkgLmJ0bicpLFxuXG5cdHN5bWJvbExpc3Q6ICQoJy5zeW1ib2wtbGlzdC13cmFwcGVyJylbMF0sXG5cdHN5bWJvbExpc3RCdG46ICQoJy5idG4tbGlzdCcpWzBdLFxuXG5cdHNjcm9sbEFjdGl2ZTogZmFsc2UsXG5cblx0c3VwcG9ydHMgOiB7XG5cdFx0dHJhbnNmb3JtM2Q6IGZhbHNlXG5cdH0sXG5cblx0c2Nyb2xsRmlyZWQgOiBmYWxzZSxcblxuXHRpbml0IDogZnVuY3Rpb24gKCkge1xuXHRcdC8vIGQzLnNlbGVjdEFsbChcIi5zeW1ib2xcIikuc3R5bGUoXCJjb2xvclwiLCBmdW5jdGlvbigpIHtcbiAgLy8gXHRcdFx0cmV0dXJuIFwiaHNsKFwiICsgTWF0aC5yYW5kb20oKSAqIDM2MCArIFwiLDEwMCUsNTAlKVwiO1xuXHRcdC8vIH0pO1xuXHRcdC8vXG5cblx0XHR0aGlzLmJyb3dzZXJTdXBwb3J0Q2hlY2tzKCk7XG5cblx0XHR0aGlzLmhhbmRsZVpvb21pbmcoKTtcblxuXHRcdHRoaXMuaW5pdE92ZXJsYXlzKCk7XG5cdFx0dGhpcy5pbml0SW5mb092ZXJsYXkoKTtcblx0XHR0aGlzLnN5bWJvbE92ZXJsYXkoKTtcblxuXHR9LFxuXG5cdGJyb3dzZXJTdXBwb3J0Q2hlY2tzIDogZnVuY3Rpb24gICgpIHtcblxuXHRcdGlmICh0aGlzLmh0bWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdjc3N0cmFuc2Zvcm1zM2QnKSkge1xuXHRcdFx0dGhpcy5zdXBwb3J0cy50cmFuc2Zvcm0zZCA9IHRydWU7XG5cdFx0fVxuXG5cdFx0d2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFVJLmJvZHkuY2xhc3NMaXN0LnJlbW92ZSgncHJlbG9hZCcpO1xuXG5cdFx0fTtcblxuXHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbihlKSB7XG5cdFx0XHR0cmFrLnN0YXJ0KCk7XG5cdFx0fSk7XG5cblxuXHR9LFxuXG5cdGluaXRPdmVybGF5cyA6IGZ1bmN0aW9uICgpIHtcblxuXHRcdHZhciBpbmRleCA9IDAsXG5cdFx0XHRvdmVybGF5TnVtID0gdGhpcy5vdmVybGF5Lmxlbmd0aDtcblxuXHRcdC8vbG9vcCB0aHJvdWdoIGVhY2ggb3ZlcmxheSBhbmQgYXR0YWNoIGxpc3RlbmVyc1xuXHRcdGZvciAoaW5kZXg7IGluZGV4IDwgb3ZlcmxheU51bTsgaW5kZXgrKykge1xuXHRcdFx0dGhpcy5vdmVybGF5QnRuW2luZGV4XS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdFx0XHR2YXIgY29udGV4dCA9IHRoaXMuZ2V0QXR0cmlidXRlKCdkYXRhLWNsb3NlJyk7XG5cdFx0XHRcdCQoJy4nICsgY29udGV4dClbMF0uY2xhc3NMaXN0LmFkZCgnaW5hY3RpdmUnKTtcblx0XHRcdFx0VUkuc2Nyb2xsQWN0aXZlID0gdHJ1ZTtcblxuXHRcdFx0XHQvL2lmIHRoZSBpbnRybyBtb2RhbCBpcyBjbG9zZWQsIHNjcm9sbCB0byB0aGUgdG9wIG9mIHRoZSB3aW5kb3dcblx0XHRcdFx0aWYgKGNvbnRleHQgPT09ICdvdmVybGF5LS1pbnRybycpIHtcblx0XHRcdFx0XHR3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0cmFrLmV2ZW50KHtjYXRlZ29yeTogJ2VuZ2FnZW1lbnQnLCBhY3Rpb246ICdvdmVybGF5JywgbGFiZWw6ICdjbG9zZWQgJyArIGNvbnRleHR9KTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHR9LFxuXG5cdGluaXRJbmZvT3ZlcmxheSA6IGZ1bmN0aW9uICgpIHtcblxuXHRcdHZhciBmb290ZXJMaW5rID0gJCgnLnBhZ2UtZm9vdGVyLWluZm8nKVswXTtcblxuXHRcdGZvb3RlckxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHRVSS5oaWRlQWxsT3ZlcmxheXMoKTtcblx0XHRcdCQoJy5vdmVybGF5LS1pbmZvJylbMF0uY2xhc3NMaXN0LnJlbW92ZSgnaW5hY3RpdmUnKTtcblxuXHRcdFx0dHJhay5ldmVudCh7Y2F0ZWdvcnk6ICdlbmdhZ2VtZW50JywgYWN0aW9uOiAnb3ZlcmxheScsIGxhYmVsOiAnaW5mbyd9KTtcblxuXHRcdH0pO1xuXG5cdH0sXG5cblx0aGlkZUFsbE92ZXJsYXlzIDogZnVuY3Rpb24gKCkge1xuXG5cdFx0dmFyIGluZGV4ID0gMCxcblx0XHRcdG92ZXJsYXlOdW0gPSB0aGlzLm92ZXJsYXkubGVuZ3RoO1xuXG5cdFx0Ly9sb29wIHRocm91Z2ggZWFjaCBvdmVybGF5IGFuZCBhdHRhY2ggbGlzdGVuZXJzXG5cdFx0Zm9yIChpbmRleDsgaW5kZXggPCBvdmVybGF5TnVtOyBpbmRleCsrKSB7XG5cdFx0XHR0aGlzLm92ZXJsYXlbaW5kZXhdLmNsYXNzTGlzdC5hZGQoJ2luYWN0aXZlJyk7XG5cdFx0fVxuXG5cdH0sXG5cblx0c3ltYm9sT3ZlcmxheSA6IGZ1bmN0aW9uICgpIHtcblxuXHRcdHRoaXMuc3ltYm9sTGlzdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdC8vb25seSBvcGVuIGlmIHdlIGFyZSBpbiAnb3BlbiBzY3JvbGxpbmcgbW9kZSdcblx0XHRcdFVJLmhpZGVBbGxPdmVybGF5cygpO1xuXHRcdFx0VUkuc3ltYm9sTGlzdC5jbGFzc0xpc3QucmVtb3ZlKCdpbmFjdGl2ZScsICdoaWRlJyk7XG5cdFx0XHQkKCcjc2Nyb2xsLXByb3h5JylbMF0uY2xhc3NMaXN0LmFkZCgnaW5hY3RpdmUnKTtcblx0XHRcdHdpbmRvdy5zY3JvbGxUbygwLCAwKTtcblx0XHRcdFVJLnNjcm9sbEFjdGl2ZSA9IGZhbHNlO1xuXG5cdFx0XHR0cmFrLmV2ZW50KHtjYXRlZ29yeTogJ2VuZ2FnZW1lbnQnLCBhY3Rpb246ICdvdmVybGF5JywgbGFiZWw6ICdzeW1ib2wgbGlzdCd9KTtcblx0XHR9KTtcblxuXHRcdC8vY2xvc2UgYnV0dG9uIGZvciB0aGUgc3ltYm9sIG92ZXJsYXlcblx0XHQkKCcuYnRuLS1jbG9zZScpWzBdLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdFx0VUkuc3ltYm9sTGlzdC5jbGFzc0xpc3QuYWRkKCdpbmFjdGl2ZScpO1xuXHRcdFx0JCgnI3Njcm9sbC1wcm94eScpWzBdLmNsYXNzTGlzdC5yZW1vdmUoJ2luYWN0aXZlJyk7XG5cdFx0XHRVSS5zY3JvbGxBY3RpdmUgPSB0cnVlO1xuXHRcdH0pO1xuXG5cdH0sXG5cblxuXHR1cGRhdGVTeW1ib2wgOiBmdW5jdGlvbiAobmFtZSwgZGF0YSkge1xuXG5cdFx0Ly8gbG9nKG5hbWUsIGRhdGEpO1xuXHRcdHZhciBzeW1ib2xUb3RhbCA9ICQoJy5zeW1ib2wtLScgKyBuYW1lICsgJyAuc3ltYm9sLXRvdGFsJyk7XG5cblx0XHRpZiAoc3ltYm9sVG90YWwubGVuZ3RoID4gMCkge1xuXHRcdFx0dmFyIGluZGV4ID0gMCxcblx0XHRcdFx0c3ltTGVuZ3RoID0gc3ltYm9sVG90YWwubGVuZ3RoO1xuXG5cdFx0XHRmb3IgKGluZGV4OyBpbmRleCA8IHN5bUxlbmd0aDsgaW5kZXgrKykge1xuXHRcdFx0XHRzeW1ib2xUb3RhbFtpbmRleF0uaW5uZXJIVE1MID0gdGhpcy5udW1iZXJXaXRoQ29tbWFzKGRhdGEudG90YWwpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHR9LFxuXG5cdHVwZGF0ZVJhbmtpbmdzIDogZnVuY3Rpb24gKHN0YXRlKSB7XG5cblx0XHQvL2J1aWxkIGEgZG9tIG9iamVjdCBvZiBvcmRlcmVkIGxpc3QgZWxlbWVudHNcblx0XHR2YXIgcmFua2luZ0FycmF5ID0gW107XG5cblx0XHRmb3IgKHZhciBzeW1ib2wgaW4gc3RhdGUpIHtcblx0XHRcdHZhciB0YWdTdHJpbmc7XG5cdFx0XHRmb3IgKHZhciB0YWcgaW4gc3RhdGVbc3ltYm9sXS50YWdzKSB7XG5cdFx0XHRcdHRhZ1N0cmluZyA9IHRhZztcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0XHRyYW5raW5nQXJyYXkucHVzaChbc3ltYm9sLCB0YWdTdHJpbmcsIHN0YXRlW3N5bWJvbF0udG90YWxdKTtcblx0XHR9XG5cblx0XHRyYW5raW5nQXJyYXkuc29ydChmdW5jdGlvbihhLCBiKSB7cmV0dXJuICBiWzJdIC0gYVsyXSB9KTtcblxuXHRcdC8vbG9vcCB0aHJvdWdoIGFycmF5IGFuZCBtYWtlIGEgbGlzdFxuXHRcdHZhciBzeW1ib2xMZW5ndGggPSByYW5raW5nQXJyYXkubGVuZ3RoLFxuXHRcdFx0aSA9IDAsXG5cdFx0XHRsaXN0RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd1bCcpO1xuXG5cdFx0bGlzdEVsLmNsYXNzTmFtZSA9ICdzeW1ib2wtbGlzdCB1bnN0eWxlZCc7XG5cblx0XHRmb3IgKGk7IGkgPCBzeW1ib2xMZW5ndGg7IGkrKykge1xuXG5cdFx0XHR2YXIgbGlzdEl0ZW1FbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyksXG5cdFx0XHRcdHRleHRFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKSxcblx0XHRcdFx0dG90YWxFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcblxuXHRcdFx0bGlzdEl0ZW1FbC5jbGFzc05hbWUgPSAnc3ltYm9sIHN5bWJvbC0tJyArIHJhbmtpbmdBcnJheVtpXVswXTtcblx0XHRcdHRleHRFbC5jbGFzc05hbWUgPSAnc3ltYm9sLWxhYmVsJztcblx0XHRcdHRvdGFsRWwuY2xhc3NOYW1lID0gJ3N5bWJvbC10b3RhbCc7XG5cblx0XHRcdHRleHRFbC5pbm5lckhUTUwgPSByYW5raW5nQXJyYXlbaV1bMV0gKyAnOiAnO1xuXHRcdFx0dG90YWxFbC5pbm5lckhUTUwgPSBVSS5udW1iZXJXaXRoQ29tbWFzKHJhbmtpbmdBcnJheVtpXVsyXSk7XG5cblx0XHRcdHRleHRFbC5hcHBlbmRDaGlsZCh0b3RhbEVsKTtcblx0XHRcdGxpc3RJdGVtRWwuYXBwZW5kQ2hpbGQodGV4dEVsKTtcblx0XHRcdGxpc3RFbC5hcHBlbmRDaGlsZChsaXN0SXRlbUVsKTtcblx0XHR9XG5cblx0XHQkKCcuc3ltYm9sLWxpc3QnKVswXS5pbm5lckhUTUwgPSBsaXN0RWwuaW5uZXJIVE1MO1xuXG5cblx0fSxcblxuXHRudW1iZXJXaXRoQ29tbWFzIDogZnVuY3Rpb24oeCkge1xuXHRcdHJldHVybiB4LnRvU3RyaW5nKCkucmVwbGFjZSgvXFxCKD89KFxcZHszfSkrKD8hXFxkKSkvZywgXCIsXCIpO1xuXHR9LFxuXG5cblx0aGFuZGxlWm9vbWluZyA6IGZ1bmN0aW9uICgpIHtcblxuXHRcdC8vIG9ubHkgcHJvY2VlZCBpZiBDU1MgdHJhbnNmb3JtcyBhcmUgc3VwcG9ydGVkXG5cdC8vIE5FRUQgVE8gRklYXG5cdFx0Ly9pZiAoICFNb2Rlcm5penIuY3NzdHJhbnNmb3JtcyApIHsgcmV0dXJuOyB9XG5cblx0XHR2YXIgem9vbUNvbnRlbnQgPSAkKCcuaWxsdXN0LWNvbnRhaW5lcicpWzBdO1xuXG5cdFx0WlVJID0gbmV3IFpvb21lcih6b29tQ29udGVudCk7XG5cblx0XHQvL21ha2Ugc3VyZSBwYWdlIGlzIGF0IHRoZSB0b3Agd2hlbiByZWxvYWRlZFxuXHRcdHdpbmRvdy5zY3JvbGxUbygwLCAwKTtcblxuXHQvL29uIHBhZ2UgbG9hZCBjYWxjdWxhdGUgY3VycmVudCBwb3NpdGlvbiBhbmQgc2NhbGUgdG8gaXRcblx0XHQvLyBaVUkucmVjYWxjdWxhdGVQb3NpdGlvbnMoKTtcblxuXHR9XG59O1xuXG4vLyB0aGUgY29uc3RydWN0b3IgdGhhdCB3aWxsIGRvIGFsbCB0aGUgd29ya1xuZnVuY3Rpb24gWm9vbWVyKCBjb250ZW50ICkge1xuXG5cdHRoaXMuc2V0TGV2ZWxzID0gZnVuY3Rpb24oKSB7XG5cblx0XHRpZiAodGhpcy5kb2NXaWR0aCA+IDE1MDApIHtcblx0XHRcdHRoaXMubGV2ZWxzID0gNi4yO1xuXHRcdFx0dGhpcy52ZXJ0aWNhbFRyYW5zbGF0ZSA9IDMwMDA7XG5cdFx0fSBlbHNlIGlmICh0aGlzLmRvY1dpZHRoID4gMTM1MCkge1xuXHRcdFx0dGhpcy5sZXZlbHMgPSA2O1xuXHRcdFx0dGhpcy52ZXJ0aWNhbFRyYW5zbGF0ZSA9IDI3NTA7XG5cdFx0fSBlbHNlIGlmICh0aGlzLmRvY1dpZHRoID4gMTI1MCkge1xuXHRcdFx0dGhpcy5sZXZlbHMgPSA1Ljg7XG5cdFx0XHR0aGlzLnZlcnRpY2FsVHJhbnNsYXRlID0gMjQ1MDtcblx0XHR9IGVsc2UgaWYgKHRoaXMuZG9jV2lkdGggPiAxMTUwKSB7XG5cdFx0XHR0aGlzLmxldmVscyA9IDUuNztcblx0XHRcdHRoaXMudmVydGljYWxUcmFuc2xhdGUgPSAyMzUwO1xuXHRcdH0gZWxzZSBpZiAodGhpcy5kb2NXaWR0aCA+IDEwNTApIHtcblx0XHRcdHRoaXMubGV2ZWxzID0gNS41O1xuXHRcdFx0dGhpcy52ZXJ0aWNhbFRyYW5zbGF0ZSA9IDIxMDA7XG5cdFx0fSBlbHNlIGlmICh0aGlzLmRvY1dpZHRoID4gOTUwKSB7XG5cdFx0XHR0aGlzLmxldmVscyA9IDUuMzU7XG5cdFx0XHR0aGlzLnZlcnRpY2FsVHJhbnNsYXRlID0gMTkwMDtcblx0XHR9IGVsc2UgaWYgKHRoaXMuZG9jV2lkdGggPiA4NTApIHtcblx0XHRcdHRoaXMubGV2ZWxzID0gNS4xNTtcblx0XHRcdHRoaXMudmVydGljYWxUcmFuc2xhdGUgPSAxNzAwO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmxldmVscyA9IDQuOTtcblx0XHRcdHRoaXMudmVydGljYWxUcmFuc2xhdGUgPSAxNTIwO1xuXHRcdH1cblxuXHR9O1xuXG5cdC8vIGtlZXAgdHJhY2sgb2YgRE9NXG5cdHRoaXMuY29udGVudCA9IGNvbnRlbnQ7XG5cblx0dGhpcy5oZWFkZXIgPSAkKCcucGFnZS1oZWFkZXInKVswXTtcblx0dGhpcy5ib2R5ID0gJCgnYm9keScpWzBdO1xuXHR0aGlzLnRvd24gPSAkKCcuaWxsdXN0LWxldmVsLS10b3duJylbMF07XG5cdHRoaXMudG93blN5bWJvbHMgPSAkKCcuaWxsdXN0LWxldmVsLS1zeW1ib2xzVG93bicpWzBdO1xuXHR0aGlzLmhvdXNlID0gJCgnLnN2Zy1ob3VzZScpWzBdO1xuXHR0aGlzLmNhcm9sbGVycyA9ICQoJy5zdmctY2Fyb2xsZXJzJylbMF07XG5cdHRoaXMuc3RhciA9ICQoJy5zdmctc3RhcicpWzBdO1xuXG5cdC8vIHBvc2l0aW9uIG9mIHZlcnRpY2FsIHNjcm9sbFxuXHR0aGlzLnNjcm9sbGVkID0gMDtcblxuXHR2YXIgYm9keSA9IGRvY3VtZW50LmJvZHksXG5cdFx0aHRtbCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcblxuXHQvLyBoZWlnaHQgb2YgZG9jdW1lbnRcblx0dGhpcy5kb2NIZWlnaHQgPSBNYXRoLm1heCggYm9keS5zY3JvbGxIZWlnaHQsIGJvZHkub2Zmc2V0SGVpZ2h0LCBodG1sLmNsaWVudEhlaWdodCwgaHRtbC5zY3JvbGxIZWlnaHQsIGh0bWwub2Zmc2V0SGVpZ2h0ICk7XG5cdHRoaXMuZG9jV2lkdGggPSBodG1sLmNsaWVudFdpZHRoO1xuXG5cdC8vIHplcm8tYmFzZWQgbnVtYmVyIG9mIHNlY3Rpb25zXG5cdHRoaXMuc2V0TGV2ZWxzKCk7XG5cblxuXHQvLyBiaW5kIFpvb21lciB0byBzY3JvbGwgZXZlbnRcblx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICdzY3JvbGwnLCB0aGlzLCBmYWxzZSk7XG59XG5cbi8vIGVuYWJsZXMgY29uc3RydWN0b3IgdG8gYmUgdXNlZCB3aXRoaW4gZXZlbnQgbGlzdGVuZXJcbi8vIGxpa2Ugb2JqLmFkZEV2ZW50TGlzdGVuZXIoIGV2ZW50TmFtZSwgdGhpcywgZmFsc2UgKVxuWm9vbWVyLnByb3RvdHlwZS5oYW5kbGVFdmVudCA9IGZ1bmN0aW9uKCBldmVudCApIHtcblx0aWYgKCB0aGlzW2V2ZW50LnR5cGVdICkge1xuXHRcdHRoaXNbZXZlbnQudHlwZV0oZXZlbnQpO1xuXHR9XG59O1xuXG4vLyB0cmlnZ2VyZWQgZXZlcnkgdGltZSB3aW5kb3cgc2Nyb2xsc1xuWm9vbWVyLnByb3RvdHlwZS5zY3JvbGwgPSBmdW5jdGlvbiggZXZlbnQgKSB7XG5cblx0aWYgKFVJLnNjcm9sbEFjdGl2ZSkge1xuXHRcdHRoaXMucmVjYWxjdWxhdGVQb3NpdGlvbnMoKTtcblx0fVxuXG59O1xuXG5ab29tZXIucHJvdG90eXBlLnJlY2FsY3VsYXRlUG9zaXRpb25zID0gZnVuY3Rpb24gKCkge1xuXG5cdC8vTEVUUyBIQVZFIFNPTUUgREVGQVVMVFMgSEVSRVxuXHR2YXIgSU5JVElBTF9UT1dOX1dJRFRIID0gMzUwLFxuXHRcdElOSVRJQUxfVE9XTl9IRUlHSFQgPSAzMjAsXG5cdFx0VEFSR0VUX1RPV05fV0lEVEggPSAyODAwLFxuXHRcdFRBUkdFVF9UT1dOX0hFSUdIVCA9IDI1NjAsXG5cblx0XHRUQVJHRVRfQkdfWlNDQUxFID0gMjAwLFxuXG5cdFx0T0ZGU0VUX01BUkdJTiA9IDgwLFxuXG5cdFx0VEFSR0VUX1ZFUlRJQ0FMX1RSQU5TTEFURSA9IDI2MDA7XG5cblxuXHR2YXIgc3VwcG9ydFBhZ2VPZmZzZXQgPSB3aW5kb3cucGFnZVhPZmZzZXQgIT09IHVuZGVmaW5lZDtcblx0dmFyIGlzQ1NTMUNvbXBhdCA9ICgoZG9jdW1lbnQuY29tcGF0TW9kZSB8fCBcIlwiKSA9PT0gXCJDU1MxQ29tcGF0XCIpO1xuXG5cdHZhciB5T2Zmc2V0ID0gc3VwcG9ydFBhZ2VPZmZzZXQgPyB3aW5kb3cucGFnZVlPZmZzZXQgOiBpc0NTUzFDb21wYXQgPyBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wIDogZG9jdW1lbnQuYm9keS5zY3JvbGxUb3A7XG5cblx0Ly8gbm9ybWFsaXplIHNjcm9sbCB2YWx1ZSBmcm9tIDAgdG8gMVxuXHR0aGlzLnNjcm9sbGVkID0geU9mZnNldCAvICggdGhpcy5kb2NIZWlnaHQgLSB3aW5kb3cuaW5uZXJIZWlnaHQgKTtcblxuXHR2YXIgdHJhbnNmb3JtVmFsdWUsXG5cdFx0d2lkdGgsXG5cdFx0dHJhbnNmb3JtUHJlZml4LFxuXHRcdHRvd25UcmFuc2Zvcm0sXG5cdFx0c3ltYm9sdHJhbnNmb3JtVmFsdWU7XG5cblx0dGhpcy5jaGVja1N0YXRlcygpO1xuXG5cdHZhciBzY3JvbGxGYWN0b3IgPSAodGhpcy5zY3JvbGxlZCA8IDAuNSA/IHRoaXMuc2Nyb2xsZWQgOiAwLjUpO1xuXHR2YXIgc2NhbGUgPSBNYXRoLnBvdyggMywgc2Nyb2xsRmFjdG9yICogdGhpcy5sZXZlbHMgKTtcblx0dmFyIHRvd25IZWlnaHQgPSBNYXRoLnJvdW5kKHNjYWxlICogSU5JVElBTF9UT1dOX0hFSUdIVCk7XG5cdHZhciB0b3duV2lkdGggPSBNYXRoLnJvdW5kKHNjYWxlICogSU5JVElBTF9UT1dOX1dJRFRIKTtcblx0dmFyIHRvd25PZmZzZXQgPSBNYXRoLnJvdW5kKHNjYWxlICogT0ZGU0VUX01BUkdJTikgLSBPRkZTRVRfTUFSR0lOO1xuXG5cdC8vZmlyc3QgaGFsZiBvZiBhcHAgaXMgdGhlIHNjYWxlIOKAkyB0aGlzIHpvb21zIGludG8gdGhlIGhvdXNlXG5cdGlmIChzY3JvbGxGYWN0b3IgPCAwLjUpIHtcblxuXHRcdHZhciB6U2NhbGUgPSBNYXRoLnJvdW5kKChzY2FsZSAqIFRBUkdFVF9CR19aU0NBTEUpIC0gVEFSR0VUX0JHX1pTQ0FMRSk7XG5cblx0XHR2YXIgdG93bllQb3MgPSBNYXRoLnJvdW5kKCgodG93bkhlaWdodCAvIDIpICsgdG93bk9mZnNldCkpO1xuXG5cdFx0Ly9pZiB3ZSBzdXBwb3J0IHRyYW5zbGF0ZTNkXG5cdFx0aWYgKFVJLnN1cHBvcnRzLnRyYW5zZm9ybTNkKSB7XG5cdFx0XHR0cmFuc2Zvcm1WYWx1ZSA9ICd0cmFuc2xhdGUzZCgwLCAwLCAwKSBzY2FsZSgnICsgc2NhbGUgKyAnKSc7XG5cblx0XHRcdHRvd25UcmFuc2Zvcm0gPSAndHJhbnNsYXRlM2QoLTUwJSwgLScgKyB0b3duWVBvcyArICdweCwgMCknO1xuXHRcdFx0c3ltYm9sdHJhbnNmb3JtVmFsdWUgPSAndHJhbnNsYXRlM2QoLScgKyAodG93bldpZHRoIC8gMikgKyAncHgsIC0nICsgdG93bllQb3MgKyAncHgsIDApJyArICcgc2NhbGUoJyArIHNjYWxlICsgJyknO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0cmFuc2Zvcm1WYWx1ZSA9ICd0cmFuc2xhdGUoMCwgMCkgc2NhbGUoJyArIHNjYWxlICsgJyknO1xuXG5cdFx0XHR0b3duVHJhbnNmb3JtID0gJ3RyYW5zbGF0ZSgtNTAlLCAtJyArIHRvd25ZUG9zICsgJ3B4KSc7XG5cdFx0XHRzeW1ib2x0cmFuc2Zvcm1WYWx1ZSA9ICd0cmFuc2xhdGUoLScgKyAodG93bldpZHRoIC8gMikgKyAncHgsIC0nICsgdG93bllQb3MgKyAncHgpJyArICcgc2NhbGUoJyArIHNjYWxlICsgJyknO1xuXHRcdH1cblxuXHQvL3RoZSBzZWNvbmQgaGFsZiBpcyB0aGUgdHJhbnNsYXRlIHZlcnRpY2FsbHlcblx0fSBlbHNlIHtcblxuXHRcdHZhciBwZXJjZW50YWdlVGhyb3VnaFNlY3Rpb24gPSAoKHRoaXMuc2Nyb2xsZWQgLSAwLjUpIC8gMC41KTsgLy9nZXQgdGhlIHBlcmNlbnRhZ2Ugb2YgdGhlIGFtb3VudCB0aHJvdWdoIHRoZSBzZWN0aW9uIChvbiBhIHNjYWxlIDAtMSlcblx0XHR2YXIgdmVydGljYWxUcmFuc2xhdGUgPSBwZXJjZW50YWdlVGhyb3VnaFNlY3Rpb24gKiB0aGlzLnZlcnRpY2FsVHJhbnNsYXRlOyAvL2dldHMgYSBzY2FsZWQgYW1vdW50IGRlcGVuZGVudCBvbiB0aGUgcGVyY2VudGFnZSBvZiB0aGUgc2VjdGlvbiBzY3JvbGxlZCB0aHJvdWdoXG5cblx0XHR2YXIgdG93bllQb3MgPSBNYXRoLnJvdW5kKCh0b3duSGVpZ2h0IC8gMikgKyB0b3duT2Zmc2V0IC0gdmVydGljYWxUcmFuc2xhdGUpO1xuXG5cdFx0Ly9pZiB3ZSBzdXBwb3J0IHRyYW5zbGF0ZTNkXG5cdFx0aWYgKFVJLnN1cHBvcnRzLnRyYW5zZm9ybTNkKSB7XG5cdFx0XHR0cmFuc2Zvcm1WYWx1ZSA9ICd0cmFuc2xhdGUzZCgwLCAwLCAwKSBzY2FsZSgnICsgc2NhbGUgKyAnKSc7XG5cdFx0XHR0b3duVHJhbnNmb3JtID0gJ3RyYW5zbGF0ZTNkKC01MCUsIC0nICsgdG93bllQb3MgKyAncHgsIDApJztcblx0XHR9IGVsc2Uge1xuXHRcdFx0dHJhbnNmb3JtVmFsdWUgPSAndHJhbnNsYXRlKDAsIDApIHNjYWxlKCcgKyBzY2FsZSArICcpJztcblx0XHRcdHRvd25UcmFuc2Zvcm0gPSAndHJhbnNsYXRlKC01MCUsIC0nICsgdG93bllQb3MgKyAncHgpJztcblx0XHR9XG5cblx0fVxuXG5cdC8vIFNFVFRJTkcgT0YgT1VSIE5FVyBWQUxVRVNcblxuXHQvL3VwZGF0ZSB3aWR0aCBhbmQgaGVpZ2h0IG9mIHRvd25cblx0dGhpcy50b3duLnN0eWxlLndpZHRoID0gdG93bldpZHRoICsgJ3B4Jztcblx0dGhpcy50b3duLnN0eWxlLmhlaWdodCA9IHRvd25IZWlnaHQgKyAncHgnO1xuXG5cdC8vIC8vdXBkYXRlIHRoZSB0cmFuc2Zvcm1lZCB2YWx1ZSBmb3IgdGhlIHRvd25cblx0dGhpcy50b3duLnN0eWxlLldlYmtpdFRyYW5zZm9ybSA9IHRvd25UcmFuc2Zvcm07XG5cdHRoaXMudG93bi5zdHlsZS5Nb3pUcmFuc2Zvcm0gPSB0b3duVHJhbnNmb3JtO1xuXHR0aGlzLnRvd24uc3R5bGUubXNUcmFuc2Zvcm0gPSB0b3duVHJhbnNmb3JtO1xuXHR0aGlzLnRvd24uc3R5bGUudHJhbnNmb3JtID0gdG93blRyYW5zZm9ybTtcblxuXHQvLyAvL3VwZGF0ZSBzY2FsZSBmYWN0b3Igb2YgdGhlIG91dHNpZGUgaWxsdXN0cmF0aW9ucyBhbmQgdGV4dFxuXHQvLyBpZihuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkuaW5kZXhPZignZmlyZWZveCcpID09PSAtMSkge1xuXHRcdHRoaXMuY29udGVudC5zdHlsZS5XZWJraXRUcmFuc2Zvcm0gPSB0cmFuc2Zvcm1WYWx1ZTtcblx0XHR0aGlzLmNvbnRlbnQuc3R5bGUuTW96VHJhbnNmb3JtID0gdHJhbnNmb3JtVmFsdWU7XG5cdFx0dGhpcy5jb250ZW50LnN0eWxlLm1zVHJhbnNmb3JtID0gdHJhbnNmb3JtVmFsdWU7XG5cdFx0dGhpcy5jb250ZW50LnN0eWxlLnRyYW5zZm9ybSA9IHRyYW5zZm9ybVZhbHVlO1xuXHQvLyB9XG5cblx0Ly8gLy90b3duIHN5bWJvbHMgc2NhbGluZ1xuXHR0aGlzLnRvd25TeW1ib2xzLnN0eWxlLldlYmtpdFRyYW5zZm9ybSA9ICdzY2FsZSgnICsgc2NhbGUgKyAnKSc7XG5cdHRoaXMudG93blN5bWJvbHMuc3R5bGUuTW96VHJhbnNmb3JtID0gJ3NjYWxlKCcgKyBzY2FsZSArICcpJztcblx0dGhpcy50b3duU3ltYm9scy5zdHlsZS5tc1RyYW5zZm9ybSA9ICdzY2FsZSgnICsgc2NhbGUgKyAnKSc7XG5cdHRoaXMudG93blN5bWJvbHMuc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlKCcgKyBzY2FsZSArICcpJztcblxufTtcblxuXG5ab29tZXIucHJvdG90eXBlLmNoZWNrU3RhdGVzID0gZnVuY3Rpb24gKCkge1xuXG5cdGlmICh0aGlzLnNjcm9sbGVkID4gMCkge1xuXHRcdHRoaXMuaGVhZGVyLmNsYXNzTGlzdC5hZGQoJ3NjYWxlZCcpO1xuXHR9IGVsc2Uge1xuXHRcdHRoaXMuaGVhZGVyLmNsYXNzTGlzdC5yZW1vdmUoJ3NjYWxlZCcpO1xuXHR9XG5cblx0Ly9kbyBhIHRlc3Qgd2hldGhlciB0byBzd2l0Y2ggdG8gbmlnaHQgb3Igbm90IChhZnRlciAwLjI1IHNjcm9sbGVkKVxuXHRpZiAodGhpcy5zY3JvbGxlZCA+IDAuMTUpIHtcblx0XHR0aGlzLmJvZHkuY2xhc3NMaXN0LmFkZCgnbmlnaHQnKTtcblx0fSBlbHNlIHtcblx0XHR0aGlzLmJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnbmlnaHQnKTtcblx0fVxuXG5cdC8vdGVzdCBiZXR3ZWVuIHN0YXRlIG9mIG1vdmVtZW50XG5cdGlmICh0aGlzLnNjcm9sbGVkIDwgMC41KSB7XG5cblx0XHR0aGlzLmhvdXNlLmNsYXNzTGlzdC5yZW1vdmUoJ2luYWN0aXZlJyk7IC8vbWFrZSBob3VzZSB2aXNpYmxlXG5cdFx0dGhpcy5jYXJvbGxlcnMuY2xhc3NMaXN0LnJlbW92ZSgnaW5hY3RpdmUnKTsgLy9tYWtlIGNhcm9sbGVycyBpbnZpc2libGVcblx0XHR0aGlzLnN0YXIuY2xhc3NMaXN0LmFkZCgnaW5hY3RpdmUnKTsgLy9tYWtlIGNhcm9sbGVycyBpbnZpc2libGVcblx0XHR0aGlzLnRvd25TeW1ib2xzLnF1ZXJ5U2VsZWN0b3IoJy5zeW1ib2xzLS1pbnNpZGUnKS5jbGFzc0xpc3QuYWRkKCdpbmFjdGl2ZScpOyAvL21ha2UgbmF0aXZpdHkgc3ltYm9scyBub3QgdmlzaWJsZVxuXHRcdHRoaXMudG93blN5bWJvbHMucXVlcnlTZWxlY3RvcignLnN5bWJvbHMtLW91dHNpZGUnKS5jbGFzc0xpc3QucmVtb3ZlKCdpbmFjdGl2ZScpOyAvL21ha2UgbmF0aXZpdHkgc3ltYm9scyBub3QgdmlzaWJsZVxuXG5cdH0gZWxzZSB7XG5cblx0XHR0aGlzLmhvdXNlLmNsYXNzTGlzdC5hZGQoJ2luYWN0aXZlJyk7IC8vbWFrZSBob3VzZSBub3QgdmlzaWJsZVxuXHRcdHRoaXMuY2Fyb2xsZXJzLmNsYXNzTGlzdC5hZGQoJ2luYWN0aXZlJyk7IC8vbWFrZSBjYXJvbGxlcnMgaW52aXNpYmxlXG5cdFx0dGhpcy5zdGFyLmNsYXNzTGlzdC5yZW1vdmUoJ2luYWN0aXZlJyk7IC8vbWFrZSBjYXJvbGxlcnMgaW52aXNpYmxlXG5cdFx0dGhpcy50b3duU3ltYm9scy5xdWVyeVNlbGVjdG9yKCcuc3ltYm9scy0taW5zaWRlJykuY2xhc3NMaXN0LnJlbW92ZSgnaW5hY3RpdmUnKTsgLy9tYWtlIG5hdGl2aXR5IHN5bWJvbHMgdmlzaWJsZVxuXHRcdHRoaXMudG93blN5bWJvbHMucXVlcnlTZWxlY3RvcignLnN5bWJvbHMtLW91dHNpZGUnKS5jbGFzc0xpc3QuYWRkKCdpbmFjdGl2ZScpOyAvL21ha2UgbmF0aXZpdHkgc3ltYm9scyBub3QgdmlzaWJsZVxuXG5cdFx0aWYgKFVJLnNjcm9sbEZpcmVkID09PSBmYWxzZSkge1xuXHRcdFx0VUkuc2Nyb2xsRmlyZWQgPSB0cnVlO1xuXHRcdFx0dHJhay5ldmVudCh7Y2F0ZWdvcnk6ICdlbmdhZ2VtZW50JywgYWN0aW9uOiAnc2Nyb2xsJywgbGFiZWw6ICdoYWxmd2F5J30pO1xuXHRcdH1cblxuXHR9XG5cbn07XG5cblxuXG5cbm1vZHVsZS5leHBvcnRzID0gVUk7IiwiLypcdEF1dGhvcjpcblx0XHRUTVcgLSAoQXV0aG9yIE5hbWUgSGVyZSlcbiovXG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuLy8gREVGSU5FIEdMT0JBTCBMSUJTICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cbi8vIFVuY29tbWVudCB0aGUgbGluZSBiZWxvdyB0byBleHBvc2UgalF1ZXJ5IGFzIGEgZ2xvYmFsIG9iamVjdCB0byB0aGUgdXN1YWwgcGxhY2VzXG4vLyB3aW5kb3cualF1ZXJ5ID0gd2luZG93LiQgPSByZXF1aXJlKCcuL2xpYnMvanF1ZXJ5L2pxdWVyeS0xLjEwLjIuanMnKTtcblxuLy8gZm9yY2UgY29tcGlsYXRpb24gb2YgZ2xvYmFsIGxpYnMgdGhhdCBkb24ndCByZXR1cm4gYSB2YWx1ZS5cbnJlcXVpcmUoXCIuL2hlbHBlcnMvbG9nXCIpO1xucmVxdWlyZShcIi4vaGVscGVycy9zaGltc1wiKTtcbndpbmRvdy5pbyA9IHJlcXVpcmUoJy4vbGlicy9zb2NrZXQuaW8tMS4xLjAnKTtcblxuXG4vL2luaXRpYWxpc2UgS08gb2JqZWN0XG52YXIgS08gPSB3aW5kb3cuS08gPSB7fTtcblxuS08uU29ja2V0cyA9IHJlcXVpcmUoJy4vbW9kdWxlcy9zb2NrZXRzJyk7XG5LTy5VSSA9IHJlcXVpcmUoJy4vbW9kdWxlcy91aScpO1xuXG5LTy5Db25maWcgPSB7XG5cblx0aW5pdCA6IGZ1bmN0aW9uICgpIHtcblx0XHRLTy5VSS5pbml0KCk7XG5cdFx0S08uU29ja2V0cy5pbml0KCk7XG5cdH1cbn07XG5cblxuS08uQ29uZmlnLmluaXQoKTsiXX0=
